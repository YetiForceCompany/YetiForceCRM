
Vtiger_Detail_Js("Accounts_Detail_Js",{},{accountHierarchyResponseCache:{},getAccountHierarchyResponseData:function(c){var b=this;var a=jQuery.Deferred();if(!(jQuery.isEmptyObject(b.accountHierarchyResponseCache))){a.resolve(b.accountHierarchyResponseCache)}else{AppConnector.request(c).then(function(d){b.accountHierarchyResponseCache=d;a.resolve(b.accountHierarchyResponseCache)})}return a.promise()},displayAccountHierarchyResponseData:function(b){var a=function(c){app.showScrollBar(jQuery("#hierarchyScroll"),{height:"300px",railVisible:true,size:"6px"})};app.showModalWindow(b,function(c){if(typeof a=="function"&&jQuery("#hierarchyScroll").height()>300){a(c)}})},registerHierarchyRecordCount:function(){var a=$(".detailViewTitle .hierarchy");if(a.length){var b={module:app.getModuleName(),action:"RelationAjax",record:app.getRecordId(),mode:"getHierarchyCount",};AppConnector.request(b).then(function(c){if(c.success){$(".detailViewTitle .hierarchy").append(' <span class="badge">'+c.result+"</span>")}})}},registerShowHierarchy:function(){var c=this;var b=$(".detailViewTitle");var a="index.php?module=Accounts&view=AccountHierarchy&record="+app.getRecordId();b.on("click",".detailViewIcon",function(d){c.getAccountHierarchyResponseData(a).then(function(e){c.displayAccountHierarchyResponseData(e)})})},registerEvents:function(){this._super();this.registerHierarchyRecordCount();this.registerShowHierarchy()}});