
Vtiger_Edit_Js("OSSMailTemplates_Edit_Js",{},{registerToZeroClipboard:function(){jQuery(".copy-button").each(function(){var a=jQuery(this).data("prefix");a=new ZeroClipboard($(this),{moviePath:"libraries/jquery/ZeroClipboard/ZeroClipboard.swf"});a.on("dataRequested",function(d,e){var c=jQuery(this).data("select"),g=jQuery(this).data("prefix");var b="";var f=jQuery('[name="'+c+'"]').val();b="#"+g+"#"+f+"#"+g+"End#";d.setText(b)});a.on("complete",function(b,c){var d={text:app.vtranslate("JS_NOTIF_PASS_COPIED"),animation:"show",title:app.vtranslate("JS_NOTIF_PASS_TITLE"),type:"success"};Vtiger_Helper_Js.showPnotify(d)})})},loadSpecialFunctionList:function(a){params={};params.data={module:"OSSMailTemplates",action:"GetListSpecialFunction",tpl_module:a};AppConnector.request(params).then(function(c){if(c.success){var d=jQuery('[name="oss_special_function_list"]'),b=c.result;d.find("option").remove();jQuery(b).each(function(e,f){jQuery(d).append('<option value="'+f.filename+'">'+f.label+"</option>")});d.trigger("chosen:updated")}})},loadFieldList:function(a){params={};params.data={module:"OSSMailTemplates",action:"GetListField",tpl_module:a};AppConnector.request(params).then(function(f){if(f.success){var b=jQuery('[name="oss_fields_list"]'),d=f.result;b.find("option").remove();b.find("optgroup").remove();for(var g in d){var c='<optgroup label="'+d[g]["blockLabel"]+'">';for(var e in d[g]){if(e!="blockLabel"){c+='<option value="'+d[g][e]["id"]+'">'+d[g][e]["label"]+"</option>"}}c+="</optgroup>";jQuery(b).append(c)}b.trigger("chosen:updated")}})},loadRelatedFieldList:function(){var a=jQuery('[name="oss_module_list"]').val(),b={};b.data={module:"OSSMailTemplates",action:"GetListRelatedField",tpl_module:a};AppConnector.request(b).then(function(d){if(d.success){var e=jQuery('[name="oss_related_fields_list"]');var c=d.result;e.find("optgroup").remove();e.find("option").remove();jQuery(c).each(function(g,k){for(var i in k){var h='<optgroup label="'+i+'">';for(var f in k[i]){for(var j in k[i][f]){if(undefined!=k[i][f][j]["id"]){h+='<option value="'+k[i][f][j]["id"]+'">'+k[i][f][j]["label"]+"</option>"}}}h+="</optgroup>";jQuery(e).append(h)}});e.trigger("chosen:updated")}})},setFieldList:function(){var b=this;var a="Accounts";var c=jQuery('[name="oss_module_list"]');a=c.val();c.on("change",function(){a=c.val();b.loadFieldList(a)});b.loadFieldList(a)},setSpecialFunctionList:function(){var b=this;var a="Accounts";var c=jQuery('[name="oss_module_list"]');a=c.val();c.on("change",function(){a=c.val();b.loadSpecialFunctionList(a)});b.loadSpecialFunctionList(a)},setRelatedFieldList:function(){var a=this;var b=jQuery('[name="oss_module_list"]');b.on("change",function(){a.loadRelatedFieldList()});a.loadRelatedFieldList()},showHideSpecialField:function(){var f=this;var d=jQuery('[name="ossmailtemplates_type"]');var e=jQuery('[name="oss_fields_list"]');var c=e.closest(".fieldValue").find("button");var b=jQuery('[name="oss_related_fields_list"]');var a=b.closest(".fieldValue").find("button");d.on("change",function(){var g=jQuery(this).val();if(g=="PLL_MODULE"){e.prop("disabled",true).trigger("chosen:updated");c.addClass("hide");b.prop("disabled",true).trigger("chosen:updated");a.addClass("hide")}else{e.prop("disabled",false).trigger("chosen:updated");c.removeClass("hide");b.prop("disabled",false).trigger("chosen:updated");a.removeClass("hide")}})},registerBasicEvents:function(a){this._super(a);this.setFieldList();this.setRelatedFieldList();this.setSpecialFunctionList();this.showHideSpecialField();this.registerToZeroClipboard()}});