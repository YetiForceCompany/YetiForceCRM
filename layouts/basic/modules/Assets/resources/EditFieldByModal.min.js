
Vtiger_EditFieldByModal_Js("Assets_EditFieldByModal_Js",{},{relatedRecord:false,registerTabFromAcocunt:function(){var f=this;var a=jQuery.Deferred();var e=this.getForm();var d=e.find(".relatedRecord");if(!d.length){a.resolve(e);return false}var b=e.find(".relatedModule").val();b=b?$.parseJSON(b):[];for(var c in b){var g=jQuery.progressIndicator({position:"replace",blockInfo:{enabled:true,elementToBlock:e.find(".relatedRecordsContents")}});f.getRelatedData(b[c]).then(function(h){g.progressIndicator({mode:"hide"});a.resolve(e)})}return a.promise()},getRelatedData:function(c){var e=this;var b=jQuery.Deferred();var a=c.toLowerCase();var d=this.getForm();var f={module:d.find(".relatedModuleBasic").val(),view:"Detail",mode:c=="ModComments"?"showRecentComments":"showRelatedList",relatedModule:c,limit:"no_limit",record:this.relatedRecord?this.relatedRecord:d.find(".relatedRecord").val()};AppConnector.request(f).then(function(h){h=jQuery(h);var g=d.find(".relatedRecordsContents #"+a);if(c=="ModComments"){e.showCommentData(h.find(".commentsBody"),g)}else{e.showRelatedData(h,g)}b.resolve(g)},function(g){});return b.promise()},registerHierarchyAcocunt:function(){var d=this;var c=this.getForm();var b=c.find(".hierarchyId").val();if(!b){return false}var e={module:this.moduleName,fields:c.find(".hierarchyField").val(),view:"GetHierarchy",record:b};var a=c.find(".hierarchyContainer");AppConnector.request(e).then(function(f){f=jQuery(f).find(".modal-body");f.find("tr").removeClass("bgAzure").addClass("cursorPointer");f.find('tr[data-id="'+b+'"]').addClass("bgAzure");d.registerHierarchyEvent(f);a.html(f)})},registerHierarchyEvent:function(b){var a=this;b.find("tr").on("click",function(c){var d=jQuery(c.currentTarget);d.closest("tbody").find("tr").removeClass("bgAzure");d.addClass("bgAzure");a.relatedRecord=d.data("id");a.registerTabFromAcocunt().then(function(){a.relatedRecord=false})})},showCommentData:function(c,a){var b=this;c.addClass("commentContainer");c.find(".commentActionsContainer").remove();a.html(c);if(c.find(".singleComment").length>6){app.showScrollBar(a.children(),{height:"350px"})}},showRelatedData:function(g,b){var f=this;var e=this.getForm();g.find(".relatedContents .relationDelete, .relatedContents .favorites").remove();var a=g.find("table .listViewEntries");var c=g.find(".searchField");if(c.length){c.closest("tr").remove()}if(a.length==0){var d=e.find(".message").clone(true,true);b.html(d.removeClass("message hide"));return false}b.html(g.find(".relatedContents"));if(a.length>10){app.showScrollBar(b.children(),{height:"300px"})}b.find(".relatedContents .listViewEntries td").on("click",function(i){var h=jQuery(i.target);var j=h.closest("tr");var k=j.next();if(k.hasClass("listViewInventoryEntries")&&!h.closest("div").hasClass("actions")&&!h.is("a")&&!h.is("input")){k.toggleClass("hide")}})},registerEvents:function(){this._super();this.registerHierarchyAcocunt();this.registerTabFromAcocunt()}});