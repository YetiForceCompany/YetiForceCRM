jQuery.Class("Settings_CurrencyUpdate_Index_Js",{},{registerInfoButton:function(a){a.find("#supportedCurrencies").on("click",function(){jQuery("#infoBlock").toggleClass("hide")})},registerAlertButton:function(a){a.find("#unsupportedCurrencies").on("click",function(){a.find("#alertBlock").toggleClass("hide")})},registerBankChange:function(a){a.find("#bank").on("change",function(){bankName=a.find("#bank option:selected").data("name");a.find("#alertSpan").html("");a.find("#infoSpan").html("");var c=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});var d={};d.data={parent:app.getParentModuleName(),module:app.getModuleName(),action:"GetBankCurrencies",mode:"supported",name:bankName};d.dataType="json";AppConnector.request(d).then(function(h){var e=h.result;var g="";for(var f in e){g+="<p><strong>"+f+"</strong> - "+e[f]+"</p>"}a.find("#infoSpan").html(g)},function(f,e){});d.data={parent:app.getParentModuleName(),module:app.getModuleName(),action:"GetBankCurrencies",mode:"unsupported",name:bankName};d.dataType="json";AppConnector.request(d).then(function(h){var e=h.result;if(jQuery.isEmptyObject(e)){if(!a.find("#unsupportedCurrencies").hasClass("hide")){a.find("#unsupportedCurrencies").addClass("hide")}if(!a.find("#alertBlock").hasClass("hide")){a.find("#alertBlock").addClass("hide")}}else{a.find("#unsupportedCurrencies").removeClass("hide")}var g="";for(var f in e){g+="<p><strong>"+f+"</strong> - "+e[f]+"</p>"}a.find("#alertSpan").html(g)},function(f,e){});var b=jQuery("#bank option:selected").val();d.data={parent:app.getParentModuleName(),module:app.getModuleName(),action:"SaveActiveBank",id:b};d.dataType="json";AppConnector.request(d).then(function(f){var e=f.result;if(e.success){var g={text:e.message,animation:"show",type:"success"};Vtiger_Helper_Js.showPnotify(g)}else{var g={text:e.message,animation:"show",hide:false,type:"error"};Vtiger_Helper_Js.showPnotify(g)}c.progressIndicator({mode:"hide"})},function(f,e){})})},registerEvents:function(){var a=jQuery("#currencyUpdateContainer");app.registerEventForDatePickerFields("#datepicker",false,{});this.registerInfoButton(a);this.registerAlertButton(a);this.registerBankChange(a)}});
