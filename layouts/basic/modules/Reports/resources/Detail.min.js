
Vtiger_Detail_Js("Reports_Detail_Js",{},{advanceFilterInstance:false,detailViewContentHolder:false,HeaderContentsHolder:false,getContentHolder:function(){if(this.detailViewContentHolder==false){this.detailViewContentHolder=jQuery("div.contentsDiv")}return this.detailViewContentHolder},getHeaderContentsHolder:function(){if(this.HeaderContentsHolder==false){this.HeaderContentsHolder=jQuery("div.reportsDetailHeader ")}return this.HeaderContentsHolder},calculateValues:function(){var a=this.advanceFilterInstance.getValues();return JSON.stringify(a)},registerSaveOrGenerateReportEvent:function(){var a=this;jQuery(".generateReport").on("click",function(i){i.preventDefault();var j=a.calculateValues();var d=a.getRecordId();var g=jQuery(i.currentTarget).data("mode");var c={advanced_filter:j,record:d,view:"SaveAjax",module:app.getModuleName(),mode:g};var f=a.getForm();var b=f.validationEngine("validate");if(b===true){var h=jQuery.progressIndicator({});AppConnector.request(c).then(function(k){h.progressIndicator({mode:"hide"});Vtiger_Helper_Js.showPnotify({text:app.vtranslate("JS_SAVE_NOTIFY_OK"),type:"success"});a.getContentHolder().find("#reportContentsDiv").html(k);Vtiger_Helper_Js.showHorizontalTopScrollBar();var e=parseInt(jQuery("#updatedCount").val());if(e<1000){jQuery("#countValue").text(e);jQuery("#moreRecordsText").hide()}else{jQuery("#countValue").html('<img src="layouts/basic/skins/images/loading.gif">');var l={module:app.getModuleName(),advanced_filter:j,record:d,action:"DetailAjax",mode:"getRecordsCount"};AppConnector.request(l).then(function(n){var m=parseInt(n.result);jQuery("#countValue").text(m);if(m>1000){jQuery("#moreRecordsText").show()}else{jQuery("#moreRecordsText").hide()}})}})}})},registerEventsForActions:function(){var a=this;jQuery(".reportActions").click(function(g){var f=jQuery(g.currentTarget);var c=f.data("href");var h=f.attr("name");var i=a.calculateValues();var b=a.getHeaderContentsHolder();if(h.indexOf("Print")!=-1){var j="<form action="+c+' method="POST" target="_blank">';if(typeof csrfMagicName!=="undefined"){j+='<input type = "hidden" name ="'+csrfMagicName+"\"  value='"+csrfMagicToken+"'>"}j+='<input type="hidden" value="" name="advanced_filter" id="advanced_filter" /></form>'}else{var j="<form action="+c+' method="POST">';if(typeof csrfMagicName!=="undefined"){j+='<input type = "hidden" name ="'+csrfMagicName+"\"  value='"+csrfMagicToken+"'>"}j+='<input type="hidden" value="" name="advanced_filter" id="advanced_filter" /></form>'}var k=jQuery(j);var d=k.appendTo(b);d.find("#advanced_filter").val(i);d.submit()})},registerEvents:function(){this._super();this.registerSaveOrGenerateReportEvent();this.registerEventsForActions();var a=this.getContentHolder();this.advanceFilterInstance=Vtiger_AdvanceFilter_Js.getInstance(jQuery(".filterContainer",a))}});