
Vtiger_Edit_Js("Calendar_Edit_Js",{},{isEvents:function(){var b=this.getForm();var a=b.find('[name="module"]').val();if(a=="Events"){return true}return false},registerReminderFieldCheckBox:function(){this.getForm().find('input[name="set_reminder"]').on("change",function(c){var b=jQuery(c.currentTarget);var a=b.closest("div").next();if(b.is(":checked")){a.removeClass("hide")}else{a.addClass("hide")}})},registerRecurrenceFieldCheckBox:function(){var a=this;a.getForm().find('input[name="recurringcheck"]').on("change",function(d){var c=jQuery(d.currentTarget);var b=jQuery("#repeatUI");if(c.is(":checked")){b.removeClass("hide")}else{b.addClass("hide")}})},registerRecurringTypeChangeEvent:function(){var a=this;jQuery("#recurringType").on("change",function(d){var c=jQuery(d.currentTarget);var b=c.val();a.changeRecurringTypesUIStyles(b)})},registerRepeatMonthActions:function(){var a=this;a.getForm().find('input[name="repeatMonth"]').on("change",function(b){a.repeatMonthOptionsChangeHandling()})},changeRecurringTypesUIStyles:function(b){var a=this;if(b=="Daily"||b=="Yearly"){jQuery("#repeatWeekUI").removeClass("show").addClass("hide");jQuery("#repeatMonthUI").removeClass("show").addClass("hide")}else{if(b=="Weekly"){jQuery("#repeatWeekUI").removeClass("hide").addClass("show");jQuery("#repeatMonthUI").removeClass("show").addClass("hide")}else{if(b=="Monthly"){jQuery("#repeatWeekUI").removeClass("show").addClass("hide");jQuery("#repeatMonthUI").removeClass("hide").addClass("show")}}}},repeatMonthOptionsChangeHandling:function(){if(jQuery("#repeatDay").is(":checked")){jQuery("#repeatMonthDate").attr("disabled",true);jQuery("#repeatMonthDayType").prop("disabled",false);jQuery("#repeatMonthDay").prop("disabled",false)}else{jQuery("#repeatMonthDate").removeAttr("disabled");jQuery("#repeatMonthDayType").prop("disabled",true);jQuery("#repeatMonthDay").prop("disabled",true)}},registerTimeStartChangeEvent:function(a){var b=this;a.on("changeTime",'input[name="time_start"]',function(t){var l=a.find('[name="date_start"]');var o=jQuery(t.currentTarget);var f=a.find('[name="time_end"]');var u=a.find('[name="due_date"]');if(u.data("userChangedTime")==true){return}if(jQuery('[name="userChangedEndDateTime"]').val()=="1"){return}var d=l.val();var m=o.val();var j=Vtiger_Time_Validator_Js.invokeValidation(o);if(j!=true){return}var r=d+" "+m;var p=a.find('[name="due_date"]').data("dateFormat");var c=f.data("format");var d=Vtiger_Helper_Js.getDateInstance(r,p);var k=Date.parse(d);var i=false;if(a.find('[name="activitytype"]').val()=="Call"){var g=a.find('[name="defaultCallDuration"]').val();i=k.addMinutes(g)}else{var q=a.find('[name="defaultOtherEventDuration"]').val();i=k.addMinutes(q)}var h=app.getDateInVtigerFormat(p,i);if(c==24){var n="HH:mm"}else{n="hh:mm tt"}var s=k.toString(n);u.val(h);f.val(s)});a.find('[name="date_start"]').on("change",function(l){var k=jQuery(l.currentTarget);var d=a.find('[name="due_date"]');var g=b.getDateInstance(a,"start");var i=b.getDateInstance(a,"end");var f=$("#userDateFormat").val();var h=$("#userTimeFormat").val();if(g>i){i=g;var j=app.getDateInVtigerFormat(f,i);d.val(j);app.registerEventForDatePickerFields(a)}var c=k.closest(".fieldValue").find('[name="time_start"]');c.trigger("changeTime")});a.find('input[name="time_start"]').on("focus",function(d){var c=jQuery(d.currentTarget);c.data("prevValue",c.val())});a.find('input[name="time_start"]').on("blur",function(i,g){if(typeof g=="undefined"){g={}}if(typeof g.forceChange=="undefined"){g.forceChange=false}var c=jQuery(i.currentTarget);var d=c.val();var h=c.data("prevValue");if(d!=h||g.forceChange){var f=c.data("timepicker-list");if(!f){c.timepicker("show");c.timepicker("hide");f=c.data("timepicker-list")}f.show();i=jQuery.Event("keydown");i.which=13;i.keyCode=13;c.trigger(i);f.hide()}})},registerEndDateTimeChangeLogger:function(a){a.find('[name="time_end"]').on("changeTime",function(f){var d=jQuery(f.currentTarget);var b=Vtiger_Time_Validator_Js.invokeValidation(d);if(b!=true){return}var c=d.closest(".fieldValue").find('[name="due_date"]');jQuery('[name="userChangedEndDateTime"]').val("1");c.data("userChangedTime",true)});a.find('[name="due_date"]').on("change",function(d){var c=jQuery(d.currentTarget);var b=Vtiger_Date_Validator_Js.invokeValidation(c);if(b!=true){return}jQuery('[name="userChangedEndDateTime"]').val("1");c.data("userChangedTime",true)})},registerFormSubmitEvent:function(){var b=this;var a=this.getForm();a.on("submit",function(d){var f=a.find('input[name="recurringcheck"]').is(":checked");if(f==false){jQuery("#recurringType").append(jQuery('<option value="--None--">None</option>')).val("--None--")}if(b.isEvents()){var c=jQuery("#selectedUsers").val();if(c!=null){c=jQuery("#selectedUsers").val().join(";")}jQuery('<input type="hidden" name="inviteesid" />').appendTo(a).val(c)}})},registerBasicEvents:function(a){this._super(a);this.toggleTimesInputs(a);this.registerTimesInputs(a);this.registerTimeStartChangeEvent(a);this.registerEndDateTimeChangeLogger(a);a.find('[name="activitytype"]').trigger("change")},toggleTimesInputs:function(a){a.find(":checkbox").change(function(){var b=$(this).attr("name");if("allday"==b){var c=$(this).is(":checked");if(!a.find("#quickCreate").length){if(c){a.find(".time").hide()}else{a.find(".time").show()}}}})},registerTimesInputs:function(b){var a=b.find('[name="allday"]:checkbox');if(a.prop("checked")){b.find(".time").hide()}},getDateInstance:function(d,m){var l=d.find('[name="date_start"]');var c=d.find('[name="due_date"]');var g=d.find('[name="time_end"]');var i=d.find('[name="time_start"]');var f=l.val();var e=i.val();var k=g.val();var j=c.val();var b=$("#userDateFormat").val();var h=$("#userTimeFormat").val();if(m=="start"){var a=Vtiger_Helper_Js.getDateInstance(f+" "+e,b)}if(m=="end"){var a=Vtiger_Helper_Js.getDateInstance(j+" "+k,b)}return a},registerEvents:function(){var a=this.proceedRegisterEvents();if(!a){return}this.registerReminderFieldCheckBox();this.registerRecurrenceFieldCheckBox();this.registerFormSubmitEvent();this.repeatMonthOptionsChangeHandling();this.registerRecurringTypeChangeEvent();this.registerRepeatMonthActions();this._super()}});