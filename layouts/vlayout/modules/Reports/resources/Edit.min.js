
Vtiger_Edit_Js("Reports_Edit_Js",{instance:{}},{currentInstance:false,reportsContainer:false,init:function(){var a=this.proceedRegisterEvents();if(!a){return}this.initiate()},getContainer:function(){return this.reportsContainer},setContainer:function(a){this.reportsContainer=a;return this},getInstance:function(c){if(c in Reports_Edit_Js.instance){return Reports_Edit_Js.instance[c]}else{var a=app.getViewName();var b=app.getModuleName()+"_"+a+c+"_Js";Reports_Edit_Js.instance[c]=new window[b]();return Reports_Edit_Js.instance[c]}},getStepValue:function(){var a=this.currentInstance.getContainer();return jQuery(".step",a).val()},initiate:function(a){if(typeof a=="undefined"){a=jQuery(".reportContents")}if(a.is(".reportContents")){this.setContainer(a)}else{this.setContainer(jQuery(".reportContents",a))}this.initiateStep("1");this.currentInstance.registerEvents()},initiateStep:function(a){var b="step"+a;this.activateHeader(b);var c=this.getInstance(a);this.currentInstance=c},activateHeader:function(b){var a=jQuery(".crumbs");a.find(".active").removeClass("active");jQuery("#"+b,a).addClass("active")},registerFormSubmitEvent:function(b){var a=this;if(jQuery.isFunction(a.currentInstance.submit)){b.on("submit",function(f){var c=jQuery(f.currentTarget);var d=true;if(jQuery.isFunction(a.currentInstance.isFormValidate)){var d=a.currentInstance.isFormValidate()}if(c.validationEngine("validate")&&d){a.currentInstance.submit().then(function(i){a.getContainer().append(i);var h=a.getStepValue();var g=parseInt(h)+1;a.initiateStep(g);a.currentInstance.initialize();var e=a.currentInstance.getContainer();a.registerFormSubmitEvent(e);a.currentInstance.registerEvents()})}f.preventDefault()})}},back:function(){var c=this.getStepValue();var b=parseInt(c)-1;this.currentInstance.initialize();var a=this.currentInstance.getContainer();a.remove();this.initiateStep(b);this.currentInstance.getContainer().show()},registerBackStepClickEvent:function(){var b=this;var a=this.getContainer();a.on("click",".backStep",function(c){b.back()})},registerEvents:function(){var a=this.proceedRegisterEvents();if(!a){return}var b=this.currentInstance.getContainer();this.registerFormSubmitEvent(b);this.registerBackStepClickEvent()}});