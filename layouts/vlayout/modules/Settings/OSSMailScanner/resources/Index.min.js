
jQuery.Class("Settings_OSSMailScanner_Index_Js",{},{registerColorField:function(a){var b={};b.tags=true;b.templateSelection=function(d){var c=d.id;var e=c.split("@");var f=d.text;if(!e[0]){f=$('<span class="domain">'+d.text+"</span>")}return f};app.showSelect2ElementView(a,b)},registerEvents:function(){var a=this;a.registerColorField($("#exceptions select"));$("#exceptions select").on("select2:select",function(c){var b=c.params.data.id;if(!!a.domainValidateToExceptions(b)||!!a.email_validate(b)){a.saveWidgetConfig(jQuery(this).attr("name"),jQuery(this).val().join(),"exceptions");a.registerColorField(jQuery(this))}else{jQuery(this).find("option[value='"+b+"']").remove();jQuery(this).trigger("change");var d={text:app.vtranslate("JS_mail_error"),type:"error",animation:"show"};Vtiger_Helper_Js.showPnotify(d)}}).on("select2:unselect",function(){a.saveWidgetConfig(jQuery(this).attr("name"),jQuery(this).val(),"exceptions")});$("#status").change(function(){$("#confirm").attr("disabled",!this.checked)});jQuery("#conftab_change_ticket_status").on("click",function(){var b={};b.data={module:"OSSMailScanner",action:"SaveRcConfig",ct:"emailsearch",type:"change_ticket_status",vale:$("#conftab_change_ticket_status").prop("checked")},b.async=true;AppConnector.request(b).then(function(c){if(c.success){var d={text:c.result.data,type:"info",animation:"show"};Vtiger_Helper_Js.showPnotify(d)}},function(d,c){})});jQuery(".delate_accont").on("click",function(){var c=this;if(window.confirm(app.vtranslate("whether_remove_an_identity"))){var d={};var b=jQuery(this).data("user-id");d.data={module:"OSSMailScanner",action:"AccontRemove",id:b},d.async=true;AppConnector.request(d).then(function(e){var f={text:e.result.data,type:"info",animation:"show"};Vtiger_Helper_Js.showPnotify(f);jQuery("#row_account_"+b).hide()},function(f,e){})}});jQuery(".identities_del").on("click",function(){var b=this;if(window.confirm(app.vtranslate("whether_remove_an_identity"))){var c={};c.data={module:"OSSMailScanner",action:"IdentitiesDel",id:jQuery(this).data("id")},c.async=true;AppConnector.request(c).then(function(d){var e={text:app.vtranslate("removed_identity"),type:"info",animation:"show"};Vtiger_Helper_Js.showPnotify(e);jQuery(b).parent().parent().remove()},function(e,d){})}});jQuery(".expand-hide").on("click",function(){var b=jQuery(this).data("user-id");var c=jQuery('tr[data-user-id="'+b+'"]');if("none"==c.css("display")){c.show()}else{c.hide()}});$(".alert").alert();jQuery("select[id^='function_list_']").change(function(){a.saveActions(jQuery(this).data("user-id"),jQuery(this).val())});jQuery("select[id^='user_list_']").change(function(){a.saveCRMuser(jQuery(this).data("user"),jQuery(this).val())});jQuery("#folder_inputReceived").change(function(){a.saveFolderList("Received",jQuery("#folder_inputReceived").val())});jQuery("#folder_inputSent").change(function(){a.saveFolderList("Sent",jQuery("#folder_inputSent").val())});jQuery("#folder_inputAll").change(function(){a.saveFolderList("All",jQuery("#folder_inputAll").val())});jQuery("#folder_inputSpam").change(function(){a.saveFolderList("Spam",jQuery("#folder_inputSpam").val())});jQuery("#folder_inputTrash").change(function(){a.saveFolderList("Trash",jQuery("#folder_inputTrash").val())});jQuery("#email_search").change(function(){a.saveEmailSearchList(jQuery("#email_search").val())});jQuery("#tab_email_view_widget_limit").on("blur",function(){a.saveWidgetConfig("widget_limit",jQuery(this).val(),"email_list")});jQuery("#tab_email_view_open_window").on("change",function(){a.saveWidgetConfig("target",jQuery(this).val(),"email_list")});jQuery('[name="email_to_notify"]').on("blur",function(){var b=jQuery(this).val();if(!!a.email_validate(b)){a.saveWidgetConfig("email",b,"cron")}else{var c={text:app.vtranslate("JS_mail_error"),type:"error",animation:"show"};Vtiger_Helper_Js.showPnotify(c)}});jQuery('[name="time_to_notify"]').on("blur",function(){var b=jQuery(this).val();if(!!a.number_validate(b)){a.saveWidgetConfig("time",jQuery(this).val(),"cron")}else{var c={text:app.vtranslate("JS_time_error"),type:"error",animation:"show"};Vtiger_Helper_Js.showPnotify(c)}})},saveActions:function(a,c){var b={module:"OSSMailScanner",action:"SaveActions",userid:a,vale:c};AppConnector.request(b).then(function(e){var d=e.result;if(d.success){var f={text:d.data,type:"info",animation:"show"};Vtiger_Helper_Js.showPnotify(f)}else{var f={text:d.data,animation:"show"};Vtiger_Helper_Js.showPnotify(f)}},function(e,d){})},saveCRMuser:function(a,b){var c={module:"OSSMailScanner",action:"SaveCRMuser",userid:a,value:b};AppConnector.request(c).then(function(e){var d=e.result;if(d.success){var f={text:d.data,type:"info",animation:"show"};Vtiger_Helper_Js.showPnotify(f)}else{var f={text:d.data,animation:"show"};Vtiger_Helper_Js.showPnotify(f)}},function(e,d){})},isEmpty:function(a){if(!!a){return a}return""},saveFolderList:function(a,c){var b={module:"OSSMailScanner",action:"saveFolderList",type:a,vale:c};AppConnector.request(b).then(function(e){var d=e.result;if(d.success){var f={text:d.data,type:"info",animation:"show"};Vtiger_Helper_Js.showPnotify(f)}else{var f={text:d.data,animation:"show"};Vtiger_Helper_Js.showPnotify(f)}},function(e,d){})},saveEmailSearchList:function(b){var a={module:"OSSMailScanner",action:"saveEmailSearchList",vale:b};AppConnector.request(a).then(function(d){var c=d.result;if(c.success){var e={text:c.data,type:"info",animation:"show"};Vtiger_Helper_Js.showPnotify(e)}else{var e={text:c.data,animation:"show"};Vtiger_Helper_Js.showPnotify(e)}},function(d,c){})},domainValidateToExceptions:function(b){var a=/^@([a-zA-Z0-9.-]+\.)+[a-zA-Z0-9.-]{2,63}$/;return a.test(b)},email_validate:function(b){var a=/^[a-zA-Z0-9._-]+@([a-zA-Z0-9.-]+\.)+[a-zA-Z0-9.-]{2,63}$/;return a.test(b)},number_validate:function(b){var a=!/^\s*$/.test(b)&&!isNaN(b);return a},saveWidgetConfig:function(a,c,b){var d={module:"OSSMailScanner",action:"SaveWidgetConfig",conf_type:b,name:a,value:c};AppConnector.request(d).then(function(f){var e=f.result;if(e.success){var g={text:e.data,type:"info",animation:"show"};Vtiger_Helper_Js.showPnotify(g)}else{var g={text:e.data,animation:"show"};Vtiger_Helper_Js.showPnotify(g)}},function(f,e){})}});