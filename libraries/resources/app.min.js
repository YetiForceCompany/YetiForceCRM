
var app={languageString:[],weekDaysArray:{Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6},cacheParams:[],getModuleName:function(){return this.getMainParams("module")},getParentModuleName:function(){return this.getMainParams("parent")},getViewName:function(){return this.getMainParams("view")},getRecordId:function(){var a=this.getViewName();var b;if(a=="Edit"||"PreferenceEdit"){b=this.getMainParams("recordId")}else{if(a=="Detail"||"PreferenceDetail"){b=this.getMainParams("recordId")}}return b},getLanguage:function(){return jQuery("body").data("language")},getLayoutPath:function(){return jQuery("body").data("layoutpath")},getPageTitle:function(){return document.title},setPageTitle:function(a){document.title=a},getContentsContainer:function(){return jQuery(".bodyContents")},changeSelectElementView:function(e,b,a){var f=this;var d=jQuery();if(typeof e=="undefined"){e=jQuery("body")}if(b=="select2"){return app.showSelect2ElementView(e,a)}if(b=="selectize"){return app.showSelectizeElementView(e,a)}d=jQuery(".chzn-select",e);if(e.is("select.chzn-select")){d=e}d.each(function(){if($(this).prop("id").length==0){$(this).attr("id","sel"+f.generateRandomChar()+f.generateRandomChar()+f.generateRandomChar())}});d.filter("[multiple]").filter('[data-validation-engine*="validate"]').on("change",function(i){jQuery(i.currentTarget).trigger("focusout")});var h={no_results_text:app.vtranslate("JS_NO_RESULTS_FOUND")+":"};var c=app.getModuleName();if(d.filter("[multiple]")&&c!="Install"){h.placeholder_text_multiple=" "+app.vtranslate("JS_SELECT_SOME_OPTIONS")}if(c!="Install"){h.placeholder_text_single=" "+app.vtranslate("JS_SELECT_AN_OPTION")}d.chosen(h);d.each(function(){var i=$(this);if(i.hasClass("hideSelected")){var j=[];i.find("optgroup,option").each(function(l,k){if(jQuery(this).hasClass("hide")){j.push(l)}});if(j.length){i.next().find(".search-choice-close").each(function(o,m){var l=jQuery(this);var k=l.data("option-array-index");if(jQuery.inArray(k,j)!=-1){l.closest("li").remove()}})}}if(i.attr("readonly")=="readonly"){i.on("chosen:updated",function(){if(i.attr("readonly")){var l=i.is(":disabled");var k=i.data("chosen");i.attr("disabled","disabled");if(typeof k=="object"){k.search_field_disabled()}if(l){i.attr("disabled","disabled")}else{i.removeAttr("disabled")}}});i.trigger("chosen:updated")}});var g=jQuery(".chosen-container-multi .default").css("width","100%");return g},destroyChosenElement:function(b){var a=jQuery();if(typeof b=="undefined"){b=jQuery("body")}a=jQuery(".chzn-select",b);if(b.is("select.chzn-select")){a=b}a.css("display","block").removeClass("chzn-done").data("chosen",null).next().remove();return a},destroySelectizeElement:function(a){var b=jQuery();if(typeof a=="undefined"){a=jQuery("body")}b=jQuery(".selectized",a);if(a.is("select.selectized")){b=a}b.each(function(){$(this)[0].selectize.destroy()})},showSelect2ElementView:function(d,g){if(typeof g=="undefined"){g={}}var e=d.data();if(e!=null){g=jQuery.extend(e,g)}g.language={};g.theme="bootstrap";g.width="100%";g.language.noResults=function(h){return app.vtranslate("JS_NO_RESULTS_FOUND")};if(typeof g.customSortOptGroup!="undefined"&&g.customSortOptGroup){jQuery("optgroup",d).each(function(){var i=jQuery(this);var h=i.children().toArray().sort(function(l,k){var m=jQuery(l).text();var j=jQuery(k).text();return m<j?1:-1});jQuery.each(h,function(k,j){i.prepend(j)})});delete g.customSortOptGroup}if(typeof g.maximumSelectionLength!="undefined"&&typeof g.formatSelectionTooBig=="undefined"){var b=g.maximumSelectionLength;var f=function(h){return app.vtranslate("JS_YOU_CAN_SELECT_ONLY")+" "+h.maximum+" "+app.vtranslate("JS_ITEMS")};g.language.maximumSelected=f}if(typeof d.attr("multiple")!="undefined"&&!g.placeholder){g.tags="true";g.placeholder=app.vtranslate("JS_SELECT_SOME_OPTIONS")}else{if(!g.placeholder){g.placeholder=app.vtranslate("JS_SELECT_AN_OPTION")}}if(typeof g.templateResult==="undefined"){g.templateResult=function(i,h){if(i.element&&i.element.className){$(h).addClass(i.element.className)}if(typeof i.name=="undefined"){return i.text}if(i.type=="optgroup"){return"<strong>"+i.name+"</strong>"}else{return"<span>"+i.name+"</span>"}}}if(typeof g.templateSelection==="undefined"){g.templateSelection=function(i,h){if(i.element&&i.element.className){$(h).addClass(i.element.className)}if(i.text===""){return i.name}return i.text}}if(d.data("ajaxSearch")===1){g.tags=false;g.language.searching=function(){return app.vtranslate("JS_SEARCHING")};g.language.inputTooShort=function(h){var i=h.minimum-h.input.length;return app.vtranslate("JS_INPUT_TOO_SHORT").replace("_LENGTH_",i)};g.language.errorLoading=function(){return app.vtranslate("JS_NO_RESULTS_FOUND")};g.placeholder="";g.ajax={url:d.data("ajaxUrl"),dataType:"json",delay:250,data:function(h){return{value:h.term,page:h.page}},processResults:function(i,j){var h=new Array;if(i.success==true){d.find("option").each(function(){var k=$(this);h.push({label:k.html(),value:k.val(),})});h=h.concat(i.result.items)}return{results:h,pagination:{more:false}}},cache:false};g.escapeMarkup=function(h){if(h!=="undefined"){return h}};var a=3;if(d.data("minimumInput")!="undefined"){a=d.data("minimumInput")}g.minimumInputLength=a;g.templateResult=function(h){if(typeof h.name=="undefined"){return h.text}if(h.type=="optgroup"){return"<strong>"+h.name+"</strong>"}else{return"<span>"+h.name+"</span>"}};g.templateSelection=function(i,h){if(i.text===""){return i.name}return i.text}}var c=d;d.each(function(j){var h=$(this);if(h.attr("readonly")=="readonly"&&!h.attr("disabled")){var i=h.clone().addClass("hide");h.parent().append(i);h.prop("disabled",true)}h.select2(g).on("select2:open",function(m){if(h.data("unselecting")){h.removeData("unselecting");setTimeout(function(n){h.each(function(){jQuery(this).select2("close")})},1)}var l=jQuery(m.currentTarget);var k=l.data("select2");k.$dropdown.css("z-index",1000002)}).on("select2:unselect",function(k){h.data("unselecting",true)})});return d},showSelectizeElementView:function(a,b){if(typeof b=="undefined"){b={plugins:["remove_button"]}}a.selectize(b);return a},hidePopover:function(a){if(typeof a=="undefined"){a=jQuery("body .popoverTooltip")}a.popover("hide")},showPopoverElementView:function(a,c){if(typeof c=="undefined"){c={trigger:"hover",placement:"bottom",html:true}}c.container="body";var b;a.each(function(d,g){b=c;var e=jQuery(g);if(e.data("placement")){b.placement=e.data("placement")}if(e.hasClass("delay0")){b.delay={show:0,hide:0}}var f=e.data();if(f!=null){b=jQuery.extend(f,b)}e.popover(b)});return a},registerChangeEventForMultiSelect:function(c,d){if(typeof c=="undefined"){return}var a=c.data("select2");var b=d.maximumSelectionLength;c.on("change",function(g){var f=a.data();if(jQuery.isArray(f)&&f.length>=b){a.updateResults()}})},getSerializedData:function(h,j){if(typeof j=="undefined"){j="string"}h=jQuery(h);var i=h.children().serialize();if(j=="string"){return i}var g={};var b=i.split("&");for(var e in b){var f=b[e];var a=f.split("=");var d=a[0];var c=a[1];g[d]=decodeURIComponent(c)}return g},showModalWindow:function(e,a,d,i){var h=this;var c="globalmodal";if(typeof e=="object"&&e!=null&&!(e instanceof jQuery)){if(e.id!=undefined){c=e.id}i=e.css;d=e.cb;a=e.url;if(e.sendByAjaxCb!="undefined"){var f=e.sendByAjaxCb}e=e.data}if(typeof a=="function"){if(typeof d=="object"){i=d}d=a;a=false}else{if(typeof a=="object"){d=function(){};i=a;a=false}}if(typeof d!="function"){d=function(){}}if(typeof f!="function"){var f=function(){}}var b=jQuery("#"+c);if(b.length){b.remove()}b=jQuery("<div></div>");b.attr("id",c).addClass("modalContainer");var g=function(k){var l={show:true,};if(jQuery("#backgroundClosingModal").val()!=1){l.backdrop="static"}if(typeof i=="object"){b.css(i);l=jQuery.extend(l,i)}b.html(k);if(b.find(".modal").hasClass("static")){l.backdrop="static"}$.fn.modal.Constructor.prototype.enforceFocus=function(m){$(document).off("focusin.bs.modal").on("focusin.bs.modal",$.proxy(function(n){if($(n.target).hasClass("select2-search__field")){return true}},this))};var j=b.find(".modal:first");j.modal(l);jQuery("body").append(b);app.changeSelectElementView(j);app.showSelect2ElementView(j.find("select.select2"));app.showSelectizeElementView(j.find("select.selectize"));app.registerEventForDatePickerFields(j);h.registerModalEvents(j,f);h.showPopoverElementView(j.find(".popoverTooltip"));h.registerDataTables(j.find(".dataTable"));j.one("shown.bs.modal",function(){var m=jQuery(".modal-backdrop");if(m.length>1){jQuery(".modal-backdrop:not(:first)").remove()}d(j)})};if(e){g(e)}else{jQuery.get(a).then(function(j){g(j)})}b.one("hidden.bs.modal",function(){b.remove();var k=jQuery(".modal-backdrop");var j=jQuery(".modalContainer");if(j.length==0&&k.length){k.remove()}if(k.length>0){$("body").addClass("modal-open")}});return b},hideModalWindow:function(f,e){if(e==undefined){e="globalmodal"}var c=jQuery("#"+e);if(c.length<=0){return}if(typeof f!="function"){f=function(){}}var b=c.find(".modal");b.modal("hide");var d=jQuery(".modal-backdrop:last");var a=jQuery(".modalContainer");if(a.length==0&&d.length){d.remove()}b.one("hidden.bs.modal",f)},registerModalEvents:function(a,c){var d=a.find("form");var b=false;if(d.hasClass("validateForm")){d.validationEngine(app.validationEngineOptions);b=true}if(d.hasClass("sendByAjax")){d.submit(function(i){var f=true;i.preventDefault();if(b&&d.data("jqv").InvalidFields.length>0){app.formAlignmentAfterValidation(d);f=false}if(f){var h=jQuery.progressIndicator({blockInfo:{enabled:true}});var g=d.serializeFormData();AppConnector.request(g).then(function(e){c(g,e);app.hideModalWindow();h.progressIndicator({mode:"hide"})})}})}},isHidden:function(a){if(a.css("display")=="none"){return true}return false},isInvisible:function(a){if(a.css("visibility")=="hidden"){return true}return false},validationEngineOptions:{scroll:false,promptPosition:"topLeft",prettySelect:true,useSuffix:"_chosen",usePrefix:"s2id_",},validationEngineOptionsForRecord:{scroll:false,promptPosition:"topLeft",prettySelect:true,useSuffix:"_chosen",usePrefix:"s2id_",validateNonVisibleFields:true,onBeforePromptType:function(a){var b=a.closest(".blockContainer");if(b.find(".blockContent").is(":hidden")){b.find(".blockHeader").click()}},},formAlignmentAfterValidation:function(d){var c=d.find(".formError:not('.greenPopup'):first");if(c.length>0){var a=c.offset().top;var b=a-105;jQuery("html").animate({scrollTop:b},"slow")}},convertToDatePickerFormat:function(a){switch(a){case"yyyy-mm-dd":return"Y-m-d";break;case"mm-dd-yyyy":return"m-d-Y";break;case"dd-mm-yyyy":return"d-m-Y";break;case"yyyy.mm.dd":return"Y.m.d";break;case"mm.dd.yyyy":return"m.d.Y";break;case"dd.mm.yyyy":return"d.m.Y";break;case"yyyy/mm/dd":return"Y/m/d";break;case"mm/dd/yyyy":return"m/d/Y";break;case"dd/mm/yyyy":return"d/m/Y";break}},convertTojQueryDatePickerFormat:function(b){var e=0;var g="-";if(b.indexOf("-")!=-1){g="-"}if(b.indexOf(".")!=-1){g="."}if(b.indexOf("/")!=-1){g="/"}var f=b.split(g);for(var e in f){var d=f[e];var a=d.length;if(a==4){var c=d.substring(0,2);f[e]=c}}var h=f.join(g);return h},getDateInVtigerFormat:function(a,c){var d=app.convertTojQueryDatePickerFormat(a);var b=jQuery.datepicker.formatDate(d,c);return b},getDateInDBInsertFormat:function(a,g){var b=0;var k="-";if(a.indexOf("-")!=-1){k="-"}if(a.indexOf(".")!=-1){k="."}if(a.indexOf("/")!=-1){k="/"}var j=a.split(k);var h=g.split(k);var f="";var d="";var e="";for(b in j){var c=j[b];switch(c){case"dd":f=h[b];break;case"mm":d=h[b];break;case"yyyy":e=h[b];break}}return e+"-"+d+"-"+f},registerEventForTextAreaFields:function(a){if(typeof a=="undefined"){a=jQuery("body")}a=jQuery(a);if(a.is("textarea")){var b=a}else{var b=jQuery("textarea",a)}if(b.length==0){return}b.autosize()},registerEventForDatePickerFields:function(l,c,d){if(typeof l=="undefined"){l=jQuery("body")}if(typeof c=="undefined"){c=true}l=jQuery(l);if(l.hasClass("dateField")){var j=l}else{var j=jQuery(".dateField",l)}if(j.length==0){return}if(c==true){var f=j.closest(".date");jQuery(".input-group-addon:not(.notEvent)",f).on("click",function(n){var m=jQuery(n.currentTarget);m.closest(".date").find("input.dateField").get(0).focus()})}var a=j.data("dateFormat");var e=app.convertToDatePickerFormat(a);var i=jQuery("body").data("language");var b=i.split("_");var h=jQuery("#start_day").val();if(h==""||typeof(h)=="undefined"){var k=1}else{k=this.weekDaysArray[h]}var g={format:e,calendars:1,locale:$.fn.datepicker.dates[b[0]],starts:k,eventName:"focus",onChange:function(p){var m=jQuery(this).data("datepicker").el;m=jQuery(m);var n=jQuery("#"+jQuery(this).data("datepicker").id);var o=n.find("table.datepickerViewDays");if(o.length>0&&m.val()!=p){m.DatePickerHide();m.blur()}m.data("prevVal",m.val());m.val(p).trigger("change").focusout()},onBeforeShow:function(m){j.each(function(n,o){var p=jQuery(o);if(p[0]!=document.activeElement){p.DatePickerHide();p.blur()}})},};if(typeof d!="undefined"){var g=jQuery.extend(g,d)}j.each(function(n,p){var q=jQuery(p);var m=new Date();var o=app.getDateInVtigerFormat(a,m);if(q.val()!=""){o=q.val()}g.date=o;g.current=o;q.data("prevVal",q.val());q.DatePicker(g)})},registerEventForDateFields:function(a){if(typeof a=="undefined"){a=jQuery("body")}a=jQuery(a);if(a.hasClass("dateField")){var b=a}else{var b=jQuery(".dateField",a)}b.datepicker({autoclose:true}).on("changeDate",function(f){var e=jQuery(f.currentTarget);var c=e.data("dateFormat");var g=app.getDateInVtigerFormat(c,f.date);var d=jQuery.datepicker.formatDate(g,f.date);e.val(d)})},registerEventForClockPicker:function(a){if(typeof a==="undefined"){var d=$(".clockPicker");var e=app.getMainParams("userTimeFormat")}else{d=a;var e=d.data("format")}e=e==12?true:false;var c={placement:"bottom",autoclose:true,twelvehour:e,minutestep:5,ampmSubmit:false,};var b=d.closest(".time");jQuery(".input-group-addon",b).on("click",function(h){var g=jQuery(h.currentTarget);h.stopPropagation();var f=g.closest(".time").find("input.clockPicker");if(f.attr("disabled")!="disabled"){f.clockpicker("show")}});d.clockpicker(c)},registerDataTables:function(a){if($.fn.dataTable==undefined){return false}if(a.length==0){return false}$.extend($.fn.dataTable.defaults,{language:{sLengthMenu:app.vtranslate("JS_S_LENGTH_MENU"),sZeroRecords:app.vtranslate("JS_NO_RESULTS_FOUND"),sInfo:app.vtranslate("JS_S_INFO"),sInfoEmpty:app.vtranslate("JS_S_INFO_EMPTY"),sSearch:app.vtranslate("JS_SEARCH"),sEmptyTable:app.vtranslate("JS_NO_RESULTS_FOUND"),sInfoFiltered:app.vtranslate("JS_S_INFO_FILTERED"),sLoadingRecords:app.vtranslate("JS_LOADING_OF_RECORDS"),sProcessing:app.vtranslate("JS_LOADING_OF_RECORDS"),oPaginate:{sFirst:app.vtranslate("JS_S_FIRST"),sPrevious:app.vtranslate("JS_S_PREVIOUS"),sNext:app.vtranslate("JS_S_NEXT"),sLast:app.vtranslate("JS_S_LAST")},oAria:{sSortAscending:app.vtranslate("JS_S_SORT_ASCENDING"),sSortDescending:app.vtranslate("JS_S_SORT_DESCENDING")}}});return a.DataTable()},registerEventForTimeFields:function(b,a,f){if(typeof cotainer=="undefined"){b=jQuery("body")}if(typeof a=="undefined"){a=true}b=jQuery(b);if(b.hasClass("timepicker-default")){var c=b}else{var c=b.find(".timepicker-default")}if(a==true){var d=c.closest(".time");jQuery(".input-group-addon",d).on("click",function(i){var h=jQuery(i.currentTarget);h.closest(".time").find(".timepicker-default").focus()})}if(typeof f=="undefined"){f={}}var g=c.data("format");if(g=="24"){g="H:i"}else{g="h:i A"}var e={timeFormat:g,className:"timePicker"};var f=jQuery.extend(e,f);c.timepicker(f);return b},destroyTimeFields:function(a){if(typeof cotainer=="undefined"){a=jQuery("body")}if(a.hasClass("timepicker-default")){var b=a}else{var b=a.find(".timepicker-default")}b.data("timepicker-list",null);return a},getChosenElementFromSelect:function(a){var b=a.attr("id");var c=b+"_chosen";return jQuery("#"+c)},getSelect2ElementFromSelect:function(a){var b=a.attr("id");var c="select2-"+b+"-container";return jQuery("#"+c).closest(".select2-container")},getSelectElementFromChosen:function(c){var b=c.attr("id");var a=b.split("_chosen");var d=a["0"];return jQuery("#"+d)},setInheritWidth:function(a){jQuery(a).each(function(b,c){var d=jQuery(c).parent().width();jQuery(c).width(d)})},initGuiders:function(a){},showScrollBar:function(b,a){if(typeof a=="undefined"){a={}}if(typeof a.height=="undefined"){a.height=b.css("height")}return b.slimScroll(a)},showHorizontalScrollBar:function(b,a){if(typeof a=="undefined"){a={}}var c={horizontalScroll:true,theme:"dark-thick",advanced:{autoExpandHorizontalScroll:true}};if(typeof a!="undefined"){var c=jQuery.extend(c,a)}return b.mCustomScrollbar(c)},vtranslate:function(b){if(app.languageString[b]!=undefined){return app.languageString[b]}else{var a=jQuery("#js_strings").text();if(a!=""){app.languageString=JSON.parse(a);if(b in app.languageString){return app.languageString[b]}}}return b},vimage_path:function(a){return app.getLayoutPath()+"/skins/images/"+a},cacheNSKey:function(a){return"yf."+a},cacheGet:function(b,a){b=this.cacheNSKey(b);return jQuery.jStorage.get(b,a)},cacheSet:function(b,c,a){b=this.cacheNSKey(b);jQuery.jStorage.set(b,c);if(a){jQuery.jStorage.setTTL(b,a)}},cacheClear:function(a){a=this.cacheNSKey(a);return jQuery.jStorage.deleteKey(a)},moduleCacheSet:function(c,e,a){if(a==undefined){a=12*60*60*1000}var b=c;c=this.getModuleName()+"_"+c;this.cacheSet(c,e,a);var f="mCache"+this.getModuleName();var d=this.cacheGet(f);if(d==null){d=[]}else{d=d.split(",")}d.push(b);this.cacheSet(f,Vtiger_Helper_Js.unique(d).join(","))},moduleCacheGet:function(a){return this.cacheGet(this.getModuleName()+"_"+a)},moduleCacheKeys:function(){var b="mCache"+this.getModuleName();var a=this.cacheGet(b);if(a){return a.split(",")}return[]},moduleCacheClear:function(b){var d=this;var a=this.getModuleName();var e="mCache"+a;var c=this.cacheGet(e);if(c==null){c=[]}else{c=c.split(",")}$.each(c,function(f,g){d.cacheClear(a+"_"+g)});d.cacheClear(e)},htmlEncode:function(a){if(a){return jQuery("<div />").text(a).html()}else{return""}},htmlDecode:function(a){if(a){return $("<div />").html(a).text()}else{return""}},placeAtCenter:function(a){a.css("position","absolute");a.css("top",((jQuery(window).height()-a.outerHeight())/2)+jQuery(window).scrollTop()+"px");a.css("left",((jQuery(window).width()-a.outerWidth())/2)+jQuery(window).scrollLeft()+"px")},getvalidationEngineOptions:function(a){return app.validationEngineOptions},notifyPostAjaxReady:function(){jQuery(document).trigger("postajaxready")},listenPostAjaxReady:function(a){jQuery(document).on("postajaxready",a)},setFormValues:function(b){for(var a in b){jQuery(a).val(b[a])}},setRTEValues:function(c){for(var a in c){var b=CKEDITOR.instances[a];if(b){b.setData(c[a])}}},getPageController:function(){var c=app.getModuleName();var a=app.getViewName();var e=app.getParentModuleName();var d=e+"_"+c+"_"+a+"_Js";if(typeof window[d]=="undefined"){d=e+"_Vtiger_"+a+"_Js"}if(typeof window[d]=="undefined"){d=c+"_"+a+"_Js"}var b=jQuery("#extendModules").val();if(typeof window[d]=="undefined"&&b!=undefined){d=b+"_"+a+"_Js"}if(typeof window[d]=="undefined"){d="Vtiger_"+a+"_Js"}if(typeof window[d]!="undefined"){return new window[d]()}},getDecodedValue:function(a){return jQuery("<div></div>").html(a).text()},getColorContrast:function(f){var d=parseInt(f.substr(0,2),16);var c=parseInt(f.substr(2,2),16);var a=parseInt(f.substr(4,2),16);var e=((d*299)+(c*587)+(a*114))/1000;return(e>=128)?"light":"dark"},updateRowHeight:function(){var c=jQuery("#row_type").val();if(c.length<=0){var b=app.cacheGet("widthType","mediumWidthType");var e=b;switch(e){case"narrowWidthType":e="narrow";break;case"wideWidthType":e="wide";break;default:e="medium"}var a=jQuery("#current_user_id").val();var d={module:"Users",action:"SaveAjax",record:a,value:e,field:"rowheight"};AppConnector.request(d).then(function(){jQuery(c).val(e)})}},getCookie:function(b){var c=document.cookie;var d=c.indexOf(" "+b+"=");if(d==-1){d=c.indexOf(b+"=")}if(d==-1){c=null}else{d=c.indexOf("=",d)+1;var a=c.indexOf(";",d);if(a==-1){a=c.length}c=unescape(c.substring(d,a))}return c},setCookie:function(a,d,b){var e=new Date();e.setDate(e.getDate()+b);var c=escape(d)+((b==null)?"":"; expires="+e.toUTCString());document.cookie=a+"="+c},getUrlVar:function(b){var a=function(){var d={};var c=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,f,g){d[f]=g});return d};return a()[b]},getStringDate:function(b){var c=b.getDate();var a=b.getMonth()+1;var e=b.getFullYear();c=(c<=9)?("0"+c):c;a=(a<=9)?("0"+a):a;return e+"-"+a+"-"+c},formatDate:function(b){var j=b.getFullYear(),a=b.getMonth()+1,g=b.getDate(),f=b.getHours(),c=b.getMinutes(),e=b.getSeconds();return j+"-"+this.formatDateZ(a)+"-"+this.formatDateZ(g)+" "+this.formatDateZ(f)+":"+this.formatDateZ(c)+":"+this.formatDateZ(e)},formatDateZ:function(a){return(a<=9?"0"+a:a)},howManyDaysFromDate:function(c){var d=c.getTime();var a=new Date();var b=new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime();return Math.floor(((b-d)/(1000*60*60*24)))+1},saveAjax:function(f,e,d){var a=jQuery.Deferred();var c={};c.module=app.getModuleName();c.parent=app.getParentModuleName();c.action="SaveAjax";c.mode=f;c.param=e;if(d!=undefined){for(var b in d){c[b]=d[b]}}AppConnector.request(c).then(function(g){a.resolve(g)},function(g){a.reject()});return a.promise()},showBtnSwitch:function(a,b){if(typeof b=="undefined"){b={}}a.bootstrapSwitch(b);return a},generateRandomChar:function(){var c,b,a;c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZ";a=Math.floor(Math.random()*c.length);return b=c.substring(a,a+1)},getMainParams:function(c,a){if(app.cacheParams[c]==undefined){var b=$("#"+c).val();app.cacheParams[c]=b}var b=app.cacheParams[c];if(a){if(b!=""){b=$.parseJSON(b)}else{b=[]}}return b},setMainParams:function(b,a){app.cacheParams[b]=a;$("#"+b).val(a)},parseNumberToShow:function(e){if(e==undefined){e=0}var b=parseInt(app.getMainParams("numberOfCurrencyDecimal"));var i=app.getMainParams("currencyDecimalSeparator");var c=app.getMainParams("currencyGroupingSeparator");var k=app.getMainParams("currencyGroupingPattern");e=parseFloat(e).toFixed(b);var h=e.toString().split(".");var g=h[0];var f=h[1];if(k=="123,456,789"){g=g.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+c)}else{if(k=="123456,789"){var j=g.slice(-3);var d=g.slice(0,-3);g=d+c+j}else{if(k=="12,34,56,789"){var j=g.slice(-3);var d=g.slice(0,-3);g=d.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+c)+c+j}}}return g+i+f},parseNumberToFloat:function(c){var d=parseInt(app.getMainParams("numberOfCurrencyDecimal"));var a=app.getMainParams("currencyGroupingSeparator");var b=app.getMainParams("currencyDecimalSeparator");if(c==undefined||c==""){c=0}c=c.toString();c=c.split(a).join("");c=c.replace(/\s/g,"").replace(b,".");return parseFloat(c)},errorLog:function(a,b,c){if(typeof a=="object"&&a.responseText){a=a.responseText}if(typeof a=="object"&&a.statusText){a=a.statusText}if(a){console.error(a)}if(b){console.error(b)}if(c){console.error(c)}console.log("-----------------")},registerModal:function(a){if(typeof a=="undefined"){a=jQuery("body")}a.off("click","button.showModal, a.showModal").on("click","button.showModal, a.showModal",function(f){f.preventDefault();var d=jQuery(f.currentTarget);var c=d.data("url");if(typeof c!="undefined"){if(d.hasClass("popoverTooltip")){d.popover("hide")}d.attr("disabled",true);var g={url:c,cb:function(i){var j=d.data("cb");if(typeof j!=="undefined"){if(j.indexOf(".")!=-1){var e=j.split(".");if(typeof window[e[0]]==="object"){window[e[0]][e[1]](i)}}else{if(typeof window[j]==="function"){window[j](i)}}}d.removeAttr("disabled")}};var h="globalmodal";if($("#"+h).length){var b=1;while($("#"+h).length){h="globalmodal"+b++}g.id=h}app.showModalWindow(g)}f.stopPropagation()})},playSound:function(b){var c=app.getMainParams("sounds");c=JSON.parse(c);if(c.IS_ENABLED){var a=new Audio(app.getLayoutPath()+"/sounds/"+c[b]);a.play()}},registerSticky:function(){var a=jQuery(".stick");a.each(function(){var c=jQuery(this);var b=c.data("position");if(b=="top"){var d=c.offset().top-50;jQuery(".mainBody").scroll(function(){if($(this).scrollTop()>d){c.css({position:"fixed",top:"50px",width:c.width()})}else{if($(this).scrollTop()<=d){c.css({position:"",top:"",width:""})}}})}if(b=="bottom"){var d=c.offset().top-jQuery(window).height();jQuery(".mainBody").scroll(function(){if($(this).scrollTop()<d){c.css({position:"fixed",bottom:"33px",width:c.width()})}else{if($(this).scrollTop()>=d){c.css({position:"",bottom:"",width:""})}}})}})},registerMoreContent:function(a){a.on("click",function(d){var b=jQuery(d.currentTarget);var c=b.closest(".moreContent");c.find(".teaserContent").toggleClass("hide");c.find(".fullContent").toggleClass("hide");if(b.text()==b.data("on")){b.text(b.data("off"))}else{b.text(b.data("on"))}})},getScreenHeight:function(a){if(typeof a=="undefined"){a=100}return jQuery(window).height()*a/100},registerCopyClipboard:function(a){if(a==undefined){a=".clipboard"}new Clipboard(a,{text:function(b){Vtiger_Helper_Js.showPnotify({text:app.vtranslate("JS_NOTIFY_COPY_TEXT"),type:"success"});b=jQuery(b);var c=jQuery(b.data("copyTarget"));if(b.data("copyType")!=undefined){if(c.is("select")){var d=c.find("option:selected").data(b.data("copyType"))}else{var d=c.data(b.data("copyType"))}}else{var d=c.val()}return d}})},};jQuery(document).ready(function(){app.changeSelectElementView();jQuery("body").find("select.select2").each(function(b){app.showSelect2ElementView($(this))});app.showSelectizeElementView(jQuery("body").find("select.selectize"));app.showPopoverElementView(jQuery("body").find(".popoverTooltip"));app.showBtnSwitch(jQuery("body").find(".switchBtn"));app.registerSticky();app.registerMoreContent(jQuery("body").find("button.moreBtn"));app.registerModal();app.updateRowHeight();String.prototype.toCamelCase=function(){var b=this.valueOf();return b.charAt(0).toUpperCase()+b.slice(1).toLowerCase()};if(/MSIE/.test(navigator.userAgent)||(/Trident/).test(navigator.userAgent)){jQuery("textarea").resizable()}var a=app.getPageController();if(a){a.registerEvents()}});$.fn.getNumberFromValue=function(){return app.parseNumberToFloat($(this).val())};$.fn.getNumberFromText=function(){return app.parseNumberToFloat($(this).text())};