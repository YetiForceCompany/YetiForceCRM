'use strict';

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
  return typeof obj;
} : function (obj) {
  return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
};

var classCallCheck = function (instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
};

var createClass = function () {
  function defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  return function (Constructor, protoProps, staticProps) {
    if (protoProps) defineProperties(Constructor.prototype, protoProps);
    if (staticProps) defineProperties(Constructor, staticProps);
    return Constructor;
  };
}();

window.App={Components:{Tree:{Basic:function(){function Basic(){var container=0<arguments.length&&void 0!==arguments[0]?arguments[0]:$('.js-tree-container');classCallCheck(this,Basic),this.treeInstance=!1,this.treeData=!1,this.generateTree(container);}return createClass(Basic,[{key:'generateTree',value:function generateTree(container){var slef=this;!1===slef.treeInstance&&(slef.treeInstance=container,slef.treeInstance.on('select_node.jstree',function(e,data){data.instance.select_node(data.node.children_d);}).on('deselect_node.jstree',function(e,data){data.instance.deselect_node(data.node.children_d);}).jstree({core:{data:slef.getRecords(container),themes:{name:'proton',responsive:!0}},plugins:['search','checkbox']}),this.registerSearchEvent());}},{key:'registerSearchEvent',value:function registerSearchEvent(){var self=this,searchTimeout=!1,treeSearch=$('.js-tree-search');treeSearch.on('keyup',function(){searchTimeout&&clearTimeout(searchTimeout),searchTimeout=setTimeout(function(){var searchValue=treeSearch.val();self.treeInstance.jstree(!0).search(searchValue);},250);});}},{key:'getRecords',value:function getRecords(container){return !1===this.treeData&&'undefined'!==container&&(this.treeData=JSON.parse(container.find('.js-tree-data').val())),this.treeData}}]),Basic}()}}},window.app={languageString:[],breakpoints:{xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1300,xxxl:1700},cacheParams:[],modalEvents:[],mousePosition:{x:0,y:0},childFrame:!1,touchDevice:!1,event:new function(){this.el=$({}),this.trigger=function(){this.el.trigger(arguments[0],Array.prototype.slice.call(arguments,1));},this.on=function(){this.el.on.apply(this.el,arguments);},this.one=function(){this.el.one.apply(this.el,arguments);},this.off=function(){this.el.off.apply(this.el,arguments);};},getModuleName:function getModuleName(){return this.getMainParams('module')},getParentModuleName:function getParentModuleName(){return this.getMainParams('parent')},getViewName:function getViewName(){return this.getMainParams('view')},getRecordId:function getRecordId(){var recordId,view=this.getViewName();return -1!==$.inArray(view,['Edit','PreferenceEdit','Detail','PreferenceDetail','DetailPreview'])&&(recordId=this.getMainParams('recordId')),recordId},getRecordDetails:function getRecordDetails(params){var aDeferred=$.Deferred();return 'Settings'===app.getParentModuleName()&&(params.parent='Settings'),AppConnector.request(Object.assign(params,{action:'GetData'})).done(function(data){data.success?aDeferred.resolve(data):aDeferred.reject(data.message);}).fail(function(){aDeferred.reject();}),aDeferred.promise()},getLanguage:function getLanguage(){return $('body').data('language')},getPageTitle:function getPageTitle(){return document.title},getWindowParent:function getWindowParent(){return 'undefined'!=typeof window.frames[0]&&'undefined'!=typeof window.frames[0].app&&window.frames[0].app.childFrame?window.frames[0]:window},isTouchDevice:function isTouchDevice(){var supportsTouch=!1;return 'ontouchstart'in window?supportsTouch=!0:window.navigator.msPointerEnabled?supportsTouch=!0:'ontouchstart'in document.documentElement&&(supportsTouch=!0),supportsTouch&&$('<style type=\'text/css\'> ::-webkit-scrollbar { display: none;} </style>').appendTo('head'),supportsTouch},isJsonString:function isJsonString(str){try{JSON.parse(str);}catch(e){return !1}return !0},setPageTitle:function setPageTitle(title){document.title=title;},getContentsContainer:function getContentsContainer(){return $('.bodyContents')},hidePopover:function hidePopover(element){'undefined'==typeof element&&(element=$('body .js-popover-tooltip')),element.popover('hide');},hidePopoversAfterClick:function hidePopoversAfterClick(popoverParent){popoverParent.on('click',function(){setTimeout(function(){popoverParent.popover('hide');},100);});},registerPopoverManualTrigger:function registerPopoverManualTrigger(element,manualTriggerDelay){var _this=this;element.on('mouseleave',function(){setTimeout(function(){var currentPopover=_this.getBindedPopover(element);$(':hover').filter(currentPopover).length||currentPopover.find('.js-popover-tooltip--record[aria-describedby]').length||currentPopover.popover('hide');},500);}),element.on('mouseenter',function(){setTimeout(function(){if(element.is(':hover')){element.popover('show');var currentPopover=_this.getBindedPopover(element);currentPopover.on('mouseleave',function(){setTimeout(function(){$(':hover').filter(currentPopover).length||currentPopover.find('.js-popover-tooltip--record[aria-describedby]').length||currentPopover.popover('hide'),$(':hover').filter($('.popover')).length||$('.popover').popover('hide');},500);});}},manualTriggerDelay);}),app.hidePopoversAfterClick(element);},isEllipsisActive:function isEllipsisActive(element){var clone=element.clone().addClass('u-text-ellipsis--not-active').css(element.css(['font-size','font-weight','font-family'])).appendTo('body');return (clone.find('.u-text-ellipsis').removeClass('u-text-ellipsis').addClass('u-text-ellipsis--not-active'),clone.width()-1>element.width())?(clone.remove(),!0):(clone.remove(),!1)},showPopoverElementView:function showPopoverElementView(){var selectElement=0<arguments.length&&void 0!==arguments[0]?arguments[0]:$('.js-popover-tooltip'),params=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},defaultParams={trigger:'manual',manualTriggerDelay:500,placement:'auto',html:!0,template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',container:'body',boundary:'viewport',delay:{show:300,hide:100}};return selectElement.each(function(index,domElement){var element=$(domElement),elementParams=$.extend(!0,defaultParams,params,element.data());element.data('class')&&(elementParams.template='<div class="popover '+element.data('class')+'" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'),element.hasClass('delay0')&&(elementParams.delay={show:0,hide:0}),element.popover(elementParams),('manual'===elementParams.trigger||'undefined'==typeof elementParams.trigger)&&app.registerPopoverManualTrigger(element,elementParams.manualTriggerDelay),elementParams.callbackShown&&element.on('shown.bs.popover',function(e){elementParams.callbackShown(e);}),element.addClass('popover-triggered');}),selectElement},registerPopoverEllipsis:function registerPopoverEllipsis(){var selectElement=0<arguments.length&&arguments[0]!==void 0?arguments[0]:$('.js-popover-tooltip--ellipsis'),params=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{trigger:'hover focus'},self=this;params={callbackShown:function callbackShown(){self.setPopoverPosition(selectElement);},trigger:'manual',placement:'right',template:'<div class="popover js-popover--before-positioned" role="tooltip"><div class="popover-body"></div></div>'};var popoverText=selectElement.find('.js-popover-text').length?selectElement.find('.js-popover-text'):selectElement;return app.isEllipsisActive(popoverText)?void app.showPopoverElementView(selectElement,params):void selectElement.addClass('popover-triggered')},registerPopoverEllipsisIcon:function registerPopoverEllipsisIcon(){var selectElement=0<arguments.length&&arguments[0]!==void 0?arguments[0]:$('.js-popover-tooltip--ellipsis-icon'),params=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{trigger:'hover focus'};selectElement.each(function(index,domElement){var element=$(domElement),popoverText=element.find('.js-popover-text').length?element.find('.js-popover-text'):element;if(app.isEllipsisActive(popoverText)){var iconElement=element.find('.js-popover-icon');iconElement.length&&(element.find('.js-popover-icon').removeClass('d-none'),params.selector='.js-popover-icon'),app.showPopoverElementView(element,params);}});},registerPopoverRecord:function registerPopoverRecord(){var selectElement=0<arguments.length&&arguments[0]!==void 0?arguments[0]:$('a.js-popover-tooltip--record'),customParams=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},self=this,params={template:'<div class="popover c-popover--link js-popover--before-positioned" role="tooltip"><div class="popover-body"></div></div>',content:'<div class="d-none"></div>',manualTriggerDelay:app.getMainParams('recordPopoverDelay'),placement:'right',callbackShown:function callbackShown(){if(!selectElement.attr('href'))return !1;var link=new URL(selectElement.get(0).href);if(!link.searchParams.get('record')||!link.searchParams.get('view'))return !1;var url=link.href;url=url.replace('view=','xview=')+'&view=RecordPopover';var currentPopover=self.getBindedPopover(selectElement),popoverBody=currentPopover.find('.popover-body');popoverBody.progressIndicator({});var appendPopoverData=function(data){popoverBody.progressIndicator({mode:'hide'}).html(data),'function'==typeof customParams.callback&&customParams.callback(popoverBody),self.setPopoverPosition(selectElement);},cacheData=window.popoverCache[url];'undefined'==typeof cacheData?AppConnector.request(url).done(function(data){window.popoverCache[url]=data,appendPopoverData(data);}):appendPopoverData(cacheData);}};app.showPopoverElementView(selectElement,params);},setPopoverPosition:function setPopoverPosition(popoverElement){var popover=this.getBindedPopover(popoverElement);if(popover.length){var windowHeight=$(window).height(),windowWidth=$(window).width(),popoverBody=popover.find('.popover-body'),popoverHeight=popoverBody.height(),popoverWidth=popoverBody.width(),offsetTop=app.mousePosition.y,offsetLeft=app.mousePosition.x;popoverHeight+offsetTop+10>windowHeight&&(offsetTop=offsetTop-popoverHeight-10),popoverWidth+offsetLeft+10>windowWidth&&(offsetLeft=offsetLeft-popoverWidth-10),popover.css({transform:'translate3d('+offsetLeft+'px, '+offsetTop+'px, 0)'}),popover.removeClass('js-popover--before-positioned'),popoverElement.one('hide.bs.popover',function(){popover.addClass('js-popover--before-positioned');});}},getBindedPopover:function getBindedPopover(element){return $('#'+element.attr('aria-describedby'))},registerChangeEventForMultiSelect:function registerChangeEventForMultiSelect(selectElement,params){if('undefined'!=typeof selectElement){var instance=selectElement.data('select2'),limit=params.maximumSelectionLength;selectElement.on('change',function(){var data=instance.data();$.isArray(data)&&data.length>=limit&&instance.updateResults();});}},getSerializedData:function getSerializedData(parentElement,returnFormat){'undefined'==typeof returnFormat&&(returnFormat='string'),parentElement=$(parentElement);var encodedString=parentElement.children().serialize();if('string'==returnFormat)return encodedString;var keyValueMap={},valueList=encodedString.split('&');for(var index in valueList){var keyValueString=valueList[index],keyValueArr=keyValueString.split('='),nameOfElement=keyValueArr[0],valueOfElement=keyValueArr[1];keyValueMap[nameOfElement]=decodeURIComponent(valueOfElement);}return keyValueMap},animateModal:function animateModal(modal,openAnimation,closeAnimation){modal.on('show.bs.modal',function(){modal.removeClass('animated '+closeAnimation),modal.addClass('animated '+openAnimation);}),modal.on('hide.bs.modal',function(){modal.removeClass('animated '+openAnimation),modal.addClass('animated '+closeAnimation);});},showModalData:function showModalData(data,container,paramsObject,cb,url,sendByAjaxCb){var thisInstance=this,params={show:!0};1!==$('#backgroundClosingModal').val()&&(params.backdrop=!0),'object'===('undefined'==typeof paramsObject?'undefined':_typeof(paramsObject))&&(container.css(paramsObject),params=$.extend(params,paramsObject)),container.html(data),container.find('.modal').hasClass('static')&&(params.backdrop='static'),$.fn.modal.Constructor.prototype.enforceFocus=function(){$(document).off('focusin.bs.modal').on('focusin.bs.modal',$.proxy(function(e){if($(e.target).hasClass('select2-search__field'))return !0},this));};var modalContainer=container.find('.modal:first');modalContainer.one('shown.bs.modal',function(){cb(modalContainer),App.Fields.Picklist.showSelect2ElementView(modalContainer.find('select.select2')),App.Fields.Date.register(modalContainer),new App.Fields.Text.Editor(modalContainer.find('.js-editor'),{height:'5em',toolbar:'Min'}),app.registesterScrollbar(modalContainer);}),$('body').append(container),modalContainer.modal(params),thisInstance.registerModalEvents(modalContainer,sendByAjaxCb),thisInstance.registerDataTables(modalContainer.find('.dataTable'));},showModalWindow:function showModalWindow(data,url,cb,paramsObject){if(window.parent!==window)return this.childFrame=!0,void window.parent.app.showModalWindow(data,url,cb,paramsObject);var thisInstance=this,sendByAjaxCb=void 0;Window.lastModalId='modal_'+Math.random().toString(36).substr(2,9),'object'!==('undefined'==typeof data?'undefined':_typeof(data))||null==data||data instanceof $||(null!=data.id&&(Window.lastModalId=data.id),paramsObject=data.css,cb=data.cb,url=data.url,'undefined'!==data.sendByAjaxCb&&(sendByAjaxCb=data.sendByAjaxCb),data=data.data),'function'==typeof url?('object'===('undefined'==typeof cb?'undefined':_typeof(cb))&&(paramsObject=cb),cb=url,url=!1):'object'===('undefined'==typeof url?'undefined':_typeof(url))&&(cb=function(){},paramsObject=url,url=!1),'function'!=typeof cb&&(cb=function(){}),'function'!=typeof sendByAjaxCb&&(sendByAjaxCb=function(){}),void 0!==paramsObject&&void 0!==paramsObject.modalId&&(Window.lastModalId=paramsObject.modalId);var container=$('#'+Window.lastModalId);return container.length&&container.remove(),container=$('<div></div>'),container.attr('id',Window.lastModalId).addClass('modalContainer js-modal-container'),container.one('hidden.bs.modal',function(){container.remove();var backdrop=$('.modal-backdrop');$('.modal.show').length||backdrop.remove(),0<backdrop.length&&$('body').addClass('modal-open');}),data?thisInstance.showModalData(data,container,paramsObject,cb,url,sendByAjaxCb):$.get(url).done(function(response){thisInstance.showModalData(response,container,paramsObject,cb,url,sendByAjaxCb);}),container},hideModalWindow:function hideModalWindow(callback,id){if(window.parent!==window)return this.childFrame=!0,void window.parent.app.hideModalWindow(callback,id);var container;if(container=callback&&'object'===('undefined'==typeof callback?'undefined':_typeof(callback))?callback:null==id?$('.modalContainer'):$('#'+id),!(0>=container.length)){'function'!=typeof callback&&(callback=function(){});var modalContainer=container.find('.modal');modalContainer.modal('hide');var backdrop=$('.modal-backdrop:last');0==$('.modalContainer').length&&backdrop.length&&backdrop.remove(),modalContainer.one('hidden.bs.modal',callback);}},registerModalController:function registerModalController(modalId,modalContainer,cb){var windowParent=this.childFrame?window.parent:window;void 0===modalId&&(modalId=Window.lastModalId),void 0===modalContainer&&(modalContainer=$('#'+modalId+' .js-modal-data'));var modalClass=modalContainer.data('module')+'_'+modalContainer.data('view')+'_JS';if('undefined'!=typeof windowParent[modalClass]){var instance=new windowParent[modalClass];'function'==typeof cb&&cb(modalContainer,instance),instance.registerEvents(modalContainer),modalId&&app.modalEvents[modalId]&&app.modalEvents[modalId](modalContainer,instance);}if(modalClass='Base_'+modalContainer.data('view')+'_JS','undefined'!=typeof windowParent[modalClass]){var _instance=new windowParent[modalClass];'function'==typeof cb&&cb(modalContainer,_instance),_instance.registerEvents(modalContainer),modalId&&app.modalEvents[modalId]&&app.modalEvents[modalId](modalContainer,_instance);}},registerModalEvents:function registerModalEvents(container,sendByAjaxCb){var form=container.find('form'),validationForm=!1;form.hasClass('validateForm')&&(form.validationEngine(app.validationEngineOptions),validationForm=!0),form.hasClass('sendByAjax')&&form.on('submit',function(e){var save=!0;if(e.preventDefault(),validationForm&&0<form.data('jqv').InvalidFields.length&&(app.formAlignmentAfterValidation(form),save=!1),save){var progressIndicatorElement=$.progressIndicator({blockInfo:{enabled:!0}}),formData=form.serializeFormData();AppConnector.request(formData).done(function(responseData){return sendByAjaxCb(formData,responseData),responseData.success&&responseData.result&&(responseData.result.notify&&Vtiger_Helper_Js.showMessage(responseData.result.notify),responseData.result.procesStop)?(progressIndicatorElement.progressIndicator({mode:'hide'}),!1):void(app.hideModalWindow(),progressIndicatorElement.progressIndicator({mode:'hide'}))}).fail(function(){progressIndicatorElement.progressIndicator({mode:'hide'});});}});},isHidden:function isHidden(element){return !('none'!=element.css('display'))},isInvisible:function isInvisible(element){return !('hidden'!=element.css('visibility'))},validationEngineOptions:{scroll:!1,promptPosition:'topLeft',prettySelect:!0,usePrefix:'s2id_'},validationEngineOptionsForRecord:{scroll:!1,promptPosition:'topLeft',prettySelect:!0,usePrefix:'s2id_',validateNonVisibleFields:!0,onBeforePromptType:function onBeforePromptType(field){var block=field.closest('.js-toggle-panel');block.find('.blockContent').is(':hidden')&&block.find('.blockHeader').click();}},scrollOptions:{wheelSpeed:.1},formAlignmentAfterValidation:function formAlignmentAfterValidation(form){var formError=form.find('.formError:not(\'.greenPopup\'):first');if(0<formError.length){var destination=formError.offset().top;$('html').animate({scrollTop:destination-105},'slow');}},convertToDatePickerFormat:function convertToDatePickerFormat(dateFormat){switch(dateFormat){case'yyyy-mm-dd':return 'Y-m-d';break;case'mm-dd-yyyy':return 'm-d-Y';break;case'dd-mm-yyyy':return 'd-m-Y';break;case'yyyy.mm.dd':return 'Y.m.d';break;case'mm.dd.yyyy':return 'm.d.Y';break;case'dd.mm.yyyy':return 'd.m.Y';break;case'yyyy/mm/dd':return 'Y/m/d';break;case'mm/dd/yyyy':return 'm/d/Y';break;case'dd/mm/yyyy':return 'd/m/Y';}},convertTojQueryDatePickerFormat:function convertTojQueryDatePickerFormat(dateFormat){var i,dotMode='-';-1!==dateFormat.indexOf('-')&&(dotMode='-'),-1!==dateFormat.indexOf('.')&&(dotMode='.'),-1!==dateFormat.indexOf('/')&&(dotMode='/');var splitDateFormat=dateFormat.split(dotMode);for(i in splitDateFormat){var sectionDate=splitDateFormat[i];4===sectionDate.length&&(splitDateFormat[i]=sectionDate.substring(0,2));}return splitDateFormat.join(dotMode)},getDateInDBInsertFormat:function getDateInDBInsertFormat(dateFormat,dateString){var i=0,dotMode='-';-1===dateFormat.indexOf('-')?-1===dateFormat.indexOf('.')?-1!==dateFormat.indexOf('/')&&(dotMode='/'):dotMode='.':dotMode='-';var dateFormatParts=dateFormat.split(dotMode),day='',month='',year='',dateParts=dateString.split(dotMode);for(i in dateFormatParts){var sectionDate=dateFormatParts[i];'dd'===sectionDate?day=dateParts[i]:'mm'===sectionDate?month=dateParts[i]:'yyyy'===sectionDate?year=dateParts[i]:void 0;}return year+'-'+month+'-'+day},registerEventForDateFields:function registerEventForDateFields(parentElement){'undefined'==typeof parentElement&&(parentElement=$('body')),parentElement=$(parentElement);var element;element=parentElement.hasClass('dateField')?parentElement:$('.dateField',parentElement),element.datepicker({autoclose:!0}).on('changeDate',function(ev){var currentElement=$(ev.currentTarget),dateFormat=currentElement.data('dateFormat').toUpperCase(),date=$.datepicker.formatDate(moment(ev.date).format(dateFormat),ev.date);currentElement.val(date);});},registerEventForClockPicker:function registerEventForClockPicker(){var timeInputs=0<arguments.length&&void 0!==arguments[0]?arguments[0]:$('.clockPicker');if(timeInputs.hasClass('clockPicker')||(timeInputs=timeInputs.find('.clockPicker')),!!timeInputs.length){var params={placement:'bottom',autoclose:!0,minutestep:5};$('.js-clock__btn').on('click',function(e){e.stopPropagation();var tempElement=$(e.currentTarget).closest('.time').find('input.clockPicker');'disabled'!==tempElement.attr('disabled')&&'readonly'!==tempElement.attr('readonly')&&tempElement.clockpicker('show');});var formatTimeString=function(timeInput){if(params.twelvehour){var meridiemTime='';params.afterDone=function(){var timeString=timeInput.val(),timeStringFormatted=timeString.slice(0,timeString.length-2)+' '+meridiemTime;timeInput.val(timeStringFormatted),app.event.trigger('Clockpicker.changed',timeInput);},params.beforeHide=function(){meridiemTime=$('.clockpicker-buttons-am-pm:visible').find('a:not(.text-white-50)').text();};}else params.afterDone=function(){app.event.trigger('Clockpicker.changed',timeInput);};};timeInputs.each(function(i,e){var timeInput=$(e),formatTime=timeInputs.data('format')||CONFIG.hourFormat;params.twelvehour=12===parseInt(formatTime),formatTimeString(timeInput),timeInput.clockpicker(params);});}},registerDataTables:function registerDataTables(table){var options=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return null!=$.fn.dataTable&&0!=table.length&&($.extend($.fn.dataTable.defaults,{language:{sLengthMenu:app.vtranslate('JS_S_LENGTH_MENU'),sZeroRecords:app.vtranslate('JS_NO_RESULTS_FOUND'),sInfo:app.vtranslate('JS_S_INFO'),sInfoEmpty:app.vtranslate('JS_S_INFO_EMPTY'),sSearch:app.vtranslate('JS_SEARCH'),sEmptyTable:app.vtranslate('JS_NO_RESULTS_FOUND'),sInfoFiltered:app.vtranslate('JS_S_INFO_FILTERED'),sLoadingRecords:app.vtranslate('JS_LOADING_OF_RECORDS'),sProcessing:app.vtranslate('JS_LOADING_OF_RECORDS'),oPaginate:{sFirst:app.vtranslate('JS_S_FIRST'),sPrevious:app.vtranslate('JS_S_PREVIOUS'),sNext:app.vtranslate('JS_S_NEXT'),sLast:app.vtranslate('JS_S_LAST')},oAria:{sSortAscending:app.vtranslate('JS_S_SORT_ASCENDING'),sSortDescending:app.vtranslate('JS_S_SORT_DESCENDING')}}}),table.DataTable(options))},getSelect2ElementFromSelect:function getSelect2ElementFromSelect(selectElement){var selectId=selectElement.attr('id');return $('#'+('select2-'+selectId+'-container')).closest('.select2-container')},setInheritWidth:function setInheritWidth(elements){$(elements).each(function(index,element){var parentWidth=$(element).parent().width();$(element).width(parentWidth);});},showNewScrollbar:function showNewScrollbar(element){var options=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{wheelPropagation:!0};return 'undefined'!=typeof element&&element.length?new PerfectScrollbar(element[0],Object.assign(this.scrollOptions,options)):void 0},showNewScrollbarTopBottomRight:function showNewScrollbarTopBottomRight(element){var options=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if('undefined'!=typeof element&&element.length){options=Object.assign(this.scrollOptions,options);var scrollbarTopLeftInit=new PerfectScrollbar(element[0],options),scrollbarTopElement=element.find('.ps__rail-x').first();scrollbarTopElement.css({top:0,bottom:'auto'}),scrollbarTopElement.find('.ps__thumb-x').css({top:2,bottom:'auto'});var scrollbarBottomRightInit=new PerfectScrollbar(element[0],options);return [scrollbarTopLeftInit,scrollbarBottomRightInit]}},showNewScrollbarTopBottom:function showNewScrollbarTopBottom(element){var options=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{wheelPropagation:!0,suppressScrollY:!0};if('undefined'!=typeof element&&element.length){options=Object.assign(this.scrollOptions,options),new PerfectScrollbar(element[0],options),new PerfectScrollbar(element[0],options);var scrollbarTopElement=element.find('.ps__rail-x').first();scrollbarTopElement.css({top:0,bottom:'auto'}),scrollbarTopElement.find('.ps__thumb-x').css({top:2,bottom:'auto'});}},showNewScrollbarTop:function showNewScrollbarTop(element){var options=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{wheelPropagation:!0,suppressScrollY:!0};if('undefined'!=typeof element&&element.length){options=Object.assign(this.scrollOptions,options),new PerfectScrollbar(element[0],options);var scrollbarTopElement=element.find('.ps__rail-x').first();scrollbarTopElement.css({top:0,bottom:'auto'}),scrollbarTopElement.find('.ps__thumb-x').css({top:2,bottom:'auto'});}},showNewScrollbarLeft:function showNewScrollbarLeft(element){var options=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{wheelPropagation:!0};if('undefined'!=typeof element&&element.length){options=Object.assign(this.scrollOptions,options),new PerfectScrollbar(element[0],options);var scrollbarLeftElement=element.children('.ps__rail-y').first();scrollbarLeftElement.css({left:0,right:'auto'}),scrollbarLeftElement.find('.ps__thumb-y').css({left:2,right:'auto'});}},showScrollBar:function showScrollBar(element){var options=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return 'undefined'==typeof options.height&&(options.height=element.css('height')),element.slimScroll(options)},registerMiddleClickScroll:function registerMiddleClickScroll(container){var middleScroll=!1;container.on('mousedown',function(e){var clickedMouseButton=e.which;if(2==clickedMouseButton&&!1==middleScroll){middleScroll=!0;var mouseY=e.pageY,mouseX=e.pageX;$(document).on('mousemove',function(e){if(!0==middleScroll){$('body').addClass('u-cursor-scroll-all');var mouseMoveY=mouseY-e.pageY,contentScrollY=container.scrollTop(),mouseMoveX=mouseX-e.pageX,contentScrollX=container.scrollLeft();container.scrollTop(contentScrollY-mouseMoveY-100),container.scrollLeft(contentScrollX-mouseMoveX-100);}});}}),container.on('mouseup',function(){$('body').removeClass('u-cursor-scroll-all'),middleScroll=!1;});},vtranslate:function vtranslate(key){return key in LANG?LANG[key]:key},cacheNSKey:function cacheNSKey(key){return 'yf.'+key},cacheGet:function cacheGet(key){return key=this.cacheNSKey(key),store.get(key)},cacheSet:function cacheSet(key,value){key=this.cacheNSKey(key),store.set(key,value);},cacheClear:function cacheClear(key){return key=this.cacheNSKey(key),store.remove(key)},moduleCacheSet:function moduleCacheSet(key,value){var orgKey=key;key=this.getModuleName()+'_'+key,this.cacheSet(key,value);var cacheKey='mCache'+this.getModuleName(),moduleCache=this.cacheGet(cacheKey);moduleCache=null==moduleCache?[]:moduleCache.split(','),moduleCache.push(orgKey),this.cacheSet(cacheKey,Vtiger_Helper_Js.unique(moduleCache).join(','));},moduleCacheGet:function moduleCacheGet(key){return this.cacheGet(this.getModuleName()+'_'+key)},moduleCacheKeys:function moduleCacheKeys(){var cacheKey='mCache'+this.getModuleName(),modules=this.cacheGet(cacheKey);return modules?modules.split(','):[]},moduleCacheClear:function moduleCacheClear(){var thisInstance=this,moduleName=this.getModuleName(),cacheKey='mCache'+moduleName,moduleCache=this.cacheGet(cacheKey);moduleCache=null==moduleCache?[]:moduleCache.split(','),$.each(moduleCache,function(index,value){thisInstance.cacheClear(moduleName+'_'+value);}),thisInstance.cacheClear(cacheKey);},htmlEncode:function htmlEncode(value){return value?$('<div />').text(value).html():''},htmlDecode:function htmlDecode(value){return value?$('<div />').html(value).text():''},placeAtCenter:function placeAtCenter(element){element.css('position','absolute'),element.css('top',($(window).height()-element.outerHeight())/2+$(window).scrollTop()+'px'),element.css('left',($(window).width()-element.outerWidth())/2+$(window).scrollLeft()+'px');},getvalidationEngineOptions:function getvalidationEngineOptions(){return Object.assign({},app.validationEngineOptions)},notifyPostAjaxReady:function notifyPostAjaxReady(){$(document).trigger('postajaxready');},listenPostAjaxReady:function listenPostAjaxReady(callback){$(document).on('postajaxready',callback);},setFormValues:function setFormValues(kv){for(var k in kv)$(k).val(kv[k]);},setRTEValues:function setRTEValues(kv){for(var k in kv){var rte=CKEDITOR.instances[k];rte&&rte.setData(kv[k]);}},getPageController:function getPageController(){if(window.pageController)return window.pageController;var moduleName=app.getModuleName(),view=app.getViewName(),parentModule=app.getParentModuleName(),moduleClassName=parentModule+'_'+moduleName+'_'+view+'_Js';'undefined'==typeof window[moduleClassName]&&(moduleClassName=parentModule+'_Vtiger_'+view+'_Js'),'undefined'==typeof window[moduleClassName]&&(moduleClassName=moduleName+'_'+view+'_Js');var extendModules=$('#extendModules').val();if('undefined'==typeof window[moduleClassName]&&null!=extendModules&&(moduleClassName=extendModules+'_'+view+'_Js'),'undefined'==typeof window[moduleClassName]&&(moduleClassName='Vtiger_'+view+'_Js'),'undefined'!=typeof window[moduleClassName]){if('function'==typeof window[moduleClassName])return window.pageController=new window[moduleClassName];if('object'===_typeof(window[moduleClassName]))return window.pageController=window[moduleClassName]}var moduleBaseClassName=parentModule+'_'+moduleName+'_Index_Js';if('undefined'!=typeof window[moduleBaseClassName]){if('function'==typeof window[moduleBaseClassName])return window.pageController=new window[moduleBaseClassName];if('object'===_typeof(window[moduleBaseClassName]))return window.pageController=window[moduleBaseClassName]}},getDecodedValue:function getDecodedValue(value){return $('<div></div>').html(value).text()},getCookie:function getCookie(c_name){var c_value=document.cookie,c_start=c_value.indexOf(' '+c_name+'=');if(-1===c_start&&(c_start=c_value.indexOf(c_name+'=')),-1===c_start)c_value=null;else{c_start=c_value.indexOf('=',c_start)+1;var c_end=c_value.indexOf(';',c_start);-1===c_end&&(c_end=c_value.length),c_value=unescape(c_value.substring(c_start,c_end));}return c_value},setCookie:function setCookie(c_name,value,exdays){var exdate=new Date;exdate.setDate(exdate.getDate()+exdays);var c_value=escape(value)+(null==exdays?'':'; expires='+exdate.toUTCString());document.cookie=c_name+'='+c_value;},getUrlVar:function getUrlVar(varName){return function getVar(){var vars={};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(m,key,value){vars[key]=value;}),vars}()[varName]},getStringDate:function getStringDate(date){var d=date.getDate(),m=date.getMonth()+1,y=date.getFullYear();return d=9>=d?'0'+d:d,m=9>=m?'0'+m:m,y+'-'+m+'-'+d},formatDate:function formatDate(date){var y=date.getFullYear(),m=date.getMonth()+1,d=date.getDate(),h=date.getHours(),i=date.getMinutes(),s=date.getSeconds();return y+'-'+this.formatDateZ(m)+'-'+this.formatDateZ(d)+' '+this.formatDateZ(h)+':'+this.formatDateZ(i)+':'+this.formatDateZ(s)},formatDateZ:function formatDateZ(i){return 9>=i?'0'+i:i},howManyDaysFromDate:function howManyDaysFromDate(time){var fromTime=time.getTime(),today=new Date,toTime=new Date(today.getFullYear(),today.getMonth(),today.getDate()).getTime();return Math.floor((toTime-fromTime)/86400000)+1},saveAjax:function saveAjax(mode,param,addToParams){var aDeferred=$.Deferred(),params={};if(params.module=app.getModuleName(),params.parent=app.getParentModuleName(),params.action='SaveAjax',mode&&(params.mode=mode),params.param=param,null!=addToParams)for(var i in addToParams)params[i]=addToParams[i];return AppConnector.request(params).done(function(data){aDeferred.resolve(data);}).fail(function(textStatus,errorThrown){aDeferred.reject(textStatus,errorThrown);}),aDeferred.promise()},removeEmptyFilesInput:function removeEmptyFilesInput(form){for(var i=0;i<form.elements.length;i++)'file'===form.elements[i].type&&''===form.elements[i].value&&form.elements[i].parentNode.removeChild(form.elements[i]);},getMainParams:function getMainParams(param,json){if(param in CONFIG)return CONFIG[param];void 0===app.cacheParams[param]&&(app.cacheParams[param]=$('#'+param).val());var value=app.cacheParams[param];return json&&(value?value=JSON.parse(value):value=[]),value},setMainParams:function setMainParams(param,value){app.cacheParams[param]=value,$('#'+param).val(value);},errorLog:function errorLog(error,err,errorThrown){CONFIG.debug&&(console.warn('%cYetiForce debug mode!!!','color: red; font-family: sans-serif; font-size: 1.5em; font-weight: bolder; text-shadow: #000 1px 1px;'),'object'===('undefined'==typeof error?'undefined':_typeof(error))&&error.responseText&&(error=error.responseText),'object'===('undefined'==typeof error?'undefined':_typeof(error))&&error.statusText&&(error=error.statusText),error&&console.error(error),err&&'error'!==err&&console.error(err),errorThrown&&console.error(errorThrown));},registerModal:function registerModal(container){'undefined'==typeof container&&(container=$('body')),container.off('click','button.showModal, a.showModal, .js-show-modal').on('click','button.showModal, a.showModal, .js-show-modal',function(e){e.preventDefault();var currentElement=$(e.currentTarget),url=currentElement.data('url');if('undefined'!=typeof url){currentElement.hasClass('js-popover-tooltip')&&currentElement.popover('hide'),currentElement.hasClass('disabledOnClick')&&currentElement.attr('disabled',!0);var modalWindowParams={url:url,cb:function cb(container){var call=currentElement.data('cb');if('undefined'!=typeof call)if(-1!==call.indexOf('.')){var callerArray=call.split('.');'object'===_typeof(window[callerArray[0]])&&window[callerArray[0]][callerArray[1]](container);}else'function'==typeof window[call]&&window[call](container);currentElement.removeAttr('disabled');}};currentElement.data('modalid')&&(modalWindowParams.id=currentElement.data('modalid')),app.showModalWindow(modalWindowParams);}e.stopPropagation();});},playSound:function playSound(action){var soundsConfig=app.getMainParams('sounds');if(soundsConfig.IS_ENABLED){var audio=new Audio(app.getMainParams('soundFilesPath')+soundsConfig[action]);audio.play();}},registerSticky:function registerSticky(){var elements=$('.stick');elements.each(function(){var offsetTop,currentElement=$(this),position=currentElement.data('position');'top'===position&&(offsetTop=currentElement.offset().top-50,$('.mainBody').on('scroll',function(){$(this).scrollTop()>offsetTop?currentElement.css({position:'fixed',top:'50px',width:currentElement.width()}):$(this).scrollTop()<=offsetTop&&currentElement.css({position:'',top:'',width:''});})),'bottom'===position&&(offsetTop=currentElement.offset().top-$(window).height(),$('.mainBody').on('scroll',function(){$(this).scrollTop()<offsetTop?currentElement.css({position:'fixed',bottom:'33px',width:currentElement.width()}):$(this).scrollTop()>=offsetTop&&currentElement.css({position:'',bottom:'',width:''});}));});},registerMoreContent:function registerMoreContent(container){container.on('click',function(e){var btn=$(e.currentTarget),content=btn.closest('.moreContent');content.find('.teaserContent').toggleClass('d-none'),content.find('.fullContent').toggleClass('d-none'),btn.text()==btn.data('on')?btn.text(btn.data('off')):btn.text(btn.data('on'));});},registerMenu:function registerMenu(){var self=this;self.keyboard={DOWN:40,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,UP:38},self.sidebarBtn=$('.js-sidebar-btn').first(),self.sidebar=$('.js-sidebar').first(),self.sidebarBtn.on('click',self.toggleSidebar.bind(self)),$('a.nav-link,[tabindex],input,select,textarea,button').on('focus',function(e){self.sidebarBtn[0]==e.target||self.sidebar.find(e.target).length||(self.sidebar.find(':focus').length?self.openSidebar():self.sidebar.hasClass('js-expand')&&self.closeSidebar());}),self.sidebar.on('mouseenter',self.openSidebar.bind(self)).on('mouseleave',self.closeSidebar.bind(self)),self.sidebar.find('.js-menu__content').on('keydown',self.sidebarKeyboard.bind(self)),self.sidebar.on('keydown',function(e){e.which==self.keyboard.ESCAPE&&(self.closeSidebar(),self.sidebarBtn.is(':tabbable')?self.sidebarBtn.focus():$(':tabbable').eq(parseInt($(':tabbable').index(self.sidebar.find(':tabbable').last()))+1).focus());}),self.sidebar.find('.js-submenu').on('shown.bs.collapse',function(e){$(e.target).find(':tabbable').first().focus();}),$('.js-submenu-toggler').on('click',function(e){$(e.currentTarget).hasClass('collapsed')||$(e.target).closest('.toggler').length||(window.location=$(e.currentTarget).attr('href'));}),self.registerPinEvent();},openSidebar:function openSidebar(){this.sidebar.addClass('js-expand'),this.sidebarBtn.attr('aria-expanded',!0);},closeSidebar:function closeSidebar(){this.sidebar.removeClass('js-expand'),this.sidebarBtn.attr('aria-expanded',!1);},toggleSidebar:function toggleSidebar(){this.sidebar.hasClass('js-expand')?this.closeSidebar():(this.openSidebar(),this.sidebar.find('.js-menu__content :tabbable').first().focus());},registerPinEvent:function registerPinEvent(){var self=this,pinButton=self.sidebar.find('.js-menu--pin'),baseContainer=self.sidebar.closest('.js-base-container');pinButton.on('click',function(){var hideMenu=0;baseContainer.removeClass('c-menu--animation'),'0'===pinButton.attr('data-show')?(hideMenu='on',pinButton.removeClass('u-opacity-muted'),baseContainer.addClass('c-menu--open'),self.sidebar.off('mouseleave mouseenter')):(pinButton.addClass('u-opacity-muted'),baseContainer.removeClass('c-menu--open'),self.sidebar.on('mouseenter',self.openSidebar.bind(self)).on('mouseleave',self.closeSidebar.bind(self)),self.closeSidebar.bind(self)),AppConnector.request({module:'Users',action:'SaveAjax',field:'leftpanelhide',record:CONFIG.userId,value:hideMenu}).done(function(responseData){responseData.success&&responseData.result&&pinButton.attr('data-show',hideMenu);}),setTimeout(function(){baseContainer.addClass('c-menu--animation');},300);});},sidebarKeyboard:function sidebarKeyboard(e){var target=$(e.target);if(e.which==this.keyboard.LEFT){if(target.hasClass('js-submenu-toggler')&&!target.hasClass('collapsed'))return target.click(),!1;var toggler=$(e.target).closest('.js-submenu').prev('.js-submenu-toggler');if(toggler.length&&!toggler.hasClass('collapsed'))return toggler.click().focus(),!1}else{if(target.hasClass('js-submenu-toggler')&&e.which==this.keyboard.RIGHT&&target.hasClass('collapsed')||target.hasClass('js-submenu-toggler')&&e.which==this.keyboard.SPACE)return target.click(),!1;if(e.which==this.keyboard.UP)return this.sidebar.find('.js-menu__content :tabbable').eq(parseInt(this.sidebar.find('.js-menu__content :tabbable').index(target))-1).focus(),!1;if(e.which==this.keyboard.DOWN)return this.sidebar.find('.js-menu__content :tabbable').eq(parseInt(this.sidebar.find('.js-menu__content :tabbable').index(target))+1).focus(),!1}},registerTabdrop:function registerTabdrop(){var tabs=$('.js-tabdrop');if(tabs.length){var tab=tabs.find('> li');tab.each(function(){$(this).removeClass('d-none');}),tabs.tabdrop({text:app.vtranslate('JS_MORE')});var dropdown=tabs.find('> li.dropdown');dropdown.appendTo(tabs),tab.on('click',function(){setTimeout(function(){$(window).trigger('resize');},500);});}},getScreenHeight:function getScreenHeight(percantage){return 'undefined'==typeof percantage&&(percantage=100),$(window).height()*percantage/100},clearBrowsingHistory:function clearBrowsingHistory(){AppConnector.request({module:'Home',action:'BrowsingHistory'}).done(function(){$('.historyList').html('<a class="item dropdown-item" href="#" role="listitem">'+app.vtranslate('JS_NO_RECORDS')+'</a>');});},openUrl:function openUrl(url){window.location===window.top.location?window.location.href=url:window.top.location.href=url;},showConfirmation:function showConfirmation(data,element){var params={};data&&(params=$.extend(params,data)),element&&(element=$(element),!params.title&&(params.title=element.html()+' '+(element.data('content')?element.data('content'):'')),!params.message&&(params.message=element.data('confirm')),!params.url&&(params.url=element.data('url'))),Vtiger_Helper_Js.showConfirmationBox(params).done(function(){'href'==params.type?AppConnector.request(params.url).done(function(data){app.openUrl(data.result);}):'reloadTab'==params.type&&AppConnector.request(params.url).done(function(){Vtiger_Detail_Js.getInstance().reloadTabContent();});});},formatToHourText:function formatToHourText(decTime){var _Mathfloor=Math.floor,type=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'short',withSeconds=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2],withMinutes=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],short='short'===type,hour=_Mathfloor(decTime),min=_Mathfloor(60*(decTime-hour)),sec=Math.round(60*(60*(decTime-hour)-min)),result='';return hour&&(result+=short?hour+app.vtranslate('JS_H'):hour+' '+app.vtranslate('JS_H_LONG')),(hour||min)&&withMinutes&&(result+=short?' '+min+app.vtranslate('JS_M'):' '+min+' '+app.vtranslate('JS_M_LONG')),!1!==withSeconds&&(result+=short?' '+sec+app.vtranslate('JS_S'):' '+sec+' '+app.vtranslate('JS_S_LONG')),hour||min||!1!==withSeconds||!withMinutes||(result+=short?'0'+app.vtranslate('JS_M'):'0 '+app.vtranslate('JS_M_LONG')),hour||min||!1!==withSeconds||withMinutes||(result+=short?'0'+app.vtranslate('JS_H'):'0 '+app.vtranslate('JS_H_LONG')),result.trim()},showRecordsList:function showRecordsList(params,cb,afterShowModal){params.view||(params.view='RecordsList'),this.showRecordsListModal(params).done(function(modal){'function'==typeof afterShowModal&&afterShowModal(modal),app.registerModalController(!1,modal,cb);});},showRecordsListModal:function showRecordsListModal(params){var aDeferred=$.Deferred();return AppConnector.request(params).done(function(requestData){app.showModalWindow(requestData,function(modal){aDeferred.resolve(modal);});}).fail(function(textStatus,errorThrown){aDeferred.reject(textStatus,errorThrown);}),aDeferred.promise()},htmlToImage:function htmlToImage(element,callback){var options=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{imageType:'image/png',logging:!1};element=$(element).get(0);var imageType=options.imageType;return delete options.imageType,html2canvas(element,options).then(function(canvas){var base64Image=canvas.toDataURL(imageType);return 'function'==typeof callback&&callback(base64Image),base64Image})},decodeHTML:function decodeHTML(html){var txt=document.createElement('textarea');return txt.innerHTML=html,txt.value},showAlert:function showAlert(customParams){var userParams=customParams;'string'==typeof customParams&&(userParams={},userParams.text=customParams);var params={target:document.body,data:{type:'error',hide:!1,stack:{dir1:'down',modal:!0,firstpos1:25},modules:{Confirm:{confirm:!0,buttons:[{text:'Ok',primary:!0,click:function click(notice){notice.close();}}]},Buttons:{closer:!1,sticker:!1},History:{history:!1}}}};return 'undefined'!=typeof userParams&&(params.data=$.extend(params.data,userParams)),new PNotify(params)},showConfirmModal:function showConfirmModal(customParams){var confirmCallback=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},cancelCallback=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},aDeferred=$.Deferred(),userParams=customParams;'string'==typeof customParams&&(userParams={},userParams.text=customParams);var params={target:document.body,data:{hide:!1,icon:'fas fa-question-circle',stack:{dir1:'down',modal:!0,firstpos1:25},modules:{Confirm:{confirm:!0,buttons:[{text:app.vtranslate('JS_OK'),primary:!0,promptTrigger:!0,click:function click(notice){notice.close(),confirmCallback(),aDeferred.resolve(!0);}},{text:app.vtranslate('JS_CANCEL'),click:function click(notice){notice.close(),cancelCallback(),aDeferred.resolve(!1);}}]},Buttons:{closer:!1,sticker:!1},History:{history:!1}}}};return 'undefined'!=typeof userParams&&(params.data=$.extend(params.data,userParams)),new PNotify(params),aDeferred.promise()},registesterScrollbar:function registesterScrollbar(container){container.find('.js-scrollbar').each(function(){var element=$(this),scrollbarFnName=element.data('scrollbarFnName');'function'==typeof app[scrollbarFnName]?app[scrollbarFnName](element):app.showNewScrollbar(element);});},registerPopover:function registerPopover(){window.popoverCache={},$(document).on('mouseenter','.js-popover-tooltip, .js-popover-tooltip--record, .js-popover-tooltip--ellipsis, [data-field-type="reference"], [data-field-type="multireference"]',function(e){var currentTarget=$(e.currentTarget);currentTarget.find('.js-popover-tooltip--record').length||!currentTarget.hasClass('popover-triggered')&&(currentTarget.hasClass('js-popover-tooltip--record')?(app.registerPopoverRecord(currentTarget),currentTarget.trigger('mouseenter')):!currentTarget.hasClass('js-popover-tooltip--record')&&currentTarget.data('field-type')?app.registerPopoverRecord(currentTarget.children('a')):!currentTarget.hasClass('js-popover-tooltip--record')&&!currentTarget.find('.js-popover-tooltip--record').length&&!currentTarget.data('field-type')&&(currentTarget.hasClass('js-popover-tooltip--ellipsis')?app.registerPopoverEllipsis(currentTarget):app.showPopoverElementView(currentTarget),currentTarget.trigger('mouseenter')));});},showNotify:function showNotify(params){var desktop=!!(1<arguments.length&&arguments[1]!==void 0)&&arguments[1];'undefined'==typeof params.type&&(params.type='info'),'undefined'==typeof params.title&&(params.title=app.vtranslate('JS_MESSAGE')),desktop&&(params=$.extend(params,{modules:{Desktop:{desktop:!0}}})),Vtiger_Helper_Js.showPnotify(params);},setPnotifyDefaultOptions:function setPnotifyDefaultOptions(){PNotify.defaults.textTrusted=!0,PNotify.defaults.titleTrusted=!0,PNotify.defaults.styling='bootstrap4',PNotify.defaults.icons='fontawesome5';},registerFormatNumber:function registerFormatNumber(){$(document).on('focusout','.js-format-numer',function(e){$(e.currentTarget).formatNumber();});},registerToggleIconClick:function registerToggleIconClick(container){container.on('click','.js-toggle-icon, .js-toggle-icon__container',function(e){var icon=$(e.target);icon.hasClass('js-toggle-icon__container')&&(icon=icon.find('.js-toggle-icon'));var iconData=icon.data();icon.toggleClass(iconData.active+' '+iconData.inactive),e.stopPropagation();});}},CKEDITOR.disableAutoInline=!0,$(document).ready(function(){var document=$(this);app.registerToggleIconClick(document),app.touchDevice=app.isTouchDevice(),app.setPnotifyDefaultOptions(),App.Fields.Picklist.changeSelectElementView(),app.registerPopoverEllipsisIcon(),app.registerPopover(),app.registerFormatNumber(),app.registerSticky(),app.registerMoreContent($('body').find('button.moreBtn')),app.registerModal(),app.registerMenu(),app.registerTabdrop(),app.registesterScrollbar(document),String.prototype.toCamelCase=function(){var value=this.valueOf();return value.charAt(0).toUpperCase()+value.slice(1).toLowerCase()},(/MSIE/.test(navigator.userAgent)||/Trident/.test(navigator.userAgent))&&$('textarea').resizable();var pageController=app.getPageController();pageController&&pageController.registerEvents(),document.on('mousemove',function(e){app.mousePosition={x:e.pageX,y:e.pageY};});}),function($){$.fn.getNumberFromValue=function(){return App.Fields.Double.formatToDb($(this).val())},$.fn.getNumberFromText=function(){return App.Fields.Double.formatToDb($(this).text())},$.fn.formatNumber=function(){var element=$(this);element.val(App.Fields.Double.formatToDisplay(App.Fields.Double.formatToDb(element.val()),!1));},$.fn.disable=function(){this.attr('disabled','disabled');},$.fn.enable=function(){this.removeAttr('disabled');},$.fn.serializeFormData=function(){var form=$(this);for(var instance in CKEDITOR.instances)CKEDITOR.instances[instance].updateElement();var values=form.serializeArray(),data={};values&&$(values).each(function(k,v){if(v.name in data&&'object'!==_typeof(data[v.name])){var element=form.find('[name="'+v.name+'"]');if(element.is('select')&&null!=element.attr('multiple')){var prevValue=data[v.name];data[v.name]=[],data[v.name].push(prevValue);}}'object'===_typeof(data[v.name])?data[v.name].push(v.value):data[v.name]=v.value;});var autocompletes=$('[data-type="autocomplete"]',$(this));return $(autocompletes).each(function(i){var ac=$(autocompletes[i]);data[ac.attr('name')]=ac.data('value');}),data},$.expr[':'].icontains=function(obj,index,meta){return -1!==(obj.textContent||obj.innerText||$(obj).text()||'').toLowerCase().indexOf(meta[3].toLowerCase())},$.fn.removeTextNode=function(){$(this).contents().filter(function(){return 3==this.nodeType}).remove();},bootbox.setLocale(CONFIG.langKey);}($);
//# sourceMappingURL=app.min.js.map
