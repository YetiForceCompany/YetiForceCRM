{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nVtiger_Detail_Js(\"Project_Detail_Js\", {}, {\n\t/**\n\t * Function to register event for create related record\n\t * in summary view widgets\n\t */\n\tregisterSummaryViewContainerEvents: function (summaryViewContainer) {\n\t\tthis._super(summaryViewContainer);\n\t},\n\t/**\n\t * Function to load module summary of Projects\n\t */\n\tloadModuleSummary: function () {\n\t\tvar summaryParams = {};\n\t\tsummaryParams['module'] = app.getModuleName();\n\t\tsummaryParams['view'] = \"Detail\";\n\t\tsummaryParams['mode'] = \"showModuleSummaryView\";\n\t\tsummaryParams['record'] = jQuery('#recordId').val();\n\t\tAppConnector.request(summaryParams).done(function (data) {\n\t\t\tjQuery('.js-widget-general-info').html(data);\n\t\t});\n\t},\n\t/**\n\t * Load gantt component\n\t */\n\tloadGantt() {\n\t\tlet ganttContainer = $('.c-gantt', this.detailViewContentHolder);\n\t\tif (ganttContainer.length) {\n\t\t\tlet gantt = new Project_Gantt_Js(this.detailViewContentHolder);\n\t\t\tgantt.registerEvents();\n\t\t}\n\t},\n\t/**\n\t * Load gantt component when needed\n\t */\n\tregisterGantt() {\n\t\tthis.loadGantt();\n\t\tapp.event.on('DetailView.Tab.AfterLoad', (e, data, instance) => {\n\t\t\tinstance.detailViewContentHolder.ready(() => {\n\t\t\t\tthis.loadGantt();\n\t\t\t})\n\t\t});\n\t},\n\t/**\n\t * Function to get response from hierarchy\n\t * @param {array} params\n\t * @returns {jQuery}\n\t */\n\tgetHierarchyResponseData: function (params) {\n\t\tlet thisInstance = this,\n\t\t\taDeferred = $.Deferred();\n\t\tif (!($.isEmptyObject(thisInstance.hierarchyResponseCache))) {\n\t\t\taDeferred.resolve(thisInstance.hierarchyResponseCache);\n\t\t} else {\n\t\t\tAppConnector.request(params).then(\n\t\t\t\tfunction (data) {\n\t\t\t\t\tthisInstance.hierarchyResponseCache = data;\n\t\t\t\t\taDeferred.resolve(thisInstance.hierarchyResponseCache);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\treturn aDeferred.promise();\n\t},\n\t/**\n\t * Function to display the hierarchy response data\n\t * @param {array} data\n\t */\n\tdisplayHierarchyResponseData: function (data) {\n\t\tlet callbackFunction = function () {\n\t\t\tapp.showScrollBar($('#hierarchyScroll'), {\n\t\t\t\theight: '300px',\n\t\t\t\trailVisible: true,\n\t\t\t\tsize: '6px'\n\t\t\t});\n\t\t};\n\t\tapp.showModalWindow(data, function () {\n\t\t\tif (typeof callbackFunction == 'function' && $(\"#hierarchyScroll\").height() > 300) {\n\t\t\t\tcallbackFunction();\n\t\t\t}\n\t\t});\n\t},\n\t/**\n\t * Registers read count of hierarchy if it is possible\n\t */\n\tregisterHierarchyRecordCount: function () {\n\t\tlet hierarchyButton = $('.js-detail-hierarchy'),\n\t\t\tparams = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'RelationAjax',\n\t\t\t\trecord: app.getRecordId(),\n\t\t\t\tmode: 'getHierarchyCount'\n\t\t\t};\n\t\tif (hierarchyButton.length) {\n\t\t\tAppConnector.request(params).then(function (response) {\n\t\t\t\tif (response.success) {\n\t\t\t\t\t$('.hierarchy .badge').html(response.result);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t/**\n\t * Shows hierarchy\n\t */\n\tregisterShowHierarchy: function () {\n\t\tlet thisInstance = this,\n\t\t\thierarchyButton = $('.detailViewTitle'),\n\t\t\tparams = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tview: 'Hierarchy',\n\t\t\t\trecord: app.getRecordId()\n\t\t\t};\n\t\thierarchyButton.on('click', '.js-detail-hierarchy', function () {\n\t\t\tlet progressIndicatorElement = $.progressIndicator({\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tthisInstance.getHierarchyResponseData(params).then(function (data) {\n\t\t\t\tthisInstance.displayHierarchyResponseData(data);\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Register events\n\t */\n\tregisterEvents: function () {\n\t\tvar detailContentsHolder = this.getContentHolder();\n\t\tvar thisInstance = this;\n\t\tthis._super();\n\t\tdetailContentsHolder.on('click', '.moreRecentTickets', function () {\n\t\t\tvar recentTicketsTab = thisInstance.getTabByLabel(thisInstance.detailViewRecentTicketsTabLabel);\n\t\t\trecentTicketsTab.trigger('click');\n\t\t});\n\t\tthis.registerGantt();\n\t\tthis.registerHierarchyRecordCount();\n\t\tthis.registerShowHierarchy();\n\t}\n});\n"],"names":["Vtiger_Detail_Js","registerSummaryViewContainerEvents","summaryViewContainer","_super","loadModuleSummary","summaryParams","app","getModuleName","jQuery","val","AppConnector","request","done","data","html","loadGantt","$","detailViewContentHolder","ganttContainer","length","gantt","registerEvents","registerGantt","event","on","e","instance","ready","getHierarchyResponseData","params","aDeferred","Deferred","isEmptyObject","thisInstance","hierarchyResponseCache","then","resolve","promise","displayHierarchyResponseData","showScrollBar","height","railVisible","size","showModalWindow","callbackFunction","registerHierarchyRecordCount","module","action","record","getRecordId","mode","hierarchyButton","response","success","result","registerShowHierarchy","view","progressIndicator","progressIndicatorElement","getContentHolder","detailContentsHolder","getTabByLabel","detailViewRecentTicketsTabLabel","recentTicketsTab","trigger"],"mappings":"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"}