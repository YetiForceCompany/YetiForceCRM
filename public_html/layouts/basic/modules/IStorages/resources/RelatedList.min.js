'use strict';

/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */

Vtiger_RelatedList_Js('IStorages_RelatedList_Js', {
	registerEditQty: function registerEditQty() {
		var thisInstance = this;
		var element = this.content.find('.js-edit-qtyproductinstock');
		element.validationEngine(app.validationEngineOptions);
		element.on('change', function (e) {
			e.stopPropagation();
			var element = $(e.currentTarget);
			element.formatNumber();
			if (!element.validationEngine('validate')) {
				AppConnector.request({
					module: thisInstance.parentModuleName,
					record: element.closest('.js-list__row').data('id'),
					action: 'RelationAjax',
					mode: 'setQtyProducts',
					src_record: thisInstance.parentRecordId,
					related_module: thisInstance.moduleName,
					qty: element.val()
				}).done(function (responseData) {
					if (responseData.result) {
						Vtiger_Helper_Js.showPnotify({ text: app.vtranslate('JS_SAVE_NOTIFY_OK'), type: 'success' });
					}
				});
			}
		});
	},
	registerPostLoadEvents: function registerPostLoadEvents() {
		this._super();
		this.registerEditQty();
	}
});
//# sourceMappingURL=RelatedList.min.js.map
