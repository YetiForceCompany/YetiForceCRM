{"version":3,"file":"Iframe.min.js","sources":["Iframe.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nwindow.MailIntegration_Iframe = {\n\tmailId: 0,\n\tcontainer: {},\n\tiframe: {},\n\tiframeWindow: {},\n\tmoduleSelect: {},\n\taddRecordBtn: {},\n\tloaderParams: {\n\t\tblockInfo: { enabled: true },\n\t\tmessage: false\n\t},\n\t/**\n\t * AppConnector wrapper\n\t *\n\t * @param   {object}  request\n\t *\n\t * @return  {object}           AppConnector object with done method\n\t */\n\tconnector(request) {\n\t\treturn AppConnector.request(request).fail((error) => {\n\t\t\tthis.hideIframeLoader();\n\t\t\tthis.showResponseMessage(false);\n\t\t});\n\t},\n\t/**\n\t * Show response message\n\t *\n\t * @param   {boolean}  success\n\t * @param   {string}  message\n\t */\n\tshowResponseMessage(success, message = '') {\n\t\tif (success) {\n\t\t\tthis.mailItem.notificationMessages.replaceAsync('information', {\n\t\t\t\ttype: 'informationalMessage',\n\t\t\t\tmessage: message,\n\t\t\t\ticon: 'iconid',\n\t\t\t\tpersistent: false\n\t\t\t});\n\t\t} else {\n\t\t\tthis.mailItem.notificationMessages.replaceAsync('error', {\n\t\t\t\ttype: 'errorMessage',\n\t\t\t\tmessage: app.vtranslate('JS_ERROR') + ' ' + message\n\t\t\t});\n\t\t}\n\t},\n\t/**\n\t * Register list item events\n\t */\n\tregisterListItemEvents() {\n\t\tthis.container.on('click', '.js-list-item-click', this.onClickListItem.bind(this));\n\t\t$(document).on('click', '.popover a', this.onClickLink.bind(this));\n\t\tthis.container.on('click', '.js-add-related-record', this.onClickQuickCreateBtn.bind(this));\n\t\tthis.container.on('click', '.js-remove-record', this.onClickDeleteRelation.bind(this));\n\t},\n\t/**\n\t * On ListItem click actions\n\t *\n\t * @param   {[type]}  event  [event description]\n\t *\n\t * @return  {[type]}         [return description]\n\t */\n\tonClickListItem(event) {\n\t\tlet currentTarget = $(event.currentTarget);\n\t\tthis.toggleActiveListItems(currentTarget);\n\t\tthis.onClickLink(event, currentTarget.find('.js-record-link').attr('href'));\n\t},\n\t/**\n\t * On link click\n\t *\n\t * @param   {object}  event  click event object\n\t * @param   {string}  url\n\t */\n\tonClickLink(event, url) {\n\t\tevent.preventDefault();\n\t\tif (!url) {\n\t\t\turl = $(event.currentTarget).attr('href');\n\t\t}\n\t\tthis.changeIframeSource(url);\n\t},\n\t/**\n\t * On delete relation click\n\t *\n\t * @param   {object}  event  click event\n\t */\n\tonClickDeleteRelation(event) {\n\t\tevent.stopPropagation();\n\t\tconst currentTarget = $(event.currentTarget);\n\t\tconst recordData = currentTarget.closest('.js-list-item-click').data();\n\t\tthis.connector({\n\t\t\tmodule: 'MailIntegration',\n\t\t\taction: 'Mail',\n\t\t\tmode: 'deleteRelation',\n\t\t\tmailId: this.mailId,\n\t\t\trecord: recordData.id,\n\t\t\trecordModule: recordData.module\n\t\t}).done((response) => {\n\t\t\tthis.showResponseMessage(response['success'], app.vtranslate('JS_REMOVED_RELATION_SUCCESSFULLY'));\n\t\t\tthis.reloadView(response['success']);\n\t\t});\n\t},\n\t/**\n\t * On quick create btn click\n\t *\n\t * @param   {object}  event  click event\n\t */\n\tonClickQuickCreateBtn(event) {\n\t\tevent.stopPropagation();\n\t\tconst currentTarget = $(event.currentTarget);\n\t\tconst recordData = currentTarget.closest('.js-list-item-click').data();\n\t\tconst callbackFunction = () => {\n\t\t\tthis.iframeWindow.location.reload();\n\t\t};\n\t\tlet newRecordData = {\n\t\t\tsourceModule: recordData.module,\n\t\t\tsourceRecord: recordData.id\n\t\t};\n\t\tthis.showQuickCreateForm(event.currentTarget.dataset.module, {\n\t\t\tdata: newRecordData,\n\t\t\tcallbackFunction\n\t\t});\n\t},\n\t/**\n\t * Fill new record data in quick create form\n\t *\n\t * @param   {string}  moduleName  [moduleName description]\n\t *\n\t * @return  {object}              call asyncGetMailBody which returns Promise\n\t */\n\tfillNewRecordData(moduleName) {\n\t\tconst data = {\n\t\t\temail: this.mailItem.from.emailAddress,\n\t\t\temail1: this.mailItem.from.emailAddress,\n\t\t\trelationOperation: true,\n\t\t\trelatedRecords: $.map(this.container.find('.js-list-item-click'), (record) => {\n\t\t\t\treturn { module: record.dataset.module, id: record.dataset.id };\n\t\t\t})\n\t\t};\n\t\tconst fillNameFields = (first) => {\n\t\t\tconst nameData = this.mailItem.from.displayName.split(' ');\n\t\t\tconst firstName = nameData.shift();\n\t\t\tconst lastName = nameData.join(' ');\n\t\t\treturn first ? firstName : lastName;\n\t\t};\n\t\tlet autoCompleteMap = JSON.parse(this.container.find('.js-mailAutoCompleteFields').val());\n\t\tif (autoCompleteMap && autoCompleteMap[moduleName]) {\n\t\t\tlet map = autoCompleteMap[moduleName];\n\t\t\tfor (let name in map) {\n\t\t\t\tif (map.hasOwnProperty(name) && map[name]) {\n\t\t\t\t\tswitch (map[name]) {\n\t\t\t\t\t\tcase 'fromNameFirstPart':\n\t\t\t\t\t\t\tdata[name] = fillNameFields(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'fromNameSecondPart':\n\t\t\t\t\t\t\tdata[name] = fillNameFields(false);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'fromName':\n\t\t\t\t\t\t\tdata[name] = this.mailItem.from.displayName;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'subject':\n\t\t\t\t\t\t\tdata[name] = this.mailItem.subject;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'email':\n\t\t\t\t\t\t\tdata[name] = this.mailItem.from.emailAddress;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.mailDetails = {};\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.asyncGetMailBody().then(() => {\n\t\t\t\tdata.description = this.mailDetails.mailBody;\n\t\t\t\tresolve(data);\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Toggle active list items\n\t *\n\t * @param   {object}  targetListItem  jQuery\n\t */\n\ttoggleActiveListItems(targetListItem) {\n\t\ttargetListItem.siblings().removeClass('active');\n\t\ttargetListItem.addClass('active');\n\t},\n\t/**\n\t * Change iframe source\n\t *\n\t * @param   {string}  url\n\t */\n\tchangeIframeSource(url) {\n\t\tthis.iframe.attr('src', url);\n\t\tthis.showIframeLoader();\n\t},\n\t/**\n\t * Add relation\n\t *\n\t * @param   {number}  recordId\n\t * @param   {string}  moduleName\n\t */\n\taddRelation(recordId, moduleName) {\n\t\tthis.connector({\n\t\t\tmodule: 'MailIntegration',\n\t\t\taction: 'Mail',\n\t\t\tmode: 'addRelation',\n\t\t\tmailId: this.mailId,\n\t\t\trecord: recordId,\n\t\t\trecordModule: moduleName\n\t\t}).done((response) => {\n\t\t\tthis.showResponseMessage(response['success'], app.vtranslate('JS_ADDED_RELATION_SUCCESSFULLY'));\n\t\t\tthis.reloadView(response['success']);\n\t\t});\n\t},\n\t/**\n\t * Show quick create form\n\t *\n\t * @param   {string}  moduleName\n\t * @param   {object}  quickCreateParams\n\t */\n\tshowQuickCreateForm(moduleName, quickCreateParams = {}) {\n\t\tquickCreateParams = Object.assign({ noCache: true, data: {} }, quickCreateParams);\n\t\tthis.fillNewRecordData(moduleName).then((data) => {\n\t\t\tquickCreateParams.data = Object.assign(data, quickCreateParams.data);\n\t\t\tApp.Components.QuickCreate.createRecord(moduleName, quickCreateParams);\n\t\t});\n\t},\n\t/**\n\t * Register iframe events\n\t */\n\tregisterIframeEvents() {\n\t\tconst link = this.container.find('.js-list-item-click').first();\n\t\tthis.initIframeLoader();\n\t\tif (link.length) {\n\t\t\tlink.addClass('active');\n\t\t\tthis.iframe.attr('src', link.find('.js-record-link').attr('href'));\n\t\t\tthis.iframe.on('load', () => {\n\t\t\t\tthis.hideIframeLoader();\n\t\t\t});\n\t\t} else {\n\t\t\tthis.hideIframeLoader();\n\t\t}\n\t},\n\t/**\n\t * Register import click\n\t */\n\tregisterImportClick() {\n\t\tthis.container.on('click', '.js-import-mail', (e) => {\n\t\t\tthis.showIframeLoader();\n\t\t\tthis.getMailDetails().then(() => {\n\t\t\t\tthis.connector(\n\t\t\t\t\tObject.assign(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmodule: 'MailIntegration',\n\t\t\t\t\t\t\taction: 'Import'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tthis.mailDetails,\n\t\t\t\t\t\twindow.PanelParams\n\t\t\t\t\t)\n\t\t\t\t).done((response) => {\n\t\t\t\t\tthis.hideIframeLoader();\n\t\t\t\t\tthis.showResponseMessage(response['success'], app.vtranslate('JS_IMPORT'));\n\t\t\t\t\tthis.reloadView(response['success']);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Get mail details\n\t *\n\t * @return  {object}  Promise\n\t */\n\tgetMailDetails() {\n\t\tlet mailItem = this.mailItem;\n\t\tif (mailItem.attachments.length > 0) {\n\t\t\tlet outputString = '';\n\t\t\tfor (let i = 0; i < mailItem.attachments.length; i++) {\n\t\t\t\tlet attachment = mailItem.attachments[i];\n\t\t\t\toutputString += '<BR>' + i + '. Name: ';\n\t\t\t\toutputString += attachment.name;\n\t\t\t\toutputString += '<BR>ID: ' + attachment.id;\n\t\t\t\toutputString += '<BR>contentType: ' + attachment.contentType;\n\t\t\t\toutputString += '<BR>size: ' + attachment.size;\n\t\t\t\toutputString += '<BR>attachmentType: ' + attachment.attachmentType;\n\t\t\t\toutputString += '<BR>isInline: ' + attachment.isInline;\n\t\t\t}\n\t\t}\n\t\tthis.mailDetails = {\n\t\t\tmailFrom: this.parseEmailAddressDetails(mailItem.from),\n\t\t\tmailSender: mailItem.sender.emailAddress,\n\t\t\tmailTo: this.parseEmailAddressDetails(mailItem.to),\n\t\t\tmailCc: this.parseEmailAddressDetails(mailItem.cc),\n\t\t\tmailMessageId: mailItem.internetMessageId,\n\t\t\tmailSubject: mailItem.subject,\n\t\t\tmailNormalizedSubject: mailItem.normalizedSubject,\n\t\t\tmailDateTimeCreated: mailItem.dateTimeCreated.toISOString()\n\t\t};\n\t\treturn this.asyncGetMailBody();\n\t},\n\t/**\n\t * Get mail body async function\n\t *\n\t * @param   {function}  callback\n\t *\n\t * @return  {object}            Promise\n\t */\n\tasyncGetMailBody() {\n\t\treturn Promise.all([\n\t\t\tnew Promise((resolve, reject) => {\n\t\t\t\tthis.mailItem.body.getAsync(Office.CoercionType.Html, (body) => {\n\t\t\t\t\tif (body.status === 'succeeded') {\n\t\t\t\t\t\tthis.mailDetails.mailBody = body.value;\n\t\t\t\t\t\tresolve(body);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(body);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}),\n\t\t\tnew Promise((resolve, reject) => {\n\t\t\t\tthis.mailItem.getAllInternetHeadersAsync((body) => {\n\t\t\t\t\tif (body.status === 'succeeded') {\n\t\t\t\t\t\tthis.mailDetails.mailHeaders = body.value;\n\t\t\t\t\t\tresolve(body);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(body);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t]);\n\t},\n\t/**\n\t * Parse email address details\n\t *\n\t * @param   {object}  data\n\t *\n\t * @return  {string}        e-mail address\n\t */\n\tparseEmailAddressDetails(data) {\n\t\tlet fn = function (row) {\n\t\t\treturn row.emailAddress;\n\t\t};\n\t\tif ($.isArray(data)) {\n\t\t\tlet rows = [];\n\t\t\t$.each(data, function (index, value) {\n\t\t\t\trows[index] = fn(value);\n\t\t\t});\n\t\t\treturn rows;\n\t\t} else {\n\t\t\treturn fn(data);\n\t\t}\n\t},\n\t/**\n\t * Set iframe height\n\t */\n\tsetIframeHeight() {\n\t\tthis.iframe.height($(window).height() - this.iframe.offset().top);\n\t},\n\t/**\n\t * Show iframe loader\n\t */\n\tshowIframeLoader() {\n\t\tthis.iframeLoader.progressIndicator(this.loaderParams);\n\t},\n\t/**\n\t * Hide iframe loader\n\t */\n\thideIframeLoader() {\n\t\tthis.iframeLoader.progressIndicator({ mode: 'hide' });\n\t},\n\t/**\n\t * Init iframe loader\n\t */\n\tinitIframeLoader() {\n\t\tthis.iframeLoader = $.progressIndicator(this.loaderParams);\n\t},\n\t/**\n\t * Register modules select\n\t */\n\tregisterModulesSelect() {\n\t\tthis.moduleSelect = App.Fields.Picklist.showSelect2ElementView(this.container.find('.js-modules'));\n\t\tthis.moduleSelect.on('change', this.registerModulesSelectChange.bind(this));\n\t\tthis.container.find('.js-select-record').on('click', (e) => {\n\t\t\tlet params = {\n\t\t\t\tmodule: this.moduleSelect[0].value,\n\t\t\t\tsrc_module: 'OSSMailView'\n\t\t\t};\n\t\t\tthis.container.find('.js-list-item-click').each(function (index) {\n\t\t\t\tlet data = $(this).data();\n\t\t\t\tif (data.field == 'link' || data.field == 'process') {\n\t\t\t\t\tparams[data.field] = data.id;\n\t\t\t\t}\n\t\t\t});\n\t\t\tapp.showRecordsList(params, (modal, instance) => {\n\t\t\t\tinstance.setSelectEvent((responseData, e) => {\n\t\t\t\t\tthis.addRelation(responseData.id, params.module);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Register modules select change\n\t */\n\tregisterModulesSelectChange() {\n\t\tif (this.moduleSelect.select2('data')[0].element.dataset.addRecord) {\n\t\t\tthis.addRecordBtn.removeClass('d-none');\n\t\t} else {\n\t\t\tthis.addRecordBtn.addClass('d-none');\n\t\t}\n\t},\n\t/**\n\t * Register add record\n\t */\n\tregisterAddRecord() {\n\t\tthis.addRecordBtn.on('click', (e) => {\n\t\t\tlet moduleName = this.moduleSelect[0].value;\n\t\t\tlet callbackFunction = ({ result }) => {\n\t\t\t\tthis.addRelation(result._recordId, moduleName);\n\t\t\t};\n\t\t\tlet quickCreateParams = { callbackFunction };\n\t\t\tthis.showQuickCreateForm(moduleName, quickCreateParams);\n\t\t});\n\t},\n\t/**\n\t * Reload view\n\t */\n\treloadView(condition) {\n\t\tif (condition) {\n\t\t\twindow.location.reload();\n\t\t}\n\t},\n\t/**\n\t * Register events\n\t */\n\tregisterEvents() {\n\t\tthis.container = $('#page');\n\t\tthis.iframe = $('#js-iframe');\n\t\tthis.iframeWindow = this.iframe[0].contentWindow;\n\t\tthis.addRecordBtn = this.container.find('.js-add-record');\n\t\tthis.mailId = this.container.find('.js-iframe-container').data('mailId');\n\t\tthis.mailItem = Office.context.mailbox.item;\n\t\tif (this.iframe.length) {\n\t\t\tthis.registerListItemEvents();\n\t\t\tthis.registerIframeEvents();\n\t\t\tthis.setIframeHeight();\n\t\t\tif (this.mailId) {\n\t\t\t\tthis.registerModulesSelect();\n\t\t\t\tthis.registerAddRecord();\n\t\t\t} else {\n\t\t\t\tthis.registerImportClick();\n\t\t\t}\n\t\t}\n\t}\n};\nwindow.App.Components.Scrollbar.active = false;\n(function ($) {\n\twindow.MailIntegration_Iframe.registerEvents();\n})($);\n"],"names":["window","MailIntegration_Iframe","mailId","container","iframe","iframeWindow","moduleSelect","addRecordBtn","loaderParams","blockInfo","enabled","message","connector","request","fail","hideIframeLoader","showResponseMessage","success","mailItem","notificationMessages","replaceAsync","type","icon","persistent","app","vtranslate","registerListItemEvents","on","onClickListItem","bind","$","document","onClickLink","onClickQuickCreateBtn","onClickDeleteRelation","event","currentTarget","toggleActiveListItems","find","attr","url","preventDefault","changeIframeSource","stopPropagation","recordData","closest","data","module","action","mode","record","id","recordModule","done","response","reloadView","newRecordData","sourceModule","sourceRecord","showQuickCreateForm","dataset","callbackFunction","location","reload","fillNewRecordData","moduleName","email","from","emailAddress","email1","relationOperation","relatedRecords","map","fillNameFields","first","displayName","split","firstName","nameData","shift","lastName","join","autoCompleteMap","JSON","parse","val","hasOwnProperty","name","subject","mailDetails","resolve","asyncGetMailBody","then","description","mailBody","targetListItem","siblings","removeClass","addClass","showIframeLoader","addRelation","recordId","quickCreateParams","Object","assign","noCache","App","Components","QuickCreate","createRecord","registerIframeEvents","link","initIframeLoader","length","registerImportClick","getMailDetails","PanelParams","attachments","outputString","i","attachment","contentType","size","attachmentType","isInline","mailFrom","parseEmailAddressDetails","mailSender","sender","mailTo","to","mailCc","cc","mailMessageId","internetMessageId","mailSubject","mailNormalizedSubject","normalizedSubject","mailDateTimeCreated","dateTimeCreated","toISOString","all","reject","body","getAsync","Office","CoercionType","Html","status","value","getAllInternetHeadersAsync","mailHeaders","row","isArray","each","index","rows","fn","setIframeHeight","height","offset","top","iframeLoader","progressIndicator","registerModulesSelect","Fields","Picklist","showSelect2ElementView","registerModulesSelectChange","src_module","field","params","showRecordsList","modal","instance","setSelectEvent","responseData","select2","element","addRecord","registerAddRecord","result","_recordId","condition","registerEvents","contentWindow","context","mailbox","item","Scrollbar","active"],"mappings":"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"}