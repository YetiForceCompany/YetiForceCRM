{"version":3,"file":"BasicSearch.min.js","sources":["BasicSearch.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\njQuery.Class(\n\t'Vtiger_BasicSearch_Js',\n\t{},\n\t{\n\t\t//stores the module that need to be searched\n\t\tsearchModule: false,\n\t\t//stores the module that need to be searched which is selected by the user\n\t\tcurrentSearchModule: false,\n\t\t// reduce the number of results\n\t\treduceNumberResults: false,\n\t\t// Should the result be in html\n\t\treturnHtml: true,\n\t\t// Main conatiner with modules, value and buttons\n\t\tmainConatiner: false,\n\t\t/**\n\t\t * Function to get the search module\n\t\t */\n\t\tgetSearchModule: function() {\n\t\t\tif (this.searchModule === false) {\n\t\t\t\t//default gives current module\n\t\t\t\tvar module = app.getModuleName();\n\t\t\t\tif (typeof this.getCurrentSearchModule() !== 'undefined') {\n\t\t\t\t\tmodule = this.getCurrentSearchModule();\n\t\t\t\t}\n\n\t\t\t\tthis.setSearchModule(module);\n\t\t\t}\n\t\t\treturn this.searchModule;\n\t\t},\n\t\t/**\n\t\t * Function to set the search module\n\t\t */\n\t\tsetSearchModule: function(moduleName) {\n\t\t\tthis.searchModule = moduleName;\n\t\t\treturn this;\n\t\t},\n\t\t/**\n\t\t * Function to set main conatainer\n\t\t */\n\t\tsetMainContainer: function(container) {\n\t\t\tthis.mainConatiner = container;\n\t\t\treturn this;\n\t\t},\n\t\t/**\n\t\t * Function to get the user selected search module\n\t\t */\n\t\tgetCurrentSearchModule: function() {\n\t\t\tif (this.currentSearchModule === false && this.mainConatiner) {\n\t\t\t\tthis.currentSearchModule = this.mainConatiner.find('.basicSearchModulesList').val();\n\t\t\t}\n\t\t\treturn this.currentSearchModule;\n\t\t},\n\t\t/**\n\t\t * Function which will perform the search\n\t\t */\n\t\t_search: function(params) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tif (typeof params === 'undefined') {\n\t\t\t\tparams = {};\n\t\t\t}\n\t\t\tif (params.searchModule && params.searchModule !== '-') {\n\t\t\t\tparams.module = params.searchModule;\n\t\t\t} else {\n\t\t\t\tparams.module = app.getModuleName();\n\t\t\t}\n\t\t\tparams.view = 'BasicAjax';\n\t\t\tparams.mode = 'showSearchResults';\n\t\t\tparams.limit = this.reduceNumberResults;\n\t\t\tparams.html = this.returnHtml;\n\t\t\tif (app.getParentModuleName()) {\n\t\t\t\tparams.parent = app.getParentModuleName();\n\t\t\t}\n\t\t\tparams.operator = CONFIG.globalSearchDefaultOperator;\n\t\t\tif (this.mainContainer) {\n\t\t\t\tif (\n\t\t\t\t\tthis.mainConatiner.find('input[data-operator]').length &&\n\t\t\t\t\tthis.mainConatiner.find('input[data-operator]').data('operator') != ''\n\t\t\t\t) {\n\t\t\t\t\tparams.operator = this.mainConatiner.find('input[data-operator]').data('operator');\n\t\t\t\t}\n\t\t\t}\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(function(data) {\n\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t})\n\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\taDeferred.reject(error);\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Helper function whicn invokes search\n\t\t */\n\t\tsearch: function(value) {\n\t\t\tvar searchModule = this.getCurrentSearchModule();\n\t\t\tvar params = {};\n\t\t\tparams.value = value;\n\t\t\tif (typeof searchModule !== 'undefined' && searchModule !== false) {\n\t\t\t\tparams.searchModule = searchModule;\n\t\t\t} else if (this.searchModule) {\n\t\t\t\tparams.searchModule = this.searchModule;\n\t\t\t}\n\t\t\treturn this._search(params);\n\t\t},\n\t\t/**\n\t\t * Function which shows the search results\n\t\t */\n\t\tshowSearchResults: function(data) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar postLoad = function(data) {\n\t\t\t\taDeferred.resolve(data);\n\t\t\t};\n\t\t\tvar params = {};\n\t\t\tparams.data = data;\n\t\t\tparams.cb = postLoad;\n\t\t\tapp.showModalWindow(params);\n\t\t\treturn aDeferred.promise();\n\t\t}\n\t}\n);\n"],"names":["jQuery","Class","searchModule","currentSearchModule","reduceNumberResults","returnHtml","mainConatiner","getSearchModule","app","getModuleName","getCurrentSearchModule","module","setSearchModule","moduleName","setMainContainer","container","find","val","_search","params","Deferred","view","mode","limit","html","getParentModuleName","parent","operator","CONFIG","globalSearchDefaultOperator","mainContainer","length","data","AppConnector","request","done","aDeferred","resolve","fail","error","reject","promise","search","value","showSearchResults","cb","showModalWindow"],"mappings":"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"}