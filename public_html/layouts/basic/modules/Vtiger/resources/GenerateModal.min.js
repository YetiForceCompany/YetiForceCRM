'use strict';

jQuery.Class('Vtiger_GenerateModal_Js',{},{registerGenetateButton:function c(a){var b=this;a.find('button.js-genetate-button').on('click',function(c){document.progressLoader=jQuery.progressIndicator({message:app.vtranslate('JS_LOADING_PLEASE_WAIT'),position:'html',blockInfo:{enabled:!0}});var d=jQuery(c.currentTarget),e=d.data('url'),f=jQuery('[name="method"]:checked');if(0>=f.length)window.location.href=e;else{var g={};g.data={module:app.getModuleName(),action:'GenerateRecords',records:jQuery('[name="all_records"]').val(),template:d.data('id'),target:d.data('name'),method:f.val()},g.dataType='json',AppConnector.request(g).done(function(c){var d=c.result;if(c.success){var g=d.ok;if(b.summary(a,d),document.progressLoader.progressIndicator({mode:'hide'}),1==f.val())for(var h in g)window.open(e+g[h],'_blank');}}).fail(function(a,b){app.errorLog(a,b);});}});},summary:function c(a,b){a.find('.modal-title').text(app.vtranslate('JS_SUMMARY')),a.find('.modal-body').html('<div>'+app.vtranslate('JS_SELECTED_RECORDS')+': <strong>'+b.all+'</strong></div>\n\t\t\t\t\t\t\t\t\t<div>'+app.vtranslate('JS_SUCCESSFULLY_PERFORMED_ACTION_FOR')+': <strong>'+b.ok.length+'</strong></div>\n\t\t\t\t\t\t\t\t\t<div>'+app.vtranslate('JS_ACTION_FAILED_FOR')+': <strong>'+b.fail.length+'</strong></div>');},registerEvents:function b(){var a=jQuery('.generateMappingModal');app.showPopoverElementView(a.find('.js-popover-tooltip')),this.registerGenetateButton(a);}}),jQuery(document).ready(function(){var a=new Vtiger_GenerateModal_Js;a.registerEvents();});
