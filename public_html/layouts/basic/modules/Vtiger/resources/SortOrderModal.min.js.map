{"version":3,"file":"SortOrderModal.min.js","sources":["SortOrderModal.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\n\t'Base_SortOrderModal_JS',\n\t{},\n\t{\n\t\t/**\n\t\t * Modal container\n\t\t */\n\t\tcontainer: false,\n\t\t/**\n\t\t * Source container\n\t\t */\n\t\tsourceContainer: false,\n\t\t/**\n\t\t * Modal ID\n\t\t */\n\t\tsource: false,\n\t\t/**\n\t\t * Load data\n\t\t */\n\t\tloadData: function () {\n\t\t\tlet orderBy = this.sourceContainer.find('#orderBy').val();\n\t\t\torderBy = orderBy ? JSON.parse(orderBy) : [];\n\t\t\tif (orderBy && Object.keys(orderBy).length) {\n\t\t\t\tlet baseOrderBy = this.container.find('.js-base-element');\n\t\t\t\tfor (let field in orderBy) {\n\t\t\t\t\tif (!baseOrderBy.find(\"option[value='\" + field + \"']\").length) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tlet element = this.addRow();\n\t\t\t\t\telement.find('select.js-orderBy').val(field).change();\n\t\t\t\t\tlet sortIcon = element.find('.js-sort-icon-active');\n\t\t\t\t\tif (orderBy[field] && sortIcon.data('val') != orderBy[field]) {\n\t\t\t\t\t\tsortIcon.trigger('click');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.addRow();\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Add new row\n\t\t */\n\t\taddRow: function () {\n\t\t\tlet sortContainer = this.container.find('.js-base-element').clone(true, true).removeClass('js-base-element');\n\t\t\tthis.container.find('.js-sort-container').append(sortContainer);\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(sortContainer.find('select'));\n\t\t\treturn sortContainer.removeClass('d-none');\n\t\t},\n\t\t/**\n\t\t * Register list events\n\t\t */\n\t\tregisterListEvents: function () {\n\t\t\tthis.container.find('.js-add').on('click', (e) => {\n\t\t\t\tthis.addRow();\n\t\t\t});\n\t\t\tthis.container.find('.js-clear').on('click', (e) => {\n\t\t\t\t$(e.currentTarget).closest('.js-sort-container_element').remove();\n\t\t\t});\n\t\t\tthis.container.find('.js-sort-order-button').on('click', (e) => {\n\t\t\t\tlet element = $(e.currentTarget).closest('.js-sort-container_element');\n\t\t\t\telement.find('.js-sort-icon').toggleClass('d-none js-sort-icon-active');\n\t\t\t\telement.find('.js-sort-order').val(element.find('.js-sort-icon-active').data('val'));\n\t\t\t});\n\t\t\tthis.container.find('.js-modal__save').on('click', (e) => {\n\t\t\t\te.preventDefault;\n\t\t\t\tthis.sourceContainer.find('.js-list-reload').trigger('click', { orderby: this.getSortData() });\n\t\t\t\tapp.hideModalWindow(null, this.source);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Gets sort data\n\t\t */\n\t\tgetSortData: function () {\n\t\t\tlet sortData = {};\n\t\t\tthis.container.find('.js-sort-container_element:not(.js-base-element)').each(function () {\n\t\t\t\tlet orderBy = $(this).find('.js-orderBy').val();\n\t\t\t\tif (orderBy) {\n\t\t\t\t\tsortData[orderBy] = $(this).find('.js-sort-order').val();\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn sortData;\n\t\t},\n\t\t/**\n\t\t * Gets basic container\n\t\t */\n\t\tgetSourceContainer: function () {\n\t\t\treturn $('[data-modalid=' + this.source + ']').closest('.listViewContentDiv,.relatedContainer');\n\t\t},\n\t\t/**\n\t\t * Register modal events\n\t\t * @param {jQuery} modalContainer\n\t\t */\n\t\tregisterEvents: function (modalContainer) {\n\t\t\tthis.container = modalContainer;\n\t\t\tthis.source = modalContainer.closest('.js-modal-container').attr('id');\n\t\t\tthis.sourceContainer = this.getSourceContainer();\n\t\t\tthis.registerListEvents();\n\t\t\tthis.loadData();\n\t\t}\n\t}\n);\n"],"names":["$","Class","container","sourceContainer","source","loadData","find","val","orderBy","JSON","parse","Object","keys","length","baseOrderBy","field","addRow","element","change","sortIcon","data","trigger","clone","removeClass","append","sortContainer","App","Fields","Picklist","showSelect2ElementView","registerListEvents","on","e","currentTarget","closest","remove","toggleClass","preventDefault","orderby","getSortData","app","hideModalWindow","each","sortData","getSourceContainer","registerEvents","modalContainer","attr"],"mappings":"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"}