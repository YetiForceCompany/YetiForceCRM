'use strict';

jQuery.Class('Vtiger_BasicSearch_Js',{},{searchModule:!1,currentSearchModule:!1,reduceNumberResults:!1,returnHtml:!0,mainConatiner:!1,getSearchModule:function b(){if(!1===this.searchModule){var a=app.getModuleName();'undefined'!=typeof this.getCurrentSearchModule()&&(a=this.getCurrentSearchModule()),this.setSearchModule(a);}return this.searchModule},setSearchModule:function b(a){return this.searchModule=a,this},setMainContainer:function b(a){return this.mainConatiner=a,this},getCurrentSearchModule:function a(){return !1===this.currentSearchModule&&this.mainConatiner&&(this.currentSearchModule=this.mainConatiner.find('.basicSearchModulesList').val()),this.currentSearchModule},_search:function c(a){var b=jQuery.Deferred();return 'undefined'==typeof a&&(a={}),a.module=a.searchModule&&'-'!==a.searchModule?a.searchModule:app.getModuleName(),a.view='BasicAjax',a.mode='showSearchResults',a.limit=this.reduceNumberResults,a.html=this.returnHtml,app.getParentModuleName()&&(a.parent=app.getParentModuleName()),this.mainConatiner.find('input[data-operator]').length&&''!=this.mainConatiner.find('input[data-operator]').data('operator')&&(a.operator=this.mainConatiner.find('input[data-operator]').data('operator')),AppConnector.request(a).done(function(a){b.resolve(a);}).fail(function(a){b.reject(a);}),b.promise()},search:function d(a){var b=this.getCurrentSearchModule(),c={};return c.value=a,'undefined'!=typeof b&&(c.searchModule=b),this._search(c)},showSearchResults:function d(a){var b=jQuery.Deferred(),c={};return c.data=a,c.cb=function c(a){jQuery(a).find('.contents');b.resolve(a);},app.showModalWindow(c),b.promise()}});
