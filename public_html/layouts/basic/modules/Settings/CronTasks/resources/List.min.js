'use strict';

/*+***********************************************************************************
 * The contents of this file are subject to the vtiger CRM Public License Version 1.0
 * ("License"); You may not use this file except in compliance with the License
 * The Original Code is:  vtiger CRM Open Source
 * The Initial Developer of the Original Code is vtiger.
 * Portions created by vtiger are Copyright (C) vtiger.
 * All Rights Reserved.
 * Contributor(s): YetiForce S.A.
 *************************************************************************************/"use strict";Settings_Vtiger_List_Js("Settings_CronTasks_List_Js",{triggerEditEvent:function triggerEditEvent(editUrl){AppConnector.request(editUrl).done(function(data){app.showModalWindow(data),jQuery("#cronJobSaveAjax").validationEngine(app.validationEngineOptions);var listViewInstance=Settings_CronTasks_List_Js.getInstance();listViewInstance.registerSaveEvent();});}},{getListViewRecords:function getListViewRecords(){var thisInstance=this,params={module:app.getModuleName(),parent:app.getParentModuleName(),view:"List"},progressIndicatorElement=jQuery.progressIndicator({position:"html",blockInfo:{enabled:!0}});AppConnector.request(params).done(function(data){jQuery("#listViewContents").html(data),thisInstance.registerSortableEvent(),progressIndicatorElement.progressIndicator({mode:"hide"});});},registerSaveEvent:function registerSaveEvent(){var thisInstance=this;jQuery("#cronJobSaveAjax").on("submit",function(e){var form=jQuery(e.currentTarget),validationResult=form.validationEngine("validate");if(!0==validationResult){var timeFormat=jQuery("#time_format").val(),frequencyElement=jQuery("#frequencyValue");if("hours"==timeFormat)var frequencyValue=60*(60*frequencyElement.val());else frequencyValue=60*frequencyElement.val();var message=app.vtranslate("JS_VALUE_SHOULD_NOT_BE_LESS_THAN"),minimumFrequency=jQuery("#minimumFrequency").val(),minutes=app.vtranslate("JS_MINUTES");if(frequencyValue<minimumFrequency)return frequencyElement.validationEngine("showPrompt",message+" "+minimumFrequency/60+" "+minutes,"error"),void e.preventDefault();jQuery("#frequency").val(frequencyValue);var params=form.serializeFormData();AppConnector.request(params).done(function(data){"undefined"!=typeof data.result&&!0==data.result[0]&&(app.hideModalWindow(),thisInstance.getListViewRecords());});}e.preventDefault();});},registerSortableEvent:function registerSortableEvent(){var thisInstance=this,sequenceList={},tbody=jQuery("tbody",jQuery(".listViewEntriesTable"));tbody.sortable({helper:function helper(e,ui){return ui.children().each(function(index,element){element=jQuery(element),element.width(element.width());}),ui},containment:tbody,revert:!0,update:function update(){jQuery("tbody tr").each(function(i){sequenceList[++i]=jQuery(this).data("id");});var params={sequencesList:JSON.stringify(sequenceList),module:app.getModuleName(),parent:app.getParentModuleName(),action:"UpdateSequence"};AppConnector.request(params).done(function(){thisInstance.getListViewRecords();});}});},/**
		 * Register events
		 * @returns {undefined}
		 */registerEvents:function registerEvents(){this.registerSortableEvent();}});
//# sourceMappingURL=List.min.js.map
