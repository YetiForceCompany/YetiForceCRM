
jQuery.Class("Settings_MarketingProcesses_Index_Js", {}, {registerChangeVal:function(a){a.find(".configField").change(function(c){var b = $(c.currentTarget); var d; if (b.attr("type") === "checkbox"){d = this.checked} else{d = b.val() != null?b.val():""}AppConnector.request({module:app.getModuleName(), parent:app.getParentModuleName(), action:"SaveAjax", mode:"updateConfig", type:b.data("type"), param:b.attr("name"), value:d}).then(function(e){Settings_Vtiger_Index_Js.showMessage({type:"success", text:e.result.message})})})}, registerSaveMapping:function(b){var a = this; b.find("button.saveMapping").on("click", function(){var c = []; jQuery("#convertLeadMapping tr.listViewEntries:not(.hide)").each(function(){var d = jQuery(this).find("select.leadsFields").val(); var f = jQuery(this).find("select.accountsFields").val(); var e = []; e[d] = f; e = jQuery.extend({}, e); if (a.uniqueReduce(c, e)){c.push(e)}}); if (c.length){jQuery('[name="mapping"]').val(JSON.stringify(c)).change()} else{Settings_Vtiger_Index_Js.showMessage({type:"info", text:app.vtranslate("JS_NO_CONDITIONS")})}})}, uniqueReduce:function(b, a){for (var c in b){if (JSON.stringify(b[c]) === JSON.stringify(a)){return false}}return true}, registerEventToDeleteMapping:function(a){a.find(".deleteMapping").on("click", function(d){var b = jQuery(d.currentTarget); var c = b.closest("tr"); c.remove()})}, registerMapping:function(a){a.find('[name="create_always"]').on("change", function(c){var b = jQuery(".mappingTable"); if (this.checked){b.removeClass("hide")} else{b.addClass("hide")}})}, registerEvents:function(){var b = $("#supportProcessesContainer"); this.registerChangeVal(b); this.registerSaveMapping(b); this.registerMapping(b); this.registerEventToDeleteMapping(b); var a = new Settings_LeadMapping_Js(); a.registerEventForAddingNewMapping()}});
