'use strict';

Settings_Vtiger_Index_Js('Settings_PBXManager_Index_Js',{},{saveAsteriskServerDetails:function e(a){var b=this,c=a.serializeFormData(),d=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});'undefined'==typeof c&&(c={}),c.module=app.getModuleName(),c.parent=app.getParentModuleName(),c.action='SaveAjax',AppConnector.request(c).done(function(c){if(c.success){var e=a.data('detailUrl');b.loadContents(e).done(function(){d.progressIndicator({mode:'hide'}),b.registerDetailViewEvents();}).fail(function(){d.progressIndicator({mode:'hide'});});}else d.progressIndicator({mode:'hide'}),jQuery('.errorMessage',a).removeClass('d-none');});},registerEditViewEvents:function e(){var a=this,b=jQuery('#MyModal'),c=jQuery('.cancelLink',b);AppConnector.request('index.php?module=PBXManager&parent=Settings&action=Gateway&mode=getSecretKey').done(function(a){jQuery('input[name=\'vtigersecretkey\']').attr('value',a.result);});var d=app.validationEngineOptions;d.onValidationComplete=function(b,c){if(c)return a.saveAsteriskServerDetails(b),c},b.validationEngine(d),b.on('submit',function(a){a.preventDefault();}),c.on('click',function(){var c=b.data('detailUrl'),d=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});a.loadContents(c).done(function(){d.progressIndicator({mode:'hide'}),a.registerDetailViewEvents();}).fail(function(){d.progressIndicator({mode:'hide'});});});},registerDetailViewEvents:function d(){var a=this,b=jQuery('#AsteriskServerDetails'),c=jQuery('.editButton',b);c.on('click',function(b){var c=jQuery(b.currentTarget).data('url'),d=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});a.loadContents(c).done(function(){a.registerEditViewEvents(),d.progressIndicator({mode:'hide'});}).fail(function(){d.progressIndicator({mode:'hide'});});});},loadContents:function c(a){var b=jQuery.Deferred();return AppConnector.requestPjax(a).done(function(a){jQuery('.contentsDiv').html(a),b.resolve(a);}).fail(function(){b.reject();}),b.promise()},registerEvents:function b(){var a=this;a.registerDetailViewEvents();}}),jQuery(document).ready(function(){var a=new Settings_Vtiger_Index_Js;a.registerEvents();});
