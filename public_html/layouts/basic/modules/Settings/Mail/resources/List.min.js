'use strict';

Settings_Vtiger_List_Js('Settings_Mail_List_Js',{},{registerAcceptanceEvent:function c(){var b=jQuery('.listViewEntriesDiv');b.on('click','.acceptanceRecord',function(){var a=this,b=$(this).closest('tr').data('id'),c=jQuery.progressIndicator();AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:'SaveAjax',mode:'acceptanceRecord',id:b}).done(function(b){c.progressIndicator({mode:'hide'}),Settings_Vtiger_Index_Js.showMessage({text:b.result.message}),$(a).remove();}).fail(function(){c.progressIndicator({mode:'hide'});});});},massDeleteAction:function a(){$('.massDelete').on('click',function(){var a=Settings_Vtiger_List_Js.getInstance(),b=a.checkListRecordSelected();if(!0!=b){var c=a.readSelectedIds(!0),d=a.readExcludedIds(!0),e=a.getCurrentCvId(),f=app.vtranslate('LBL_MASS_DELETE_CONFIRMATION');Vtiger_Helper_Js.showConfirmationBox({message:f}).done(function(){var b={module:app.getModuleName(),parent:app.getParentModuleName(),action:'MassDelete',selected_ids:c},d=app.vtranslate('JS_RECORDS_ARE_GETTING_DELETED'),e=jQuery.progressIndicator({message:d,position:'html',blockInfo:{enabled:!0}});AppConnector.request(b).done(function(b){e.progressIndicator({mode:'hide'}),a.postMassDeleteRecords(),b.error&&Vtiger_Helper_Js.showPnotify({text:app.vtranslate(b.error.message),title:app.vtranslate('JS_LBL_PERMISSION')});});}).fail(function(){Vtiger_List_Js.clearList();});}else a.noRecordSelectedAlert();});},registerFilterChangeEvent:function b(){var a=this;jQuery('#mailQueueFilter').on('change',function(b){jQuery('#pageNumber').val('1'),jQuery('#pageToJump').val('1'),jQuery('#orderBy').val(''),jQuery('#sortOrder').val('');var c={module:app.getModuleName(),parent:app.getParentModuleName(),orderby:jQuery(b.currentTarget).val(),page:1};jQuery('#totalPageCount').text(''),a.getListViewRecords(c).done(function(){a.updatePagination();});});},getParams:function d(){var a=this.getListViewContainer(),b={};a.find('input.listSearchContributor, select.listSearchContributor').each(function(a,c){if(null!=$(c).val()){var d=$(c).attr('name');b[d]={},b[d].value=$(c).val();}});var c={module:app.getModuleName(),parent:app.getParentModuleName(),page:1,view:'List',searchParams:b};return c},registerListSearch:function c(){var a=this,b=this.getListViewContainer();b.find('input.listSearchContributor').on('keypress',function(b){if(13==b.keyCode){var c=a.getParams();jQuery('#totalPageCount').text(''),a.getListViewRecords(c).done(function(){a.updatePagination();});}}),b.find('[data-trigger="listSearch"]').on('click',function(){var b=a.getParams();a.getListViewRecords(b).done(function(){a.updatePagination();});});},registerListViewSelect:function c(){if('1'==app.getMainParams('autoRefreshListOnChange')){var a=this,b=this.getListViewContainer();b.on('change','.listViewEntriesTable select',function(){var b=a.getParams();a.getListViewRecords(b).done(function(){a.updatePagination();});});}},registerEvents:function a(){this._super(),this.registerFilterChangeEvent(),this.massDeleteAction(),this.registerAcceptanceEvent(),this.registerListSearch(),this.registerListViewSelect();}});
