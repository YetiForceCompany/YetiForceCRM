var Settings_Index_Js={updatedBlockFieldsList:[],initEvants:function(){$(".SearchFieldsEdit .fieldname").on("change",Settings_Index_Js.save);$(".SearchFieldsEdit .searchcolumn").on("change",Settings_Index_Js.save);$(".SearchFieldsEdit .updateLabels").on("click",Settings_Index_Js.updateLabels);$(".SearchFieldsEdit .editLabels").on("click",Settings_Index_Js.editLabels);$(".SearchFieldsEdit .turn_off").on("click",Settings_Index_Js.replacement)},replacement:function(b){var a=$(b.currentTarget);if(parseInt(a.val())){a.val(0).html(app.vtranslate("JS_TURN_ON"))}else{a.val(1).html(app.vtranslate("JS_TURN_OFF"))}a.toggleClass("btn-success btn-danger");Settings_Index_Js.save(b)},updateLabels:function(c){var b=$(c.currentTarget);var a=b.closest("tr");if(!a.hasClass("ui-sortable-handle")){a=a.prev()}Settings_Index_Js.registerSaveEvent("updateLabels",{tabid:a.data("tabid")})},editLabels:function(d){var c=$(d.currentTarget);var b=c.data("tabid");var a=c.closest("tr");jQuery(".elementLabels"+b).addClass("d-none");var d=jQuery(".elementEdit"+b).removeClass("d-none");Settings_Index_Js.registerSelectElement(d.find("select"))},save:function(b){var a=$(b.currentTarget);Settings_Index_Js.registerSaveEvent("save",{name:a.attr("name"),value:a.val(),tabid:a.data("tabid")})},registerSaveEvent:function(e,b){var a=$.progressIndicator({message:app.vtranslate("Saving changes"),position:"html",blockInfo:{enabled:true}});var d="";var c={};c.data={module:app.getModuleName(),parent:app.getParentModuleName(),action:"SaveAjax",mode:e,params:b};c.async=false;c.dataType="json";AppConnector.request(c).then(function(g){var f=g.result;var h={text:f.message,type:"success"};Vtiger_Helper_Js.showPnotify(h);d=f.success;a.progressIndicator({mode:"hide"})},function(g,f){app.errorLog(g,f);a.progressIndicator({mode:"hide"})})},makeFieldsListSortable:function(){var c=this;var b=jQuery(".SearchFieldsEdit").find(".contents");var a=b.find("table");a.each(function(){jQuery(this).find("tbody").sortable({containment:"#modulesEntity",revert:true,tolerance:"pointer",cursor:"move",helper:function(f,d){d.children().each(function(e,g){g=jQuery(g);g.width(g.width())});return d},update:function(f,d){c.showSaveModuleSequenceButton()}})})},showSaveModuleSequenceButton:function(){var b=this;var a=jQuery(".SearchFieldsEdit");var c=a.find(".saveModuleSequence");b.updatedBlockFieldsList=[];c.removeClass("d-none")},hideSaveModuleSequenceButton:function(){var a=jQuery(".SearchFieldsEdit");var b=a.find(".saveModuleSequence");b.addClass("d-none")},updateModulesSequence:function(){var a=this;var b=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});var c={};c.module=app.getModuleName();c.parent=app.getParentModuleName();c.action="SaveAjax";c.mode="saveSequenceNumber";c.updatedFields=a.updatedBlockFieldsList;AppConnector.request(c).then(function(d){b.progressIndicator({mode:"hide"});var e={};e.text=app.vtranslate("JS_MODULES_SEQUENCE_UPDATED");Settings_Vtiger_Index_Js.showMessage(e)},function(d){b.progressIndicator({mode:"hide"})})},createUpdatedSequenceModulesList:function(){var e=this;var d=jQuery(".SearchFieldsEdit").find(".contents");var a=d.find("tbody");var c=a.find("tr");var b=1;c.each(function(g,j){var f=jQuery(j);var h=f.data("tabid");e.updatedBlockFieldsList.push({tabid:h,sequence:b});b=b+1})},registerModuleSequenceSaveClick:function(){var b=this;var a=jQuery(".SearchFieldsEdit");a.on("click",".saveModuleSequence",function(){b.hideSaveModuleSequenceButton();b.createUpdatedSequenceModulesList();b.updateModulesSequence()})},registerSelectElement:function(a){var b=a.val();if(!a.hasClass("selectized")){a.selectize({plugins:["drag_drop","remove_button"],onChange:function(c){if(c.length>1){jQuery(this.$control[0]).find(".remove").removeClass("d-none")}else{jQuery(this.$control[0]).find(".remove").addClass("d-none")}},onInitialize:function(){if(this.items.length>1){jQuery(this.$control[0]).find(".remove").removeClass("d-none")}else{jQuery(this.$control[0]).find(".remove").addClass("d-none")}}})}},registerEvents:function(){Settings_Index_Js.initEvants();this.makeFieldsListSortable();this.registerModuleSequenceSaveClick()}};$(document).ready(function(){Settings_Index_Js.registerEvents()});