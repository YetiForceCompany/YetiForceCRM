'use strict';

/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */"use strict";var Settings_Index_Js={updatedBlockFieldsList:[],initEvants:function initEvants(){$(".SearchFieldsEdit .fieldname").on("change",Settings_Index_Js.save),$(".SearchFieldsEdit .searchcolumn").on("change",Settings_Index_Js.save),$(".SearchFieldsEdit .updateLabels").on("click",Settings_Index_Js.updateLabels),$(".SearchFieldsEdit .editLabels").on("click",Settings_Index_Js.editLabels),$(".SearchFieldsEdit .turn_off").on("click",Settings_Index_Js.replacement);},replacement:function replacement(e){var target=$(e.currentTarget);parseInt(target.val())?target.val(0).html("<span class=\"fas fa-power-off u-mr-5px\"></span>"+app.vtranslate("JS_TURN_ON")):target.val(1).html("<span class=\"fas fa-power-off u-mr-5px\"></span>"+app.vtranslate("JS_TURN_OFF")),target.toggleClass("btn-success btn-danger"),Settings_Index_Js.save(e);},updateLabels:function updateLabels(e){var target=$(e.currentTarget),closestTrElement=target.closest("tr");closestTrElement.hasClass("ui-sortable-handle")||(closestTrElement=closestTrElement.prev()),Settings_Index_Js.registerSaveEvent("updateLabels",{tabid:closestTrElement.data("tabid")});},editLabels:function editLabels(e){var tabId=$(e.currentTarget).data("tabid"),select=$(".elementEdit"+tabId).removeClass("d-none").find("[data-select-cb=\"registerSelectSortable\"]");$(".elementLabels"+tabId).addClass("d-none"),App.Fields.Picklist.showSelect2ElementView(select,{sortableCb:function sortableCb(currentSelect){Settings_Index_Js.registerSaveEvent("save",{name:currentSelect.attr("name"),value:currentSelect.val(),tabid:currentSelect.data("tabid")});}});},validate:function validate(e){var aDeferred=jQuery.Deferred(),target=$(e.currentTarget),isSelect=target.is("select");return isSelect&&!target.find(":selected").length?(target.validationEngine("showPrompt",app.vtranslate("JS_PLEASE_SELECT_ATLEAST_ONE_OPTION"),"error","topLeft",!0),aDeferred.reject()):isSelect?(target.validationEngine("hide"),aDeferred.resolve(target)):aDeferred.resolve(target),aDeferred.promise()},save:function save(e){Settings_Index_Js.validate(e).done(function(target){Settings_Index_Js.registerSaveEvent("save",{name:target.attr("name"),value:target.val(),tabid:target.data("tabid")});});},registerSaveEvent:function registerSaveEvent(mode,data){var progress=$.progressIndicator({message:app.vtranslate("Saving changes"),position:"html",blockInfo:{enabled:!0}}),params={};params.data={module:app.getModuleName(),parent:app.getParentModuleName(),action:"SaveAjax",mode:mode,params:data},params.async=!1,params.dataType="json",AppConnector.request(params).done(function(data){var response=data.result;app.showNotify({text:response.message,type:"success"}),progress.progressIndicator({mode:"hide"});}).fail(function(){progress.progressIndicator({mode:"hide"});});},/**
	 * Function to regiser the event to make the modules sortable
	 */makeFieldsListSortable:function makeFieldsListSortable(){var thisInstance=this,contents=jQuery(".SearchFieldsEdit").find(".contents"),table=contents.find("table");table.each(function(){jQuery(this).find("tbody").sortable({containment:"#modulesEntity",revert:!0,tolerance:"pointer",cursor:"move",helper:function helper(e,ui){return ui.children().each(function(index,element){element=jQuery(element),element.width(element.width());}),ui},update:function update(){thisInstance.showSaveModuleSequenceButton();}});});},/**
	 * Function to show the save button of moduleSequence
	 */showSaveModuleSequenceButton:function showSaveModuleSequenceButton(){var thisInstance=this,layout=jQuery(".SearchFieldsEdit"),saveButton=layout.find(".saveModuleSequence");thisInstance.updatedBlockFieldsList=[],saveButton.removeClass("d-none");},/**
	 * Function which will hide the saveModuleSequence button
	 */hideSaveModuleSequenceButton:function hideSaveModuleSequenceButton(){var layout=jQuery(".SearchFieldsEdit"),saveButton=layout.find(".saveModuleSequence");saveButton.addClass("d-none");},/**
	 * Function will save the field sequences
	 */updateModulesSequence:function updateModulesSequence(){var thisInstance=this,progressIndicatorElement=jQuery.progressIndicator({position:"html",blockInfo:{enabled:!0}}),params={};params.module=app.getModuleName(),params.parent=app.getParentModuleName(),params.action="SaveAjax",params.mode="saveSequenceNumber",params.updatedFields=thisInstance.updatedBlockFieldsList,AppConnector.request(params).done(function(){progressIndicatorElement.progressIndicator({mode:"hide"});var params={};params.text=app.vtranslate("JS_MODULES_SEQUENCE_UPDATED"),Settings_Vtiger_Index_Js.showMessage(params);}).fail(function(){progressIndicatorElement.progressIndicator({mode:"hide"});});},/**
	 * Function to create the list of updated modules and their sequences
	 */createUpdatedSequenceModulesList:function createUpdatedSequenceModulesList(){var thisInstance=this,contents=jQuery(".SearchFieldsEdit").find(".contents"),updatedModules=contents.find("tbody"),editModules=updatedModules.find("tr"),expectedModuleSequence=1;editModules.each(function(i,domElement){var moduleEle=jQuery(domElement),moduleId=moduleEle.data("tabid");thisInstance.updatedBlockFieldsList.push({tabid:moduleId,sequence:expectedModuleSequence}),++expectedModuleSequence;});},/**
	 * Function to register click event for save button of modules sequence
	 */registerModuleSequenceSaveClick:function registerModuleSequenceSaveClick(){var thisInstance=this,layout=jQuery(".SearchFieldsEdit");layout.on("click",".saveModuleSequence",function(){thisInstance.hideSaveModuleSequenceButton(),thisInstance.createUpdatedSequenceModulesList(),thisInstance.updateModulesSequence();});},registerEvents:function registerEvents(){Settings_Index_Js.initEvants(),this.makeFieldsListSortable(),this.registerModuleSequenceSaveClick();}};jQuery(function(){Settings_Index_Js.registerEvents();});
//# sourceMappingURL=Search.min.js.map
