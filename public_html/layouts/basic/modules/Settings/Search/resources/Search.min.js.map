{"version":3,"file":"Search.min.js","sources":["Search.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nvar Settings_Index_Js = {\n\tupdatedBlockFieldsList: [],\n\tinitEvants: function () {\n\t\t$('.SearchFieldsEdit .fieldname').on('change', Settings_Index_Js.save);\n\t\t$('.SearchFieldsEdit .searchcolumn').on('change', Settings_Index_Js.save);\n\t\t$('.SearchFieldsEdit .updateLabels').on('click', Settings_Index_Js.updateLabels);\n\t\t$('.SearchFieldsEdit .editLabels').on('click', Settings_Index_Js.editLabels);\n\t\t$('.SearchFieldsEdit .turn_off').on('click', Settings_Index_Js.replacement);\n\t},\n\treplacement: function (e) {\n\t\tvar target = $(e.currentTarget);\n\t\tif (parseInt(target.val())) {\n\t\t\ttarget.val(0).html('<span class=\"fas fa-power-off u-mr-5px\"></span>' + app.vtranslate('JS_TURN_ON'));\n\t\t} else {\n\t\t\ttarget.val(1).html('<span class=\"fas fa-power-off u-mr-5px\"></span>' + app.vtranslate('JS_TURN_OFF'));\n\t\t}\n\t\ttarget.toggleClass('btn-success btn-danger');\n\t\tSettings_Index_Js.save(e);\n\t},\n\tupdateLabels: function (e) {\n\t\tvar target = $(e.currentTarget);\n\t\tvar closestTrElement = target.closest('tr');\n\t\tif (!closestTrElement.hasClass('ui-sortable-handle')) {\n\t\t\tclosestTrElement = closestTrElement.prev();\n\t\t}\n\t\tSettings_Index_Js.registerSaveEvent('updateLabels', {\n\t\t\ttabid: closestTrElement.data('tabid')\n\t\t});\n\t},\n\teditLabels: function (e) {\n\t\tlet tabId = $(e.currentTarget).data('tabid'),\n\t\t\tselect = $('.elementEdit' + tabId)\n\t\t\t\t.removeClass('d-none')\n\t\t\t\t.find('[data-select-cb=\"registerSelectSortable\"]');\n\n\t\t$('.elementLabels' + tabId).addClass('d-none');\n\t\tApp.Fields.Picklist.showSelect2ElementView(select, {\n\t\t\tsortableCb: (currentSelect) => {\n\t\t\t\tSettings_Index_Js.registerSaveEvent('save', {\n\t\t\t\t\tname: currentSelect.attr('name'),\n\t\t\t\t\tvalue: currentSelect.val(),\n\t\t\t\t\ttabid: currentSelect.data('tabid')\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t},\n\tsave: function (e) {\n\t\tvar target = $(e.currentTarget);\n\t\tSettings_Index_Js.registerSaveEvent('save', {\n\t\t\tname: target.attr('name'),\n\t\t\tvalue: target.val(),\n\t\t\ttabid: target.data('tabid')\n\t\t});\n\t},\n\tregisterSaveEvent: function (mode, data) {\n\t\tvar progress = $.progressIndicator({\n\t\t\tmessage: app.vtranslate('Saving changes'),\n\t\t\tposition: 'html',\n\t\t\tblockInfo: {\n\t\t\t\tenabled: true\n\t\t\t}\n\t\t});\n\t\tvar resp = '';\n\t\tvar params = {};\n\t\tparams.data = {\n\t\t\tmodule: app.getModuleName(),\n\t\t\tparent: app.getParentModuleName(),\n\t\t\taction: 'SaveAjax',\n\t\t\tmode: mode,\n\t\t\tparams: data\n\t\t};\n\t\tparams.async = false;\n\t\tparams.dataType = 'json';\n\t\tAppConnector.request(params)\n\t\t\t.done(function (data) {\n\t\t\t\tvar response = data['result'];\n\t\t\t\tvar params = {\n\t\t\t\t\ttext: response['message'],\n\t\t\t\t\ttype: 'success'\n\t\t\t\t};\n\t\t\t\tapp.showNotify(params);\n\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t})\n\t\t\t.fail(function (data, err) {\n\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t});\n\t},\n\t/**\n\t * Function to regiser the event to make the modules sortable\n\t */\n\tmakeFieldsListSortable: function () {\n\t\tvar thisInstance = this;\n\t\tvar contents = jQuery('.SearchFieldsEdit').find('.contents');\n\t\tvar table = contents.find('table');\n\n\t\ttable.each(function () {\n\t\t\tjQuery(this)\n\t\t\t\t.find('tbody')\n\t\t\t\t.sortable({\n\t\t\t\t\tcontainment: '#modulesEntity',\n\t\t\t\t\trevert: true,\n\t\t\t\t\ttolerance: 'pointer',\n\t\t\t\t\tcursor: 'move',\n\t\t\t\t\thelper: function (e, ui) {\n\t\t\t\t\t\t//while dragging helper elements td element will take width as contents width\n\t\t\t\t\t\t//so we are explicitly saying that it has to be same width so that element will not\n\t\t\t\t\t\t//look like disturbed\n\t\t\t\t\t\tui.children().each(function (index, element) {\n\t\t\t\t\t\t\telement = jQuery(element);\n\t\t\t\t\t\t\telement.width(element.width());\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn ui;\n\t\t\t\t\t},\n\t\t\t\t\tupdate: function (e, ui) {\n\t\t\t\t\t\tthisInstance.showSaveModuleSequenceButton();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function to show the save button of moduleSequence\n\t */\n\tshowSaveModuleSequenceButton: function () {\n\t\tvar thisInstance = this;\n\t\tvar layout = jQuery('.SearchFieldsEdit');\n\t\tvar saveButton = layout.find('.saveModuleSequence');\n\t\tthisInstance.updatedBlockFieldsList = [];\n\t\tsaveButton.removeClass('d-none');\n\t},\n\t/**\n\t * Function which will hide the saveModuleSequence button\n\t */\n\thideSaveModuleSequenceButton: function () {\n\t\tvar layout = jQuery('.SearchFieldsEdit');\n\t\tvar saveButton = layout.find('.saveModuleSequence');\n\t\tsaveButton.addClass('d-none');\n\t},\n\t/**\n\t * Function will save the field sequences\n\t */\n\tupdateModulesSequence: function () {\n\t\tvar thisInstance = this;\n\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\tposition: 'html',\n\t\t\tblockInfo: {\n\t\t\t\tenabled: true\n\t\t\t}\n\t\t});\n\t\tvar params = {};\n\t\tparams['module'] = app.getModuleName();\n\t\tparams['parent'] = app.getParentModuleName();\n\t\tparams['action'] = 'SaveAjax';\n\t\tparams['mode'] = 'saveSequenceNumber';\n\t\tparams['updatedFields'] = thisInstance.updatedBlockFieldsList;\n\n\t\tAppConnector.request(params)\n\t\t\t.done(function (data) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\tvar params = {};\n\t\t\t\tparams['text'] = app.vtranslate('JS_MODULES_SEQUENCE_UPDATED');\n\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t})\n\t\t\t.fail(function (error) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t});\n\t},\n\t/**\n\t * Function to create the list of updated modules and their sequences\n\t */\n\tcreateUpdatedSequenceModulesList: function () {\n\t\tvar thisInstance = this;\n\t\tvar contents = jQuery('.SearchFieldsEdit').find('.contents');\n\n\t\tvar updatedModules = contents.find('tbody');\n\t\tvar editModules = updatedModules.find('tr');\n\t\tvar expectedModuleSequence = 1;\n\t\teditModules.each(function (i, domElement) {\n\t\t\tvar moduleEle = jQuery(domElement);\n\t\t\tvar moduleId = moduleEle.data('tabid');\n\t\t\tthisInstance.updatedBlockFieldsList.push({\n\t\t\t\ttabid: moduleId,\n\t\t\t\tsequence: expectedModuleSequence\n\t\t\t});\n\t\t\texpectedModuleSequence = expectedModuleSequence + 1;\n\t\t});\n\t},\n\t/**\n\t * Function to register click event for save button of modules sequence\n\t */\n\tregisterModuleSequenceSaveClick: function () {\n\t\tvar thisInstance = this;\n\t\tvar layout = jQuery('.SearchFieldsEdit');\n\t\tlayout.on('click', '.saveModuleSequence', function () {\n\t\t\tthisInstance.hideSaveModuleSequenceButton();\n\t\t\tthisInstance.createUpdatedSequenceModulesList();\n\t\t\tthisInstance.updateModulesSequence();\n\t\t});\n\t},\n\tregisterEvents: function () {\n\t\tSettings_Index_Js.initEvants();\n\t\tthis.makeFieldsListSortable();\n\t\tthis.registerModuleSequenceSaveClick();\n\t}\n};\n$(document).ready(function () {\n\tSettings_Index_Js.registerEvents();\n});\n"],"names":["updatedBlockFieldsList","initEvants","$","on","Settings_Index_Js","save","updateLabels","editLabels","replacement","e","currentTarget","parseInt","target","val","html","app","vtranslate","toggleClass","closestTrElement","closest","hasClass","prev","registerSaveEvent","tabid","data","select","tabId","removeClass","find","addClass","App","Fields","Picklist","showSelect2ElementView","sortableCb","currentSelect","name","attr","value","mode","progressIndicator","message","position","blockInfo","enabled","params","module","getModuleName","parent","getParentModuleName","action","async","dataType","AppConnector","request","done","text","response","type","showNotify","progress","fail","makeFieldsListSortable","contents","jQuery","table","each","sortable","containment","revert","tolerance","cursor","helper","ui","children","index","element","width","update","thisInstance","showSaveModuleSequenceButton","layout","saveButton","hideSaveModuleSequenceButton","updateModulesSequence","progressIndicatorElement","Settings_Vtiger_Index_Js","showMessage","createUpdatedSequenceModulesList","updatedModules","editModules","expectedModuleSequence","i","domElement","moduleId","moduleEle","push","sequence","registerModuleSequenceSaveClick","registerEvents","document","ready"],"mappings":"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"}