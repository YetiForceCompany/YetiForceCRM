
Settings_Vtiger_Index_Js("Settings_Colors_Index_Js", {}, {registerEvents:function(){this.registerModuleTabEvent(); this.registerModuleChangeEvent(); this.registerModulePickListChangeEvent(); this.initEvants()}, initEvants:function(){var b = this; var a = $(".UserColors"); a.find(".updateUserColor").click(function(c){b.updateUserColor(c, b)}); a.find(".generateUserColor").click(this.generateUserColor); a.find(".removeUserColor").click(this.removeUserColor); a.find(".updateGroupColor").click(function(c){b.updateGroupColor(c, b)}); a.find(".generateGroupColor").click(this.generateGroupColor); a.find(".removeGroupColor").click(this.removeGroupColor); a.find(".updateModuleColor").click(function(c){b.updateModuleColor(c, b)}); a.find(".generateModuleColor").click(this.generateModuleColor); a.find(".removeModuleColor").click(this.removeModuleColor); a.find(".activeModuleColor").click(this.activeModuleColor); a.find(".addPicklistColorColumn").click(this.addPicklistColorColumn); a.find(".updatePicklistValueColor").click(function(c){b.updatePicklistValueColor(c, b)}); a.find(".generatePicklistValueColor").click(this.generatePicklistValueColor); a.find(".removePicklistValueColor").click(this.removePicklistValueColor); a.find(".updateColor").click(function(c){b.updateCalendarColor(c, b)}); a.find("#update_event").click(this.updateEvent); a.find(".generateColor").click(this.generateCalendarColor); a.find(".removeCalendarColor").click(this.removeCalendarColor)}, registerColorPicker:function(b, a, d){var c = {inline:true, container:true, color:a.data("color")}; if (typeof customParams != "undefined"){c = jQuery.extend(c, customParams)}b.find(".calendarColorPicker").colorpicker(c).on("changeColor", function(f){d.val(f.color.toHex()); if (!a.contents().length){a.data("color", f.color.toHex())}})}, updateUserColor:function(h, f){var g = $(h.currentTarget); var a = jQuery(".UserColors .editColorContainer"); var b = a.clone(true, true); var d = $("#calendarColorPreviewUser" + g.data("record")); var c = function(e){e.find(".editColorContainer").removeClass("hide").show(); var i = e.find(".selectedColor"); i.val(d.data("color")); f.registerColorPicker(e, d, i); e.find('[name="saveButton"]').click(function(k){var j = $.progressIndicator({message:app.vtranslate("JS_LOADING_PLEASE_WAIT"), blockInfo:{enabled:true}}); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"updateUserColor", color:i.val(), record:g.data("record")}).then(function(l){Vtiger_Helper_Js.showPnotify({text:l.result["message"], animation:"show", type:"success"}); return l.result}); d.css("background", i.val()); g.data("color", i.val()); j.progressIndicator({mode:"hide"}); app.hideModalWindow()})}; app.showModalWindow(b, function(e){if (typeof c == "function"){c(e)}}, {width:"1000px"})}, generateUserColor:function(c){var b = $(c.currentTarget); var a = $("#calendarColorPreviewUser" + b.data("record")); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"updateUserColor", record:b.data("record")}).then(function(d){a.css("background", d.result.color); a.data("color", d.result.color); Vtiger_Helper_Js.showPnotify({text:d.result["message"], animation:"show", type:"success"})})}, removeUserColor:function(c){var b = $(c.currentTarget); var a = $("#calendarColorPreviewUser" + b.data("record")); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"removeUserColor", record:b.data("record")}).then(function(d){a.css("background", ""); a.data("color", ""); Vtiger_Helper_Js.showPnotify({text:d.result["message"], animation:"show", type:"success"})})}, updateGroupColor:function(h, f){var g = $(h.currentTarget); var a = jQuery(".UserColors .editColorContainer"); var b = a.clone(true, true); var d = $("#calendarColorPreviewGroup" + g.data("record")); var c = function(e){e.find(".editColorContainer").removeClass("hide").show(); var i = e.find(".selectedColor"); i.val(d.data("color")); f.registerColorPicker(e, d, i); e.find('[name="saveButton"]').click(function(k){var j = $.progressIndicator({message:app.vtranslate("JS_LOADING_PLEASE_WAIT"), blockInfo:{enabled:true}}); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"updateGroupColor", color:i.val(), record:g.data("record")}).then(function(l){Vtiger_Helper_Js.showPnotify({text:l.result["message"], animation:"show", type:"success"}); return l.result}); d.css("background", i.val()); g.data("color", i.val()); j.progressIndicator({mode:"hide"}); app.hideModalWindow()})}; app.showModalWindow(b, function(e){if (typeof c == "function"){c(e)}}, {width:"1000px"})}, generateGroupColor:function(c){var b = $(c.currentTarget); var a = $("#calendarColorPreviewGroup" + b.data("record")); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"updateGroupColor", record:b.data("record")}).then(function(d){a.css("background", d.result.color); a.data("color", d.result.color); Vtiger_Helper_Js.showPnotify({text:d.result["message"], animation:"show", type:"success"})})}, removeGroupColor:function(c){var b = $(c.currentTarget); var a = $("#calendarColorPreviewGroup" + b.data("record")); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"removeGroupColor", record:b.data("record")}).then(function(d){a.css("background", ""); a.data("color", ""); Vtiger_Helper_Js.showPnotify({text:d.result["message"], animation:"show", type:"success"})})}, updateModuleColor:function(h, f){var g = $(h.currentTarget); var a = jQuery(".UserColors .editColorContainer"); var b = a.clone(true, true); var d = $("#calendarColorPreviewModule" + g.data("record")); var c = function(e){e.find(".editColorContainer").removeClass("hide").show(); var i = e.find(".selectedColor"); i.val(d.data("color")); f.registerColorPicker(e, d, i); e.find('[name="saveButton"]').click(function(k){var j = $.progressIndicator({message:app.vtranslate("JS_LOADING_PLEASE_WAIT"), blockInfo:{enabled:true}}); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"updateModuleColor", color:i.val(), record:g.data("record")}).then(function(l){Vtiger_Helper_Js.showPnotify({text:l.result["message"], animation:"show", type:"success"}); return l.result}); d.css("background", i.val()); g.data("color", i.val()); j.progressIndicator({mode:"hide"}); app.hideModalWindow()})}; app.showModalWindow(b, function(e){if (typeof c == "function"){c(e)}}, {width:"1000px"})}, generateModuleColor:function(c){var b = $(c.currentTarget); var a = $("#calendarColorPreviewModule" + b.data("record")); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"updateModuleColor", record:b.data("record")}).then(function(d){a.css("background", d.result.color); a.data("color", d.result.color); Vtiger_Helper_Js.showPnotify({text:d.result["message"], animation:"show", type:"success"})})}, removeModuleColor:function(c){var b = $(c.currentTarget); var a = $("#calendarColorPreviewModule" + b.data("record")); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"removeModuleColor", record:b.data("record")}).then(function(d){a.css("background", ""); a.data("color", ""); Vtiger_Helper_Js.showPnotify({text:d.result["message"], animation:"show", type:"success"})})}, activeModuleColor:function(c){var b = $(c.currentTarget); var a = $("#calendarColorPreviewModule" + b.data("record")); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"activeModuleColor", status:b.is(":checked"), color:a.data("color"), record:b.data("record")}).then(function(d){Vtiger_Helper_Js.showPnotify({text:d.result["message"], animation:"show", type:"success"}); a.css("background", d.result.color); a.data("color", d.result.color)})}, addPicklistColorColumn:function(c){var a = jQuery(".picklistViewContentDiv"); var b = $(c.currentTarget); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"addPicklistColorColumn", picklistModule:b.data("fieldmodule"), fieldId:b.data("fieldid")}).then(function(d){Vtiger_Helper_Js.showPnotify({text:d.result["message"], animation:"show", type:"success"}); a.find(".modulePickList").trigger("change")})}, updatePicklistValueColor:function(i, g){var b = jQuery(".picklistViewContentDiv"); var h = $(i.currentTarget); var a = jQuery(".UserColors .editColorContainer"); var c = a.clone(true, true); var f = b.find("#calendarColorPreviewPicklistValue" + h.data("fieldvalueid")); var d = function(e){e.find(".editColorContainer").removeClass("hide").show(); var j = e.find(".selectedColor"); j.val(f.data("color")); g.registerColorPicker(e, f, j); e.find('[name="saveButton"]').click(function(l){var k = $.progressIndicator({message:app.vtranslate("JS_LOADING_PLEASE_WAIT"), blockInfo:{enabled:true}}); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"updatePicklistValueColor", color:j.val(), fieldId:h.data("fieldid"), fieldValueId:h.data("fieldvalueid")}).then(function(m){Vtiger_Helper_Js.showPnotify({text:m.result["message"], animation:"show", type:"success"}); return m.result}); f.css("background", j.val()); h.data("color", j.val()); k.progressIndicator({mode:"hide"}); app.hideModalWindow()})}; app.showModalWindow(c, function(e){if (typeof d == "function"){d(e)}}, {width:"1000px"})}, generatePicklistValueColor:function(f){var a = jQuery(".picklistViewContentDiv"); var d = $(f.currentTarget); var c = a.find("#calendarColorPreviewPicklistValue" + d.data("fieldvalueid")); var b = $.progressIndicator({message:app.vtranslate("JS_LOADING_PLEASE_WAIT"), blockInfo:{enabled:true}}); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"updatePicklistValueColor", fieldId:d.data("fieldid"), fieldValueId:d.data("fieldvalueid")}).then(function(e){c.css("background", e.result.color); c.data("color", e.result.color); Vtiger_Helper_Js.showPnotify({text:e.result["message"], animation:"show", type:"success"})}); b.progressIndicator({mode:"hide"}); app.hideModalWindow()}, removePicklistValueColor:function(f){var a = jQuery(".picklistViewContentDiv"); var d = $(f.currentTarget); var c = a.find("#calendarColorPreviewPicklistValue" + d.data("fieldvalueid")); var b = $.progressIndicator({message:app.vtranslate("JS_LOADING_PLEASE_WAIT"), blockInfo:{enabled:true}}); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"removePicklistValueColor", fieldId:d.data("fieldid"), fieldValueId:d.data("fieldvalueid")}).then(function(e){c.css("background", ""); c.data("color", ""); Vtiger_Helper_Js.showPnotify({text:e.result["message"], animation:"show", type:"success"})}); b.progressIndicator({mode:"hide"}); app.hideModalWindow()}, generateCalendarColor:function(c){var b = $(c.currentTarget); var a = b.closest("tr"); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"updateCalendarColor", id:a.data("id"), table:a.data("table"), field:a.data("field")}).then(function(d){Settings_Colors_Index_Js.showMessage({type:"success", text:d.result.message}); a.find(".calendarColor").css("background", d.result.color); a.data("color", d.result.color)})}, updateCalendarColor:function(h, f){var g = $(h.currentTarget); var c = g.closest("tr"); var a = jQuery(".UserColors .editColorContainer"); var b = a.clone(true, true); var d = function(e){e.find(".editColorContainer").removeClass("hide").show(); var i = e.find(".selectedColor"); i.val(c.data("color")); f.registerColorPicker(e, c, i); e.find('[name="saveButton"]').click(function(k){var j = $.progressIndicator({message:app.vtranslate("Update labels"), blockInfo:{enabled:true}}); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"updateCalendarColor", color:i.val(), id:c.data("id"), table:c.data("table"), field:c.data("field")}).then(function(l){Vtiger_Helper_Js.showPnotify({text:l.result["message"], animation:"show", type:"success"}); return l.result}); c.find(".calendarColor").css("background", i.val()); c.data("color", i.val()); j.progressIndicator({mode:"hide"}); app.hideModalWindow()})}; app.showModalWindow(b, function(e){if (typeof d == "function"){d(e)}}, {width:"1000px"})}, removeCalendarColor:function(f){var a = jQuery("#calendarColors"); var d = $(f.currentTarget); var c = a.find("#calendarColorPreviewCalendar" + d.data("record")); var b = $.progressIndicator({message:app.vtranslate("JS_LOADING_PLEASE_WAIT"), blockInfo:{enabled:true}}); AppConnector.request({module:"Colors", parent:"Settings", action:"SaveAjax", mode:"removeCalendarColor", id:d.data("record")}).then(function(e){c.css("background", ""); c.data("color", ""); Vtiger_Helper_Js.showPnotify({text:e.result["message"], animation:"show", type:"success"})}); b.progressIndicator({mode:"hide"}); app.hideModalWindow()}, registerModuleTabEvent:function(){var a = this; jQuery("#picklistsColorsTab").on("click", function(c){var b = jQuery.progressIndicator({position:"html", blockInfo:{enabled:true}}); AppConnector.request({module:"Colors", parent:app.getParentModuleName(), view:"IndexAjax", mode:"getPickListView"}).then(function(e){var d = jQuery(".picklistViewContentDiv"); d.html(e); b.progressIndicator({mode:"hide"}); app.changeSelectElementView(jQuery(".pickListModulesSelectContainer")); a.registerModuleChangeEvent(); d.find(".modulePickList").trigger("change")})})}, registerModuleChangeEvent:function(){var b = this; var a = jQuery(".picklistViewContentDiv"); a.find(".pickListModules").on("change", function(f){var c = jQuery(f.currentTarget).val(); if (c.length <= 0){jQuery("#picklistsColorsTab").trigger("click"); return false}var d = jQuery.progressIndicator({position:"html", blockInfo:{enabled:true}}); AppConnector.request({module:"Colors", parent:app.getParentModuleName(), source_module:c, view:"IndexAjax", mode:"getPickListView"}).then(function(e){a.html(e); d.progressIndicator({mode:"hide"}); app.changeSelectElementView(jQuery(".pickListModulesSelectContainer")); app.changeSelectElementView(jQuery(".pickListModulesPicklistSelectContainer")); b.registerModuleChangeEvent(); b.registerModulePickListChangeEvent(); jQuery("#modulePickList").trigger("change")})})}, registerModulePickListChangeEvent:function(){var b = this; var a = jQuery(".picklistViewContentDiv"); a.find(".modulePickList").on("change", function(d){var c = jQuery.progressIndicator({position:"html", blockInfo:{enabled:true}}); AppConnector.request({module:"Colors", parent:app.getParentModuleName(), source_module:jQuery("#pickListModules").val(), view:"IndexAjax", mode:"getPickListView", fieldId:jQuery(d.currentTarget).val()}).then(function(e){a.html(e); app.changeSelectElementView(jQuery(".pickListModulesSelectContainer")); app.changeSelectElementView(jQuery(".pickListModulesPicklistSelectContainer")); b.registerModuleChangeEvent(); b.registerModulePickListChangeEvent(); $(".UserColors .addPicklistColorColumn").click(b.addPicklistColorColumn); $(".UserColors .updatePicklistValueColor").click(function(f){b.updatePicklistValueColor(f, b)}); $(".UserColors .generatePicklistValueColor").click(b.generatePicklistValueColor); $(".UserColors .removePicklistValueColor").click(b.removePicklistValueColor); c.progressIndicator({mode:"hide"})})})}});
