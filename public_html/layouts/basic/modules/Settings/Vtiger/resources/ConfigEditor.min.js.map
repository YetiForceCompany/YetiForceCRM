{"version":3,"file":"ConfigEditor.min.js","sources":["ConfigEditor.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\njQuery.Class(\"Settings_Vtiger_ConfigEditor_Js\", {}, {\n\n\t/*\n\t * Function to save the Configuration Editor content\n\t */\n\tsaveConfigEditor: function (form) {\n\t\tvar aDeferred = jQuery.Deferred();\n\n\t\tlet params = form.serializeFormData();\n\t\tparams.module = app.getModuleName();\n\t\tparams.parent = app.getParentModuleName();\n\t\tparams.action = 'ConfigEditorSaveAjax';\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (error, err) {\n\t\t\taDeferred.reject(error, err);\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\n\t/*\n\t * Function to load the contents from the url through pjax\n\t */\n\tloadContents: function (url) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tAppConnector.requestPjax(url).done(function (data) {\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (error, err) {\n\t\t\taDeferred.reject();\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\n\t/*\n\t * function to register the events in editView\n\t */\n\tregisterEditViewEvents: function () {\n\t\tvar thisInstance = this;\n\t\tvar form = jQuery('#ConfigEditorForm');\n\t\tvar detailUrl = form.data('detailUrl');\n\n\t\t//register all select2 Elements\n\t\tApp.Fields.Picklist.showSelect2ElementView(form.find('select.select2'), {dropdownCss: {'z-index': 0}});\n\n\t\t//register validation engine\n\t\tvar params = app.validationEngineOptions;\n\t\tparams.onValidationComplete = function (form, valid) {\n\t\t\tif (valid) {\n\t\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t\t'position': 'html',\n\t\t\t\t\t'blockInfo': {\n\t\t\t\t\t\t'enabled': true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthisInstance.saveConfigEditor(form).done(function (data) {\n\t\t\t\t\tvar params = {};\n\t\t\t\t\tif (data['success']) {\n\t\t\t\t\t\tparams['text'] = app.vtranslate('JS_CONFIGURATION_DETAILS_SAVED');\n\t\t\t\t\t\tthisInstance.loadContents(detailUrl).done(function (data) {\n\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t\t\t\tjQuery('.contentsDiv').html(data);\n\t\t\t\t\t\t\tthisInstance.registerDetailViewEvents();\n\t\t\t\t\t\t});\n\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t\t}\n\t\t\t\t}).fail(function (error, err) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t});\n\t\t\t\treturn valid;\n\t\t\t}\n\t\t}\n\t\tform.validationEngine(params);\n\n\t\tform.on('submit', function (e) {\n\t\t\te.preventDefault();\n\t\t})\n\n\t\t//Register click event for cancel link\n\t\tvar cancelLink = form.find('.cancelLink');\n\t\tcancelLink.on('click', function () {\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tthisInstance.loadContents(detailUrl).done(function (data) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'})\n\t\t\t\tjQuery('.contentsDiv').html(data);\n\t\t\t\tthisInstance.registerDetailViewEvents();\n\t\t\t});\n\t\t});\n\t},\n\n\t/*\n\t * function to register the events in DetailView\n\t */\n\tregisterDetailViewEvents: function () {\n\t\tvar thisInstance = this;\n\t\tvar container = jQuery('#ConfigEditorDetails');\n\t\tvar editButton = container.find('.editButton');\n\n\t\t//Register click event for edit button\n\t\teditButton.on('click', function () {\n\t\t\tvar url = editButton.data('url');\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tthisInstance.loadContents(url).done(function (data) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\tjQuery('.contentsDiv').html(data);\n\t\t\t\tthisInstance.registerEditViewEvents();\n\t\t\t}).fail(function (error, err) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t});\n\t\t});\n\t},\n\n\tregisterEvents: function () {\n\t\tif (jQuery('#ConfigEditorDetails').length > 0) {\n\t\t\tthis.registerDetailViewEvents();\n\t\t} else {\n\t\t\tthis.registerEditViewEvents();\n\t\t}\n\t}\n\n});\n\njQuery(document).ready(function (e) {\n\tvar tacInstance = new Settings_Vtiger_ConfigEditor_Js();\n\ttacInstance.registerEvents();\n})\nVtiger_WholeNumberGreaterThanZero_Validator_Js(\"Vtiger_NumberRange100_Validator_Js\", {\n\n\t/**\n\t *Function which invokes field validation\n\t *@param accepts field element as parameter\n\t * @return error if validation fails true on success\n\t */\n\tinvokeValidation: function (field, rules, i, options) {\n\t\tvar rangeInstance = new Vtiger_NumberRange100_Validator_Js();\n\t\trangeInstance.setElement(field);\n\t\tvar response = rangeInstance.validate();\n\t\tif (response != true) {\n\t\t\treturn rangeInstance.getError();\n\t\t}\n\t}\n\n}, {\n\t/**\n\t * Function to validate the percentage field data\n\t * @return true if validation is successfull\n\t * @return false if validation error occurs\n\t */\n\tvalidate: function () {\n\t\tvar response = this._super();\n\t\tif (response != true) {\n\t\t\treturn response;\n\t\t} else {\n\t\t\tvar fieldValue = this.getFieldValue();\n\t\t\tif (fieldValue < 1 || fieldValue > 100) {\n\t\t\t\tvar errorInfo = app.vtranslate('JS_PLEASE_ENTER_NUMBER_IN_RANGE_1TO100');\n\t\t\t\tthis.setError(errorInfo);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t}\n\n})\n"],"names":["jQuery","Class","saveConfigEditor","form","Deferred","params","serializeFormData","module","app","getModuleName","parent","getParentModuleName","action","AppConnector","request","done","data","aDeferred","resolve","fail","error","err","reject","promise","loadContents","url","requestPjax","registerEditViewEvents","detailUrl","App","Fields","Picklist","showSelect2ElementView","find","dropdownCss","validationEngineOptions","onValidationComplete","valid","progressIndicator","vtranslate","thisInstance","progressIndicatorElement","html","registerDetailViewEvents","Settings_Vtiger_Index_Js","showMessage","validationEngine","on","e","preventDefault","cancelLink","container","editButton","registerEvents","length","document","ready","tacInstance","Vtiger_WholeNumberGreaterThanZero_Validator_Js","invokeValidation","field","rangeInstance","setElement","validate","getError","_super","getFieldValue","setError","errorInfo"],"mappings":"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"}