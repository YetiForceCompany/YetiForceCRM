'use strict';

jQuery.Class('Settings_Vtiger_ConfigEditor_Js',{},{saveConfigEditor:function saveConfigEditor(form){var aDeferred=jQuery.Deferred(),params=form.serializeFormData();return params.module=app.getModuleName(),params.parent=app.getParentModuleName(),params.action='ConfigEditorSaveAjax',AppConnector.request(params).done(function(data){aDeferred.resolve(data);}).fail(function(error,err){aDeferred.reject(error,err);}),aDeferred.promise()},loadContents:function loadContents(url){var aDeferred=jQuery.Deferred();return AppConnector.requestPjax(url).done(function(data){aDeferred.resolve(data);}).fail(function(){aDeferred.reject();}),aDeferred.promise()},registerEditViewEvents:function registerEditViewEvents(){var thisInstance=this,form=jQuery('#ConfigEditorForm'),detailUrl=form.data('detailUrl');App.Fields.Picklist.showSelect2ElementView(form.find('select.select2'),{dropdownCss:{"z-index":0}});var params=app.validationEngineOptions;params.onValidationComplete=function(form,valid){if(valid){var progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});return thisInstance.saveConfigEditor(form).done(function(data){var params={};data.success?(params.text=app.vtranslate('JS_CONFIGURATION_DETAILS_SAVED'),thisInstance.loadContents(detailUrl).done(function(data){progressIndicatorElement.progressIndicator({mode:'hide'}),jQuery('.contentsDiv').html(data),thisInstance.registerDetailViewEvents();}),Settings_Vtiger_Index_Js.showMessage(params)):progressIndicatorElement.progressIndicator({mode:'hide'});}).fail(function(){progressIndicatorElement.progressIndicator({mode:'hide'});}),valid}},form.validationEngine(params),form.on('submit',function(e){e.preventDefault();});var cancelLink=form.find('.cancelLink');cancelLink.on('click',function(){var progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});thisInstance.loadContents(detailUrl).done(function(data){progressIndicatorElement.progressIndicator({mode:'hide'}),jQuery('.contentsDiv').html(data),thisInstance.registerDetailViewEvents();});});},registerDetailViewEvents:function registerDetailViewEvents(){var thisInstance=this,container=jQuery('#ConfigEditorDetails'),editButton=container.find('.editButton');editButton.on('click',function(){var url=editButton.data('url'),progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});thisInstance.loadContents(url).done(function(data){progressIndicatorElement.progressIndicator({mode:'hide'}),jQuery('.contentsDiv').html(data),thisInstance.registerEditViewEvents();}).fail(function(){progressIndicatorElement.progressIndicator({mode:'hide'});});});},registerEvents:function registerEvents(){0<jQuery('#ConfigEditorDetails').length?this.registerDetailViewEvents():this.registerEditViewEvents();}}),jQuery(document).ready(function(){var tacInstance=new Settings_Vtiger_ConfigEditor_Js;tacInstance.registerEvents();}),Vtiger_WholeNumberGreaterThanZero_Validator_Js('Vtiger_NumberRange100_Validator_Js',{invokeValidation:function invokeValidation(field){var rangeInstance=new Vtiger_NumberRange100_Validator_Js;rangeInstance.setElement(field);var response=rangeInstance.validate();if(!0!=response)return rangeInstance.getError()}},{validate:function validate(){var response=this._super();if(!0!=response)return response;var fieldValue=this.getFieldValue();if(1>fieldValue||100<fieldValue){var errorInfo=app.vtranslate('JS_PLEASE_ENTER_NUMBER_IN_RANGE_1TO100');return this.setError(errorInfo),!1}return !0}});
//# sourceMappingURL=ConfigEditor.min.js.map
