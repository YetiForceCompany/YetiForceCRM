'use strict';

jQuery.Class('Settings_Notifications_Configuration_Js',{},{container:!1,registerModulesChangeEvent:function c(a){var b=this;a.find('#supportedModule').on('change',function(c){var d=b.progress(),e={};e.module=app.getModuleName(),e.parent=app.getParentModuleName(),e.view=app.getViewName(),e.srcModule=jQuery(c.currentTarget).val(),AppConnector.requestPjax(e).done(function(c){d.progressIndicator({mode:'hide'}),a.html(c),App.Fields.Picklist.changeSelectElementView(a),b.registerEvents();}).fail(function(a,b){d.progressIndicator({mode:'hide'}),app.errorLog(a,b);});});},progress:function a(){return jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}})},registerButtonEvents:function c(a){var b=this;a.find('.wrapperTrash, .wrapperLock').on('click','[data-fa-i2svg]',function(c){var d=b.progress(),e=jQuery(c.currentTarget),f=e.data('mode'),g=e.closest('tr'),h={members:g.data('value'),srcModule:a.find('#supportedModule').val()};'lock'===f&&(h.lock=0===g.data('lock')?1:0),app.saveAjax(f,null,h).done(function(){d.progressIndicator({mode:'hide'}),b.refreshView();});}),a.find('.addUser, .wrapperExceptions').on('click',function(c){c.stopPropagation(),c.preventDefault();var d=!0,e=jQuery(c.currentTarget),f='index.php?module='+app.getModuleName()+'&parent='+app.getParentModuleName()+'&srcModule='+a.find('#supportedModule').val()+'&view=Members';e.hasClass('wrapperExceptions')&&(f+='&mode='+e.data('mode')+'&member='+e.closest('tr').data('value'),d=!1),app.showModalWindow(null,f,function(a){var c=a.find('form');c.on('submit',function(a){a.preventDefault();var e=b.progress(),f=c.serializeFormData();app.saveAjax(f.mode,null,f).done(function(){e.progressIndicator({mode:'hide'}),app.hideModalWindow(),d&&b.refreshView();});});});});},refreshView:function a(){this.getContainer().find('#supportedModule').trigger('change');},getContainer:function a(){return !1===this.container&&(this.container=jQuery('div.contentsDiv')),this.container},registerEvents:function b(){var a=this.getContainer();this.registerModulesChangeEvent(a),app.registerDataTables(a.find('.dataTable')),this.registerButtonEvents(a);}});
