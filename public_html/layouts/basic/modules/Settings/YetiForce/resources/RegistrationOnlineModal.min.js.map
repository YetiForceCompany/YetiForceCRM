{"version":3,"file":"RegistrationOnlineModal.min.js","sources":["RegistrationOnlineModal.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\n\t'Settings_YetiForce_RegistrationOnlineModal_Js',\n\t{\n\t\t/**\n\t\t * Register events for form checkbox element\n\t\t */\n\t\tregisterNewsletter() {\n\t\t\tconst form = $('[data-view=\"RegistrationOnlineModal\"]').find('form');\n\t\t\tform.find('[id$=\"newsletter\"]').on('click', (e) => {\n\t\t\t\tlet inputsContainer = $(e.target).closest('.js-card-body');\n\t\t\t\tif ($(e.target).prop('checked')) {\n\t\t\t\t\tinputsContainer.find('[id$=\"firstname]\"]').attr('data-validation-engine', 'validate[required]');\n\t\t\t\t\tinputsContainer.find('[id$=\"lastname]\"]').attr('data-validation-engine', 'validate[required]');\n\t\t\t\t\tinputsContainer.find('[id$=\"email]\"]').attr('data-validation-engine', 'validate[required,custom[email]]');\n\t\t\t\t\tinputsContainer.find('.js-newsletter-content').removeClass('d-none');\n\t\t\t\t} else {\n\t\t\t\t\tinputsContainer.find('[id$=\"firstname]\"]').removeAttr('data-validation-engine').val('');\n\t\t\t\t\tinputsContainer.find('[id$=\"lastname]\"]').removeAttr('data-validation-engine').val('');\n\t\t\t\t\tinputsContainer.find('[id$=\"email]\"]').removeAttr('data-validation-engine').val('');\n\t\t\t\t\tinputsContainer.find('.js-newsletter-content').addClass('d-none');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tgetCompanies(form) {\n\t\t\tlet companies = [];\n\t\t\tform.each(function () {\n\t\t\t\tcompanies.push($(this).serializeFormData());\n\t\t\t});\n\t\t\treturn companies;\n\t\t},\n\t\tregisterEvents() {\n\t\t\tconst self = this;\n\t\t\tconst container = $(\"[data-view='RegistrationOnlineModal']\");\n\t\t\tconst form = container.find('form');\n\t\t\tform.validationEngine(app.validationEngineOptions);\n\t\t\tform.on('submit', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tcontainer.find('[name=\"saveButton\"]').click();\n\t\t\t});\n\t\t\tcontainer.find('[name=\"saveButton\"]').on('click', function (e) {\n\t\t\t\tif (!form.validationEngine('validate')) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: app.vtranslate('JS_ENTER_ALL_REGISTRATION_DATA'),\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tcontainer.find('button[name=saveButton]').prop('disabled', true);\n\t\t\t\tlet progress = $.progressIndicator({\n\t\t\t\t\tmessage: app.vtranslate('JS_LOADING_PLEASE_WAIT'),\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'YetiForce',\n\t\t\t\t\tparent: 'Settings',\n\t\t\t\t\taction: 'Register',\n\t\t\t\t\tmode: 'online',\n\t\t\t\t\tcompanies: self.getCompanies(form)\n\t\t\t\t})\n\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\ttext: data['result']['message'],\n\t\t\t\t\t\t\ttype: data['result']['type']\n\t\t\t\t\t\t});\n\t\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\tif (data['result']['type'] === 'success') {\n\t\t\t\t\t\t\tlet href = location.href.replace('displayModal=online', '');\n\t\t\t\t\t\t\tlocation.replace(href);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontainer.find('button[name=saveButton]').prop('disabled', false);\n\t\t\t\t\t\treturn data['result'];\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function (error, title) {\n\t\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\t\ttext: error,\n\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t});\n\t\t\tthis.registerNewsletter();\n\t\t}\n\t},\n\t{}\n);\nSettings_YetiForce_RegistrationOnlineModal_Js.registerEvents();\n"],"names":["jQuery","Class","registerNewsletter","form","$","find","on","e","inputsContainer","target","closest","prop","attr","removeClass","removeAttr","val","addClass","getCompanies","companies","each","push","serializeFormData","registerEvents","self","container","validationEngine","app","validationEngineOptions","preventDefault","click","showNotify","text","vtranslate","type","progress","progressIndicator","message","blockInfo","enabled","AppConnector","request","module","parent","action","mode","done","data","href","location","replace","fail","error","title","Settings_YetiForce_RegistrationOnlineModal_Js"],"mappings":"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"}