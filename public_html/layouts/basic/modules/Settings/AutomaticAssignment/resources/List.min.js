'use strict';

Settings_Vtiger_List_Js('Settings_AutomaticAssignment_List_Js',{changeRecordState:function e(a,b){var c=jQuery.Deferred(),d=app.vtranslate('JS_STATE_CONFIRMATION');return Vtiger_Helper_Js.showConfirmationBox({message:d}).done(function(){app.saveAjax('save',{active:b},{record:a}).done(function(){var a=Settings_AutomaticAssignment_List_Js.getInstance();a.getListViewRecords();});}).fail(function(a,b){app.errorLog(a,b);}),c.promise()}},{container:!1,registerFilterChangeEvent:function b(){var a=this;jQuery('#moduleFilter').on('change',function(b){jQuery('#pageNumber').val('1'),jQuery('#pageToJump').val('1'),jQuery('#orderBy').val(''),jQuery('#sortOrder').val('');var c={module:app.getModuleName(),parent:app.getParentModuleName(),sourceModule:jQuery(b.currentTarget).val()};jQuery('#recordsCount').val(''),jQuery('#totalPageCount').text(''),a.getListViewRecords(c).done(function(){a.updatePagination();});});},getContainer:function a(){return !1==this.container&&(this.container=jQuery('div.contentsDiv')),this.container},registerModalEvents:function e(a,b){var c=a.find('form'),d=a.find('.submitButton');a.find('[name="tabid"]').on('change',function(c){var e=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}}),f=jQuery(c.currentTarget),g=b+'&tabid='+f.val();AppConnector.request(g).done(function(b){a.find('.fieldList').html(b),App.Fields.Picklist.showSelect2ElementView(a.find('.fieldList select')),d.removeClass('d-none'),e.progressIndicator({mode:'hide'});}).fail(function(a,b){e.progressIndicator({mode:'hide'}),app.errorLog(a,b);});}),c.on('submit',function(a){a.preventDefault();var b=c.serializeFormData();app.saveAjax('save',b).done(function(a){var b=a.result;if(b){var d=c.attr('action');d=d+'&record='+b,window.location.href=d;}});});},registerEvents:function b(){var a=this;this._super(),this.registerFilterChangeEvent(),this.getContainer().find('.addRecord').on('click',function(b){var c=jQuery(b.currentTarget),d=c.data('url');app.showModalWindow(null,d,function(b){a.registerModalEvents(b,d);});});}});
