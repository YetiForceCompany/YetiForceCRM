'use strict';

jQuery.Class('Settings_Users_SwitchUsers_Js',{},{registerAdd:function c(a){var b=this;a.find('.addItem').on('click',function(c){var d=[];a.find('.switchUsersTable tbody tr').each(function(){d.push({user:$(this).find('.sufrom').val()});});var e=parseInt(a.find('#suCount').val())+1,f=$(c.currentTarget),g=a.find('.cloneItem tbody').clone(!0,!0),h=g.find('.sufrom option');h.each(function(a,b){$.each(d,function(a,c){$(b).val()==c.user&&g.find(b).remove();});}),g.find('tr').attr('data-id',e).addClass('row'+e),a.find('.switchUsersTable tbody').append(g.html()),a.find('#suCount').val(e),b.registerDelete(a.find('tr.row'+e)),App.Fields.Picklist.showSelect2ElementView(a.find('tr.row'+e).find('select'));});},registerDelete:function b(a){a.find('.delate').on('click',function(a){var b=$(a.currentTarget);b.closest('tr').remove();});},registerSave:function b(a){a.find('.saveItems').on('click',function(){var b=[];a.find('.switchUsersTable tbody tr').each(function(){0<$(this).find('.suto :selected').length&&b.push({user:$(this).find('.sufrom').val(),access:$(this).find('.suto').val()});}),app.saveAjax('saveSwitchUsers',b).done(function(a){Settings_Vtiger_Index_Js.showMessage({type:'success',text:a.result.message});});});},registerEvents:function b(){var a=$('.contentsDiv');this.registerAdd(a),this.registerDelete(a),this.registerSave(a);}});
