$.Class("Settings_Countries_Index_Js",{},{registerSortableEvent:function(){var b=this;var a=$("tbody",$(".listViewEntriesTable"));a.sortable({helper:function(d,c){c.children().each(function(e,f){f=$(f);f.width(f.width())});return c},containment:a,revert:true,update:function(d,c){b.registerSequenceListOnServer()}})},registerStatus:function(a){a.find("button.status").on("click",function(){var c=$(this);var d=c.closest("tr").data("id");var b=c.data("status")?0:1;AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:"SaveAjax",mode:"updateStatus",id:d,status:b}).then(function(e){if(e.success&&e.result){c.data("status",b);c.toggleClass("btn-success").toggleClass("btn-danger");Vtiger_Helper_Js.showMessage({title:app.vtranslate("JS_COUNTRY_SETTING"),text:app.vtranslate("JS_SAVE_NOTIFY_OK"),type:"success"})}})})},registerPhone:function(a){a.find("button.phone").on("click",function(){var c=$(this);var d=c.closest("tr").data("id");var b=c.data("phone")?0:1;AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:"SaveAjax",mode:"updatePhone",id:d,phone:b}).then(function(e){if(e.success&&e.result){c.data("phone",b);c.toggleClass("btn-success").toggleClass("btn-danger");Vtiger_Helper_Js.showMessage({title:app.vtranslate("JS_COUNTRY_SETTING"),text:app.vtranslate("JS_SAVE_NOTIFY_OK"),type:"success"})}})})},registerUitype:function(a){a.find("button.uitype").on("click",function(){var c=$(this);var d=c.closest("tr").data("id");var b=c.data("uitype")?0:1;AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:"SaveAjax",mode:"updateUitype",id:d,uitype:b}).then(function(e){if(e.success&&e.result){c.data("uitype",b);c.toggleClass("btn-success").toggleClass("btn-danger");Vtiger_Helper_Js.showMessage({title:app.vtranslate("JS_COUNTRY_SETTING"),text:app.vtranslate("JS_SAVE_NOTIFY_OK"),type:"success"})}})})},allStatuses:1,registerAllStatuses:function(b){var a=this;b.find("button.all-statuses").on("click",function(){var c=a.allStatuses?0:1;AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:"SaveAjax",mode:"updateAllStatuses",status:c}).then(function(e){if(e.success&&e.result){var d=b.find(".status");if(c){d.removeClass("btn-success").addClass("btn-danger");d.data("status",1)}else{d.removeClass("btn-danger").addClass("btn-success");d.data("status",0)}Vtiger_Helper_Js.showMessage({title:app.vtranslate("JS_COUNTRY_SETTING"),text:app.vtranslate("JS_SAVE_NOTIFY_OK"),type:"success"})}if(e.success){a.allStatuses=c}})})},registerRowToTop:function(b){var a=this;b.find("button.to-top").on("click",function(){var c=$(this).closest("tr");$(this).closest("table.listViewEntriesTable tbody").prepend(c);a.registerSequenceListOnServer()})},registerRowToBottom:function(b){var a=this;b.find("button.to-bottom").on("click",function(){var c=$(this).closest("tr");$(this).closest("table.listViewEntriesTable tbody").append(c);a.registerSequenceListOnServer()})},registerSequenceListOnServer:function(){var a={};$("tbody tr").each(function(b){a[++b]=$(this).data("id")});AppConnector.request({sequencesList:JSON.stringify(a),module:app.getModuleName(),parent:app.getParentModuleName(),action:"SaveAjax",mode:"updateSequence"}).then(function(b){Vtiger_Helper_Js.showMessage({title:app.vtranslate("JS_COUNTRY_SETTING"),text:app.vtranslate("JS_SAVE_NOTIFY_OK"),type:"success"})})},registerEvents:function(){var a=$(".contentsDiv");this.registerSortableEvent();this.registerStatus(a);this.registerPhone(a);this.registerUitype(a);this.registerAllStatuses(a);this.registerRowToTop(a);this.registerRowToBottom(a)}});