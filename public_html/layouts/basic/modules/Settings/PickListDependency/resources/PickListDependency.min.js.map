{"version":3,"file":"PickListDependency.min.js","sources":["PickListDependency.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\njQuery.Class(\n\t'Settings_PickListDependency_Js',\n\t{\n\t\t//holds the picklist dependency instance\n\t\tpickListDependencyInstance: false,\n\t\t/**\n\t\t * Function used to triggerAdd new Dependency for the picklists\n\t\t */\n\t\ttriggerAdd: function (event) {\n\t\t\tevent.stopPropagation();\n\t\t\tvar instance = Settings_PickListDependency_Js.pickListDependencyInstance;\n\t\t\tinstance.updatedSourceValues = [];\n\t\t\tinstance.showEditView(instance.listViewForModule).done(function (data) {\n\t\t\t\tinstance.registerAddViewEvents();\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * This function used to trigger Edit picklist dependency\n\t\t */\n\t\ttriggerEdit: function (event, module, sourceField, targetField) {\n\t\t\tevent.stopPropagation();\n\t\t\tvar instance = Settings_PickListDependency_Js.pickListDependencyInstance;\n\t\t\tinstance.updatedSourceValues = [];\n\t\t\tinstance.showEditView(module, sourceField, targetField).done(function (data) {\n\t\t\t\tvar form = jQuery('#pickListDependencyForm');\n\t\t\t\tform\n\t\t\t\t\t.find('select[name=\"sourceModule\"],select[name=\"sourceField\"],select[name=\"targetField\"]')\n\t\t\t\t\t.prop('disabled', true);\n\t\t\t\tinstance.registerDependencyGraphEvents();\n\t\t\t\tinstance.registerSubmitEvent();\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * This function used to trigger Delete picklist dependency\n\t\t */\n\t\ttriggerDelete: function (event, module, sourceField, targetField) {\n\t\t\tevent.stopPropagation();\n\t\t\tvar currentTarget = jQuery(event.currentTarget);\n\t\t\tvar currentTrEle = currentTarget.closest('tr');\n\t\t\tvar instance = Settings_PickListDependency_Js.pickListDependencyInstance;\n\n\t\t\tvar message = app.vtranslate('JS_LBL_ARE_YOU_SURE_YOU_WANT_TO_DELETE');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({ message: message }).done(function (e) {\n\t\t\t\tinstance.deleteDependency(module, sourceField, targetField).done(function (data) {\n\t\t\t\t\tvar params = {};\n\t\t\t\t\tparams.text = app.vtranslate('JS_DEPENDENCY_DELETED_SUEESSFULLY');\n\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\tcurrentTrEle.fadeOut('slow').remove();\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\t//constructor\n\t\tinit: function () {\n\t\t\tSettings_PickListDependency_Js.pickListDependencyInstance = this;\n\t\t},\n\t\t//holds the listview forModule\n\t\tlistViewForModule: '',\n\t\t//holds the updated sourceValues while editing dependency\n\t\tupdatedSourceValues: [],\n\t\t//holds the new mapping of source values and target values\n\t\tvalueMapping: [],\n\t\t//holds the list of selected source values for dependency\n\t\tselectedSourceValues: [],\n\t\t/*\n\t\t * function to show editView for Add/Edit Dependency\n\t\t * @params: module - selected module\n\t\t *\t\t\tsourceField - source picklist\n\t\t *\t\t\ttargetField - target picklist\n\t\t */\n\t\tshowEditView: function (module, sourceField, targetField) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar params = {};\n\t\t\tparams['module'] = app.getModuleName();\n\t\t\tparams['parent'] = app.getParentModuleName();\n\t\t\tparams['view'] = 'Edit';\n\t\t\tparams['sourceModule'] = module;\n\t\t\tparams['sourcefield'] = sourceField;\n\t\t\tparams['targetfield'] = targetField;\n\n\t\t\tAppConnector.requestPjax(params)\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tvar container = jQuery('.contentsDiv');\n\t\t\t\t\tcontainer.html(data);\n\t\t\t\t\t//register all select2 Elements\n\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(container.find('select.select2'), {\n\t\t\t\t\t\tdropdownCss: { 'z-index': 0 }\n\t\t\t\t\t});\n\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t})\n\t\t\t\t.fail(function (error) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\taDeferred.reject(error);\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Function to get the Dependency graph based on selected module\n\t\t */\n\t\tgetModuleDependencyGraph: function (form) {\n\t\t\tvar thisInstance = this;\n\t\t\tform.find('[name=\"sourceModule\"]').on('change', function () {\n\t\t\t\tvar forModule = form.find('[name=\"sourceModule\"]').val();\n\t\t\t\tthisInstance.showEditView(forModule).done(function (data) {\n\t\t\t\t\tthisInstance.registerAddViewEvents();\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register change event for picklist fields in add/edit picklist dependency\n\t\t */\n\t\tregisterPicklistFieldsChangeEvent: function (form) {\n\t\t\tvar thisInstance = this;\n\t\t\tform.find('[name=\"sourceField\"],[name=\"targetField\"]').on('change', function () {\n\t\t\t\tthisInstance.checkValuesForDependencyGraph(form);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function used to check the selected picklist fields are valid before showing dependency graph\n\t\t */\n\t\tcheckValuesForDependencyGraph: function (form) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar sourceField = form.find('[name=\"sourceField\"]');\n\t\t\tvar targetField = form.find('[name=\"targetField\"]');\n\t\t\tvar select2SourceField = app.getSelect2ElementFromSelect(sourceField);\n\t\t\tvar select2TargetField = app.getSelect2ElementFromSelect(targetField);\n\t\t\tvar sourceFieldValue = sourceField.val();\n\t\t\tvar targetFieldValue = targetField.val();\n\t\t\tvar dependencyGraph = jQuery('#dependencyGraph');\n\t\t\tif (sourceFieldValue != '' && targetFieldValue != '') {\n\t\t\t\tvar resultMessage = app.vtranslate('JS_SOURCE_AND_TARGET_FIELDS_SHOULD_NOT_BE_SAME');\n\t\t\t\tform.find('.errorMessage').addClass('d-none');\n\t\t\t\tif (sourceFieldValue == targetFieldValue) {\n\t\t\t\t\tselect2TargetField.validationEngine('showPrompt', resultMessage, 'error', 'topLeft', true);\n\t\t\t\t\tdependencyGraph.html('');\n\t\t\t\t} else {\n\t\t\t\t\tselect2SourceField.validationEngine('hide');\n\t\t\t\t\tselect2TargetField.validationEngine('hide');\n\t\t\t\t\tvar sourceModule = form.find('[name=\"sourceModule\"]').val();\n\t\t\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t\t\tposition: 'html',\n\t\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\t\tenabled: true\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthisInstance\n\t\t\t\t\t\t.checkCyclicDependency(sourceModule, sourceFieldValue, targetFieldValue)\n\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\tvar result = data['result'];\n\t\t\t\t\t\t\tif (!result['result']) {\n\t\t\t\t\t\t\t\tthisInstance.addNewDependencyPickList(sourceModule, sourceFieldValue, targetFieldValue);\n\t\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\tform.find('.errorMessage').removeClass('d-none');\n\t\t\t\t\t\t\t\tform.find('.cancelAddView').removeClass('d-none');\n\t\t\t\t\t\t\t\tdependencyGraph.html('');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tform.find('.errorMessage').addClass('d-none');\n\t\t\t\tvar result = app.vtranslate('JS_SELECT_SOME_VALUE');\n\t\t\t\tif (sourceFieldValue == '') {\n\t\t\t\t\tselect2SourceField.validationEngine('showPrompt', result, 'error', 'topLeft', true);\n\t\t\t\t} else if (targetFieldValue == '') {\n\t\t\t\t\tselect2TargetField.validationEngine('showPrompt', result, 'error', 'topLeft', true);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Function used to check the cyclic dependency of the selected picklist fields\n\t\t * @params: sourceModule - selected module\n\t\t *            sourceFieldValue - source picklist value\n\t\t *            targetFieldValue - target picklist value\n\t\t */\n\t\tcheckCyclicDependency: function (sourceModule, sourceFieldValue, targetFieldValue) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar params = {};\n\t\t\tparams['mode'] = 'checkCyclicDependency';\n\t\t\tparams['module'] = app.getModuleName();\n\t\t\tparams['parent'] = app.getParentModuleName();\n\t\t\tparams['action'] = 'Index';\n\t\t\tparams['sourceModule'] = sourceModule;\n\t\t\tparams['sourcefield'] = sourceFieldValue;\n\t\t\tparams['targetfield'] = targetFieldValue;\n\n\t\t\tAppConnector.request(params).done(\n\t\t\t\tfunction (data) {\n\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t},\n\t\t\t\tfunction (error, err) {\n\t\t\t\t\taDeferred.reject();\n\t\t\t\t}\n\t\t\t);\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Function used to show the new picklist dependency graph\n\t\t * @params: sourceModule - selected module\n\t\t *            sourceFieldValue - source picklist value\n\t\t *            targetFieldValue - target picklist value\n\t\t */\n\t\taddNewDependencyPickList: function (sourceModule, sourceFieldValue, targetFieldValue) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar dependencyGraph = $('#dependencyGraph');\n\t\t\tthisInstance.updatedSourceValues = [];\n\t\t\tAppConnector.request({\n\t\t\t\tmode: 'getDependencyGraph',\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\tview: 'IndexAjax',\n\t\t\t\tsourceModule: sourceModule,\n\t\t\t\tsourcefield: sourceFieldValue,\n\t\t\t\ttargetfield: targetFieldValue\n\t\t\t}).done(function (data) {\n\t\t\t\tdependencyGraph.html(data).css({ padding: '10px', border: '1px solid #ddd', background: '#fff' });\n\t\t\t\tthisInstance.registerDependencyGraphEvents();\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * This function will delete the pickList Dependency\n\t\t * @params: module - selected module\n\t\t *            sourceField - source picklist value\n\t\t *            targetField - target picklist value\n\t\t */\n\t\tdeleteDependency: function (module, sourceField, targetField) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar params = {};\n\t\t\tparams['module'] = app.getModuleName();\n\t\t\tparams['parent'] = app.getParentModuleName();\n\t\t\tparams['action'] = 'DeleteAjax';\n\t\t\tparams['sourceModule'] = module;\n\t\t\tparams['sourcefield'] = sourceField;\n\t\t\tparams['targetfield'] = targetField;\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(function (data) {\n\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t})\n\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\taDeferred.reject(error, err);\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Function used to show cancel link in add view and register click event for cancel\n\t\t */\n\t\tregisterCancelAddView: function (form) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar cancelDiv = form.find('.cancelAddView');\n\t\t\tcancelDiv.removeClass('d-none');\n\t\t\tcancelDiv.find('.cancelLink').on('click', function () {\n\t\t\t\tthisInstance.loadListViewContents(thisInstance.listViewForModule);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register all the events related to addView of picklist dependency\n\t\t */\n\t\tregisterAddViewEvents: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tvar form = jQuery('#pickListDependencyForm');\n\t\t\tthisInstance.registerCancelAddView(form);\n\t\t\tthisInstance.getModuleDependencyGraph(form);\n\t\t\tthisInstance.registerPicklistFieldsChangeEvent(form);\n\t\t\tthisInstance.registerSubmitEvent();\n\t\t},\n\t\t/**\n\t\t * Register all the events in editView of picklist dependency\n\t\t */\n\t\tregisterDependencyGraphEvents: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tvar form = jQuery('#pickListDependencyForm');\n\t\t\tvar dependencyGraph = jQuery('#dependencyGraph');\n\t\t\tform.find('.cancelAddView').addClass('d-none');\n\t\t\tthisInstance.registerTargetFieldsClickEvent(dependencyGraph);\n\t\t\tthisInstance.registerTargetFieldsUnmarkAll(dependencyGraph);\n\t\t\tthisInstance.registerSelectSourceValuesClick(dependencyGraph);\n\t\t\tthisInstance.registerCancelDependency(form);\n\t\t},\n\t\t/**\n\t\t * Register all the events related to listView of picklist dependency\n\t\t */\n\t\tregisterListViewEvents: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tvar forModule = jQuery('.contentsDiv').find('.pickListSupportedModules').val();\n\t\t\tthisInstance.listViewForModule = forModule;\n\t\t\t//thisInstance.triggerDisplayTypeEvent();\n\t\t\tthisInstance.registerSourceModuleChangeEvent();\n\t\t},\n\t\t/**\n\t\t * Register the click event for cancel picklist dependency changes\n\t\t */\n\t\tregisterCancelDependency: function (form) {\n\t\t\tvar thisInstance = this;\n\t\t\t//Register click event for cancel link\n\t\t\tvar cancelDependencyLink = form.find('.cancelDependency');\n\t\t\tcancelDependencyLink.on('click', function () {\n\t\t\t\tthisInstance.loadListViewContents(thisInstance.listViewForModule);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register the click event for target fields in dependency graph\n\t\t */\n\t\tregisterTargetFieldsClickEvent: function (dependencyGraph) {\n\t\t\tvar thisInstance = this;\n\t\t\tthisInstance.updatedSourceValues = [];\n\t\t\tdependencyGraph.find('td.picklistValueMapping').on('click', function (e) {\n\t\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\t\tvar sourceValue = currentTarget.data('sourceValue');\n\t\t\t\tif (jQuery.inArray(sourceValue, thisInstance.updatedSourceValues) == -1) {\n\t\t\t\t\tthisInstance.updatedSourceValues.push(sourceValue);\n\t\t\t\t}\n\t\t\t\tif (currentTarget.hasClass('selectedCell')) {\n\t\t\t\t\tcurrentTarget.addClass('unselectedCell').removeClass('selectedCell');\n\t\t\t\t} else {\n\t\t\t\t\tcurrentTarget.addClass('selectedCell').removeClass('unselectedCell');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterTargetFieldsUnmarkAll: function (dependencyGraph) {\n\t\t\tvar thisInstance = this;\n\t\t\tthisInstance.updatedSourceValues = [];\n\t\t\tdependencyGraph.find('.unmarkAll').on('click', function (e) {\n\t\t\t\tdependencyGraph.find('td.picklistValueMapping').each(function (index) {\n\t\t\t\t\tvar currentTarget = jQuery(this);\n\t\t\t\t\tvar sourceValue = currentTarget.data('sourceValue');\n\t\t\t\t\tif (jQuery.inArray(sourceValue, thisInstance.updatedSourceValues) == -1) {\n\t\t\t\t\t\tthisInstance.updatedSourceValues.push(sourceValue);\n\t\t\t\t\t}\n\t\t\t\t\tcurrentTarget.addClass('unselectedCell').removeClass('selectedCell');\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function used to update the value mapping to save the picklist dependency\n\t\t */\n\t\tupdateValueMapping: function (dependencyGraph) {\n\t\t\tvar thisInstance = this;\n\t\t\tthisInstance.valueMapping = [];\n\t\t\tvar sourceValuesArray = thisInstance.updatedSourceValues;\n\t\t\tvar dependencyTable = dependencyGraph.find('.pickListDependencyTable');\n\t\t\tfor (var key in sourceValuesArray) {\n\t\t\t\tlet encodedSourceValue;\n\t\t\t\tif (typeof sourceValuesArray[key] == 'string') {\n\t\t\t\t\tencodedSourceValue = sourceValuesArray[key].replace(/\"/g, '\\\\\"');\n\t\t\t\t} else {\n\t\t\t\t\tencodedSourceValue = sourceValuesArray[key];\n\t\t\t\t}\n\t\t\t\tvar selectedTargetValues = dependencyTable\n\t\t\t\t\t.find('td[data-source-value=\"' + encodedSourceValue + '\"]')\n\t\t\t\t\t.filter('.selectedCell');\n\t\t\t\tvar targetValues = [];\n\t\t\t\tif (selectedTargetValues.length > 0) {\n\t\t\t\t\tjQuery.each(selectedTargetValues, function (index, element) {\n\t\t\t\t\t\ttargetValues.push(jQuery(element).data('targetValue'));\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\ttargetValues.push('');\n\t\t\t\t}\n\t\t\t\tthisInstance.valueMapping.push({\n\t\t\t\t\tsourcevalue: sourceValuesArray[key],\n\t\t\t\t\ttargetvalues: targetValues\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Register click event for select source values button in add/edit view\n\t\t */\n\t\tregisterSelectSourceValuesClick(dependencyGraph) {\n\t\t\tdependencyGraph.find('button.sourceValues').on('click', () => {\n\t\t\t\tconst selectSourceValues = dependencyGraph.find('.modalCloneCopy');\n\t\t\t\tconst clonedContainer = selectSourceValues.clone(true, true).removeClass('modalCloneCopy');\n\t\t\t\tapp.showModalWindow(\n\t\t\t\t\tclonedContainer,\n\t\t\t\t\t(data) => {\n\t\t\t\t\t\tdata.find('.sourcePicklistValuesModal').removeClass('d-none');\n\t\t\t\t\t\tdata.find('[name=\"saveButton\"]').on('click', (e) => {\n\t\t\t\t\t\t\tthis.selectedSourceValues = [];\n\t\t\t\t\t\t\tconst sourceValues = data.find('.sourceValue');\n\t\t\t\t\t\t\t$.each(sourceValues, (index, ele) => {\n\t\t\t\t\t\t\t\tconst element = $(ele);\n\t\t\t\t\t\t\t\tconst elementId = element.attr('id');\n\t\t\t\t\t\t\t\tconst hiddenElement = selectSourceValues.find('#' + elementId);\n\t\t\t\t\t\t\t\tif (element.is(':checked')) {\n\t\t\t\t\t\t\t\t\tthis.selectedSourceValues.push(element.val());\n\t\t\t\t\t\t\t\t\thiddenElement.prop('checked', true);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\thiddenElement.prop('checked', false);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\tthis.loadMappingForSelectedValues(dependencyGraph);\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\t{ width: '1000px' }\n\t\t\t\t);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function used to load mapping for selected picklist fields\n\t\t */\n\t\tloadMappingForSelectedValues: function (dependencyGraph) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar allSourcePickListValues = JSON.parse(dependencyGraph.find('.allSourceValues').val());\n\t\t\tvar dependencyTable = dependencyGraph.find('.pickListDependencyTable');\n\t\t\tfor (var key in allSourcePickListValues) {\n\t\t\t\tif (typeof allSourcePickListValues[key] == 'string') {\n\t\t\t\t\tvar encodedSourcePickListValue = allSourcePickListValues[key].replace(/\"/g, '\\\\\"');\n\t\t\t\t} else {\n\t\t\t\t\tencodedSourcePickListValue = allSourcePickListValues[key];\n\t\t\t\t}\n\t\t\t\tvar mappingCells = dependencyTable.find('[data-source-value=\"' + encodedSourcePickListValue + '\"]');\n\t\t\t\tif (jQuery.inArray(allSourcePickListValues[key], thisInstance.selectedSourceValues) == -1) {\n\t\t\t\t\tmappingCells.hide();\n\t\t\t\t} else {\n\t\t\t\t\tmappingCells.show();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * This function will save the picklist dependency details\n\t\t */\n\t\tsavePickListDependency: function (form) {\n\t\t\tconst self = this;\n\t\t\tlet progressIndicatorElement = $.progressIndicator({\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tparams = form.serializeFormData();\n\t\t\tparams['module'] = app.getModuleName();\n\t\t\tparams['parent'] = app.getParentModuleName();\n\t\t\tparams['action'] = 'SaveAjax';\n\t\t\tparams['mapping'] = JSON.stringify(self.valueMapping);\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tif (data['success']) {\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\tVtiger_Helper_Js.showMessage({\n\t\t\t\t\t\t\ttext: app.vtranslate('JS_PICKLIST_DEPENDENCY_SAVED'),\n\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tself.loadListViewContents(params['sourceModule']);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function (error) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t});\n\t\t},\n\t\t/**\n\t\t * This function will load the listView contents after Add/Edit picklist dependency\n\t\t */\n\t\tloadListViewContents: function (forModule) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar params = {};\n\t\t\tparams['module'] = app.getModuleName();\n\t\t\tparams['parent'] = app.getParentModuleName();\n\t\t\tparams['view'] = 'List';\n\t\t\tparams['formodule'] = forModule;\n\n\t\t\tAppConnector.requestPjax(params)\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t//replace the new list view contents\n\t\t\t\t\tjQuery('.contentsDiv').html(data);\n\t\t\t\t\tApp.Fields.Picklist.changeSelectElementView(jQuery('.contentsDiv'));\n\t\t\t\t\tthisInstance.registerListViewEvents();\n\t\t\t\t})\n\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t});\n\t\t},\n\t\t/**\n\t\t * trigger the display type event to show the width\n\t\t */\n\t\ttriggerDisplayTypeEvent: function () {\n\t\t\tvar widthType = app.cacheGet('widthType', 'narrowWidthType');\n\t\t\tif (widthType) {\n\t\t\t\tvar elements = jQuery('.listViewEntriesTable').find('td,th');\n\t\t\t\telements.attr('class', widthType);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * register change event for source module in add/edit picklist dependency\n\t\t */\n\t\tregisterSourceModuleChangeEvent: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tvar container = jQuery('.contentsDiv');\n\t\t\tcontainer.find('.pickListSupportedModules').on('change', function (e) {\n\t\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\t\tvar forModule = currentTarget.val();\n\t\t\t\tthisInstance.loadListViewContents(forModule);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * register the form submit event\n\t\t */\n\t\tregisterSubmitEvent: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tvar form = jQuery('#pickListDependencyForm');\n\t\t\tvar dependencyGraph = jQuery('#dependencyGraph');\n\t\t\tform.on('submit', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t\ttry {\n\t\t\t\t\tthisInstance.updateValueMapping(dependencyGraph);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tbootbox.alert(e.message);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (form.find('.editDependency').val() != 'true' && thisInstance.valueMapping.length < 1) {\n\t\t\t\t\tvar params = {};\n\t\t\t\t\tparams.text = app.vtranslate('JS_PICKLIST_DEPENDENCY_NO_SAVED');\n\t\t\t\t\tparams.type = 'info';\n\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t} else {\n\t\t\t\t\tthisInstance.savePickListDependency(form);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * register events for picklist dependency\n\t\t */\n\t\tregisterEvents: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tvar form = jQuery('#pickListDependencyForm');\n\t\t\tif (form.length > 0) {\n\t\t\t\tif (form.find('.editDependency').val() == 'true') {\n\t\t\t\t\tform\n\t\t\t\t\t\t.find('select[name=\"sourceModule\"],select[name=\"sourceField\"],select[name=\"targetField\"]')\n\t\t\t\t\t\t.prop('disabled', true);\n\t\t\t\t\tthisInstance.registerDependencyGraphEvents();\n\t\t\t\t\tthisInstance.registerSubmitEvent();\n\t\t\t\t} else {\n\t\t\t\t\tthisInstance.registerAddViewEvents();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthisInstance.registerListViewEvents();\n\t\t\t}\n\t\t}\n\t}\n);\n\njQuery(document).ready(function () {\n\tvar instance = new Settings_PickListDependency_Js();\n\tinstance.registerEvents();\n});\n"],"names":["jQuery","Class","pickListDependencyInstance","triggerAdd","event","stopPropagation","Settings_PickListDependency_Js","instance","updatedSourceValues","showEditView","listViewForModule","done","registerAddViewEvents","triggerEdit","module","sourceField","targetField","form","find","prop","registerDependencyGraphEvents","registerSubmitEvent","triggerDelete","currentTarget","currentTrEle","closest","message","app","vtranslate","Vtiger_Helper_Js","showConfirmationBox","deleteDependency","params","text","Settings_Vtiger_Index_Js","showMessage","fadeOut","remove","init","valueMapping","selectedSourceValues","Deferred","progressIndicatorElement","progressIndicator","position","blockInfo","enabled","getModuleName","getParentModuleName","AppConnector","requestPjax","data","mode","container","html","App","Fields","Picklist","showSelect2ElementView","dropdownCss","aDeferred","resolve","fail","error","reject","promise","getModuleDependencyGraph","on","val","thisInstance","forModule","registerPicklistFieldsChangeEvent","checkValuesForDependencyGraph","select2SourceField","getSelect2ElementFromSelect","select2TargetField","sourceFieldValue","targetFieldValue","dependencyGraph","addClass","validationEngine","resultMessage","checkCyclicDependency","sourceModule","result","removeClass","addNewDependencyPickList","request","$","parent","view","sourcefield","targetfield","css","padding","border","background","err","registerCancelAddView","cancelDiv","loadListViewContents","registerTargetFieldsClickEvent","registerTargetFieldsUnmarkAll","registerSelectSourceValuesClick","registerCancelDependency","registerListViewEvents","registerSourceModuleChangeEvent","cancelDependencyLink","e","sourceValue","inArray","push","hasClass","each","updateValueMapping","dependencyTable","encodedSourceValue","key","sourceValuesArray","replace","filter","targetValues","length","selectedTargetValues","index","element","sourcevalue","targetvalues","clonedContainer","selectSourceValues","clone","showModalWindow","sourceValues","ele","elementId","attr","hiddenElement","is","hideModalWindow","loadMappingForSelectedValues","width","allSourcePickListValues","JSON","parse","encodedSourcePickListValue","mappingCells","hide","show","savePickListDependency","serializeFormData","stringify","self","type","changeSelectElementView","triggerDisplayTypeEvent","cacheGet","widthType","elements","preventDefault","alert","registerEvents","document","ready"],"mappings":"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"}