{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nSettings_Vtiger_Edit_Js(\n\t'Settings_MailSmtp_Edit_Js',\n\t{},\n\t{\n\t\tregisterDependency() {\n\t\t\tlet dependency = JSON.parse(this.container.find('.js-smtp-dependency').val());\n\t\t\tfor (let field in dependency) {\n\t\t\t\tlet fieldEl = this.container.find(`[name=\"${field}\"]`);\n\t\t\t\tlet conditions = dependency[field]['condition'];\n\t\t\t\tlet hide = false;\n\t\t\t\tfor (let conField in conditions) {\n\t\t\t\t\tlet conFieldEl = this.container.find(`[data-fieldinfo][name=\"${conField}\"]`);\n\t\t\t\t\tlet conFieldElVal =\n\t\t\t\t\t\tconFieldEl.attr('type') === 'checkbox' ? Number(conFieldEl.is(':checked')) : conFieldEl.val();\n\t\t\t\t\tlet { value, operator } = conditions[conField];\n\t\t\t\t\tif ((operator === 'e' && value == conFieldElVal) || (operator === 'n' && value != conFieldElVal)) {\n\t\t\t\t\t\thide = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (hide) {\n\t\t\t\t\tfieldEl.closest('.js-field-container').addClass('d-none');\n\t\t\t\t} else {\n\t\t\t\t\tfieldEl.closest('.js-field-container').removeClass('d-none');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tchangeMailerType: function () {\n\t\t\tthis.container.find('select').on('change', (e) => {\n\t\t\t\tthis.registerDependency();\n\t\t\t});\n\t\t\tthis.container.find('input[type=\"checkbox\"]').on('click', (e) => {\n\t\t\t\tthis.registerDependency();\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * PreSave validation\n\t\t */\n\t\tpreSaveValidation: function () {\n\t\t\tconst aDeferred = $.Deferred();\n\t\t\tlet formData = new FormData(this.container[0]);\n\t\t\tformData.append('mode', 'preSaveValidation');\n\t\t\tAppConnector.request({\n\t\t\t\tasync: false,\n\t\t\t\turl: 'index.php',\n\t\t\t\ttype: 'POST',\n\t\t\t\tdata: formData,\n\t\t\t\tprocessData: false,\n\t\t\t\tcontentType: false\n\t\t\t})\n\t\t\t\t.done((data) => {\n\t\t\t\t\tlet response = data.result;\n\t\t\t\t\tfor (let i in response) {\n\t\t\t\t\t\tif (response[i].result !== true) {\n\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\ttext: response[i].message ? response[i].message : app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (response[i].hoverField != undefined) {\n\t\t\t\t\t\t\t\tthis.container.find('[name=\"' + response[i].hoverField + '\"]').focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\taDeferred.resolve(data.result.length <= 0);\n\t\t\t\t})\n\t\t\t\t.fail((textStatus, errorThrown) => {\n\t\t\t\t\tapp.showNotify({ text: app.vtranslate('JS_ERROR'), type: 'error' });\n\t\t\t\t\tapp.errorLog(textStatus, errorThrown);\n\t\t\t\t\taDeferred.resolve(false);\n\t\t\t\t});\n\n\t\t\treturn aDeferred.promise();\n\t\t},\n\n\t\t/**\n\t\t * Register submit event\n\t\t */\n\t\tregisterSubmitEvent() {\n\t\t\tthis.container.off('submit').on('submit', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.container.find('.js-toggle-panel').find('.js-block-content').removeClass('d-none');\n\t\t\t\tif ($(e.currentTarget).validationEngine('validate')) {\n\t\t\t\t\tlet progressLoader = $.progressIndicator({\n\t\t\t\t\t\tmessage: app.vtranslate('JS_SAVE_LOADER_INFO'),\n\t\t\t\t\t\tposition: 'html',\n\t\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\t\tenabled: true\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.preSaveValidation().done((response) => {\n\t\t\t\t\t\tif (response === true) {\n\t\t\t\t\t\t\tlet formData = this.container.serializeFormData();\n\t\t\t\t\t\t\tapp\n\t\t\t\t\t\t\t\t.saveAjax('save', [], formData)\n\t\t\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\t\t\tif (data.result && data.result.success) {\n\t\t\t\t\t\t\t\t\t\tapp.showNotify({ text: app.vtranslate('JS_SAVE_SUCCESS'), type: 'success' });\n\t\t\t\t\t\t\t\t\t\twindow.location.href = data.result.url;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tprogressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\t\t\tapp.showNotify({ text: app.vtranslate('JS_ERROR'), type: 'error' });\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.fail(function () {\n\t\t\t\t\t\t\t\t\tprogressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\t\tapp.showNotify({ text: app.vtranslate('JS_ERROR'), type: 'error' });\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tprogressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\te.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t});\n\t\t},\n\n\t\tregisterBasicEvents: function () {\n\t\t\tthis.referenceModulePopupRegisterEvent(this.container);\n\t\t\tthis.registerAutoCompleteFields(this.container);\n\t\t\tthis.registerClearReferenceSelectionEvent(this.container);\n\t\t\tthis.container.validationEngine(app.validationEngineOptionsForRecord);\n\t\t\tthis.registerSubmitEvent();\n\t\t\tapp.registerBlockToggleEvent(this.container);\n\t\t\tApp.Fields.Password.register(this.container);\n\t\t\tApp.Fields.Text.registerCopyClipboard(this.container);\n\t\t},\n\n\t\tregisterEvents: function () {\n\t\t\tthis.container = this.getForm();\n\t\t\tthis.changeMailerType();\n\t\t\tthis.registerBasicEvents(this.container);\n\t\t}\n\t}\n);\n"],"names":["Settings_Vtiger_Edit_Js","registerDependency","dependency","JSON","parse","container","find","val","field","fieldEl","concat","conditions","condition","hide","conField","conFieldEl","conFieldElVal","attr","Number","is","_conditions$conField","value","operator","closest","addClass","removeClass","changeMailerType","_this","on","preSaveValidation","_this2","aDeferred","$","Deferred","formData","FormData","append","AppConnector","request","async","url","type","data","processData","contentType","done","response","result","i","app","showNotify","text","message","vtranslate","hoverField","focus","resolve","length","fail","textStatus","errorThrown","errorLog","promise","registerSubmitEvent","_this3","off","e","preventDefault","currentTarget","validationEngine","progressLoader","progressIndicator","position","blockInfo","enabled","serializeFormData","saveAjax","success","window","location","href","mode","stopPropagation","registerBasicEvents","referenceModulePopupRegisterEvent","registerAutoCompleteFields","registerClearReferenceSelectionEvent","validationEngineOptionsForRecord","registerBlockToggleEvent","App","Fields","Password","register","Text","registerCopyClipboard","registerEvents","getForm"],"mappings":"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"}