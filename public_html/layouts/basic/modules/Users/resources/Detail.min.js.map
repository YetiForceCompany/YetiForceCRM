{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce.com\n *************************************************************************************/\n'use strict';\n\nVtiger_Detail_Js(\n\t'Users_Detail_Js',\n\t{\n\t\t/*\n\t\t * function to trigger delete record action\n\t\t * @params: delete record url.\n\t\t */\n\t\ttriggerDeleteUser: function(deleteUserUrl) {\n\t\t\tvar message = app.vtranslate('LBL_DELETE_USER_CONFIRMATION');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({ message: message })\n\t\t\t\t.done(function(data) {\n\t\t\t\t\tAppConnector.request(deleteUserUrl).done(function(data) {\n\t\t\t\t\t\tif (data) {\n\t\t\t\t\t\t\tvar callback = function(data) {\n\t\t\t\t\t\t\t\tvar params = app.validationEngineOptions;\n\t\t\t\t\t\t\t\tparams.onValidationComplete = function(form, valid) {\n\t\t\t\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\t\t\t\tUsers_Detail_Js.deleteUser(form);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t$('#deleteUser').validationEngine(app.validationEngineOptions);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tapp.showModalWindow(data, function(data) {\n\t\t\t\t\t\t\t\tif (typeof callback == 'function') {\n\t\t\t\t\t\t\t\t\tcallback(data);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\tconsole.error(error);\n\t\t\t\t});\n\t\t},\n\t\tdeleteUser: function(form) {\n\t\t\tvar userid = form.find('[name=\"userid\"]').val();\n\t\t\tvar transferUserId = form.find('[name=\"tranfer_owner_id\"]').val();\n\n\t\t\tvar params = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'DeleteAjax',\n\t\t\t\tmode: 'deleteUser',\n\t\t\t\ttransfer_user_id: transferUserId,\n\t\t\t\tuserid: userid,\n\t\t\t\tpermanent: form.find('[name=\"deleteUserPermanent\"]:checked').val()\n\t\t\t};\n\t\t\tAppConnector.request(params).done(function(data) {\n\t\t\t\tif (data.success) {\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(app.vtranslate(data.result.message));\n\t\t\t\t\tvar url = data.result.listViewUrl;\n\t\t\t\t\twindow.location.href = url;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\ttriggerChangeAccessKey: function(url) {\n\t\t\tvar title = app.vtranslate('JS_NEW_ACCESS_KEY_REQUESTED');\n\t\t\tvar message = app.vtranslate('JS_CHANGE_ACCESS_KEY_CONFIRMATION');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({ title: title, message: message }).done(function(data) {\n\t\t\t\tAppConnector.request(url).done(function(data) {\n\t\t\t\t\tvar params = {};\n\t\t\t\t\tif (data['success']) {\n\t\t\t\t\t\tdata = data.result;\n\t\t\t\t\t\tparams['type'] = 'success';\n\t\t\t\t\t\tmessage = app.vtranslate(data.message);\n\t\t\t\t\t\tvar accessKeyEle = $('#Users_detailView_fieldValue_accesskey');\n\t\t\t\t\t\tif (accessKeyEle.length) {\n\t\t\t\t\t\t\taccessKeyEle.find('.value').html(data.accessKey);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmessage = app.vtranslate(data['error']['message']);\n\t\t\t\t\t}\n\t\t\t\t\tparams['text'] = message;\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\tusersEditInstance: false,\n\t\tupdateStartHourElement: function(form) {\n\t\t\tthis.usersEditInstance.triggerHourFormatChangeEvent(form);\n\t\t\tthis.updateStartHourElementValue();\n\t\t},\n\t\thourFormatUpdateEvent: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tthis.getForm().on(this.fieldUpdatedEvent, '[name=\"hour_format\"]', function(e, params) {\n\t\t\t\tthisInstance.updateStartHourElementValue();\n\t\t\t});\n\t\t},\n\t\tupdateStartHourElementValue: function() {\n\t\t\tvar form = this.getForm();\n\t\t\tvar startHourSelectElement = $('select[name=\"start_hour\"]', form);\n\t\t\tvar selectedElementValue = startHourSelectElement.find('option:selected').text();\n\t\t\tstartHourSelectElement\n\t\t\t\t.closest('.fieldValue')\n\t\t\t\t.find('span.value')\n\t\t\t\t.text(selectedElementValue);\n\t\t\tvar endHourSelectElement = $('select[name=\"end_hour\"]', form);\n\t\t\tendHourSelectElement\n\t\t\t\t.closest('.fieldValue')\n\t\t\t\t.find('span.value')\n\t\t\t\t.text(endHourSelectElement.find('option:selected').text());\n\t\t},\n\t\tstartHourUpdateEvent: function(form) {\n\t\t\tvar thisInstance = this;\n\t\t\tform.on(this.fieldUpdatedEvent, '[name=\"start_hour\"]', function(e, params) {\n\t\t\t\tthisInstance.updateStartHourElement(form);\n\t\t\t});\n\t\t},\n\t\tsaveFieldValues: function(fieldDetailList) {\n\t\t\tvar aDeferred = $.Deferred();\n\t\t\tvar thisInstance = this;\n\t\t\tvar lock = false;\n\t\t\tvar recordId = this.getRecordId();\n\t\t\tvar data = {};\n\t\t\tif (typeof fieldDetailList !== 'undefined') {\n\t\t\t\tdata = fieldDetailList;\n\t\t\t\tif (data['field'] == 'email1') {\n\t\t\t\t\tthisInstance.usersEditInstance.checkEmail(data['value']).done(\n\t\t\t\t\t\tfunction(data) {},\n\t\t\t\t\t\tfunction(data, error) {\n\t\t\t\t\t\t\tlock = true;\n\t\t\t\t\t\t\taDeferred.reject();\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (lock !== true) {\n\t\t\t\tdata['record'] = recordId;\n\t\t\t\tdata['module'] = app.getModuleName();\n\t\t\t\tdata['action'] = 'SaveAjax';\n\n\t\t\t\tvar params = {};\n\t\t\t\tparams.data = data;\n\t\t\t\tparams.async = false;\n\t\t\t\tparams.dataType = 'json';\n\t\t\t\tAppConnector.request(params).done(function(reponseData) {\n\t\t\t\t\taDeferred.resolve(reponseData);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tregisterValidatePassword: function() {\n\t\t\t$('body').on('click', '.js-validate-password', function(e) {\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\taction: 'VerifyData',\n\t\t\t\t\tmode: 'validatePassword',\n\t\t\t\t\tpassword: $('body')\n\t\t\t\t\t\t.find('[name=\"' + $(e.currentTarget).data('field') + '\"]')\n\t\t\t\t\t\t.val()\n\t\t\t\t}).done(function(data) {\n\t\t\t\t\tif (data.success && data.result) {\n\t\t\t\t\t\tVtiger_Helper_Js.showMessage({\n\t\t\t\t\t\t\ttext: data.result.message,\n\t\t\t\t\t\t\ttype: data.result.type\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterEvents: function() {\n\t\t\tthis._super();\n\t\t\tvar form = this.getForm();\n\t\t\tthis.usersEditInstance = Vtiger_Edit_Js.getInstance();\n\t\t\tthis.updateStartHourElement(form);\n\t\t\tthis.hourFormatUpdateEvent();\n\t\t\tthis.startHourUpdateEvent(form);\n\t\t\tthis.registerValidatePassword();\n\t\t\tUsers_Edit_Js.registerChangeEventForCurrencySeparator();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_Detail_Js","triggerDeleteUser","deleteUserUrl","app","vtranslate","Vtiger_Helper_Js","showConfirmationBox","message","done","AppConnector","request","data","validationEngineOptions","params","onValidationComplete","form","valid","Users_Detail_Js","deleteUser","$","validationEngine","showModalWindow","callback","fail","error","console","find","val","transferUserId","module","getModuleName","action","mode","transfer_user_id","userid","permanent","success","hideModalWindow","showPnotify","result","listViewUrl","window","location","href","url","triggerChangeAccessKey","title","accessKeyEle","length","html","accessKey","usersEditInstance","updateStartHourElement","triggerHourFormatChangeEvent","updateStartHourElementValue","hourFormatUpdateEvent","getForm","on","fieldUpdatedEvent","thisInstance","startHourSelectElement","selectedElementValue","text","closest","endHourSelectElement","startHourUpdateEvent","saveFieldValues","fieldDetailList","Deferred","lock","recordId","getRecordId","checkEmail","aDeferred","reject","async","dataType","reponseData","resolve","promise","registerValidatePassword","e","password","currentTarget","showMessage","type","registerEvents","_super","Vtiger_Edit_Js","getInstance","Users_Edit_Js","registerChangeEventForCurrencySeparator"],"mappings":"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"}