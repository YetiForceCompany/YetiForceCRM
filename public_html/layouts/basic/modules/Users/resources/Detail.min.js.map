{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce.com\n *************************************************************************************/\n'use strict';\n\nVtiger_Detail_Js(\"Users_Detail_Js\", {\n\t/*\n\t * function to trigger delete record action\n\t * @params: delete record url.\n\t */\n\ttriggerDeleteUser: function (deleteUserUrl) {\n\t\tvar message = app.vtranslate('LBL_DELETE_USER_CONFIRMATION');\n\t\tVtiger_Helper_Js.showConfirmationBox({'message': message}).done(function (data) {\n\t\t\tAppConnector.request(deleteUserUrl).done(function (data) {\n\t\t\t\tif (data) {\n\t\t\t\t\tvar callback = function (data) {\n\t\t\t\t\t\tvar params = app.validationEngineOptions;\n\t\t\t\t\t\tparams.onValidationComplete = function (form, valid) {\n\t\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\t\tUsers_Detail_Js.deleteUser(form);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tjQuery('#deleteUser').validationEngine(app.validationEngineOptions);\n\t\t\t\t\t};\n\t\t\t\t\tapp.showModalWindow(data, function (data) {\n\t\t\t\t\t\tif (typeof callback == 'function') {\n\t\t\t\t\t\t\tcallback(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}).fail(function (error, err) {\n\t\t\t\tconsole.error(error);\t\n\t\t});\n\t},\n\tdeleteUser: function (form) {\n\t\tvar userid = form.find('[name=\"userid\"]').val();\n\t\tvar transferUserId = form.find('[name=\"tranfer_owner_id\"]').val();\n\n\t\tvar params = {\n\t\t\t'module': app.getModuleName(),\n\t\t\t'action': \"DeleteAjax\",\n\t\t\t'mode': 'deleteUser',\n\t\t\t'transfer_user_id': transferUserId,\n\t\t\t'userid': userid,\n\t\t\t'permanent': form.find('[name=\"deleteUserPermanent\"]:checked').val()\n\t\t};\n\t\tAppConnector.request(params).done(\n\t\t\tfunction (data) {\n\t\t\t\tif (data.success) {\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(app.vtranslate(data.result.message));\n\t\t\t\t\tvar url = data.result.listViewUrl;\n\t\t\t\t\twindow.location.href = url;\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t},\n\ttriggerChangeAccessKey: function (url) {\n\t\tvar title = app.vtranslate('JS_NEW_ACCESS_KEY_REQUESTED');\n\t\tvar message = app.vtranslate('JS_CHANGE_ACCESS_KEY_CONFIRMATION');\n\t\tVtiger_Helper_Js.showConfirmationBox({title: title, message: message}).done(function (data) {\n\t\t\tAppConnector.request(url).done(function (data) {\n\t\t\t\tvar params = {};\n\t\t\t\tif (data['success']) {\n\t\t\t\t\tdata = data.result;\n\t\t\t\t\tparams['type'] = 'success';\n\t\t\t\t\tmessage = app.vtranslate(data.message);\n\t\t\t\t\tvar accessKeyEle = jQuery('#Users_detailView_fieldValue_accesskey');\n\t\t\t\t\tif (accessKeyEle.length) {\n\t\t\t\t\t\taccessKeyEle.find('.value').html(data.accessKey);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tmessage = app.vtranslate(data['error']['message']);\n\t\t\t\t}\n\t\t\t\tparams['text'] = message;\n\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t});\n\t\t});\n\t},\n\n}, {\n\tusersEditInstance: false,\n\tupdateStartHourElement: function (form) {\n\t\tthis.usersEditInstance.triggerHourFormatChangeEvent(form);\n\t\tthis.updateStartHourElementValue();\n\t},\n\thourFormatUpdateEvent: function () {\n\t\tvar thisInstance = this;\n\t\tthis.getForm().on(this.fieldUpdatedEvent, '[name=\"hour_format\"]', function (e, params) {\n\t\t\tthisInstance.updateStartHourElementValue();\n\t\t});\n\t},\n\tupdateStartHourElementValue: function () {\n\t\tvar form = this.getForm();\n\t\tvar startHourSelectElement = jQuery('select[name=\"start_hour\"]', form);\n\t\tvar selectedElementValue = startHourSelectElement.find('option:selected').text();\n\t\tstartHourSelectElement.closest('.fieldValue').find('span.value').text(selectedElementValue);\n\t\tvar endHourSelectElement = jQuery('select[name=\"end_hour\"]', form);\n\t\tendHourSelectElement.closest('.fieldValue').find('span.value').text(endHourSelectElement.find('option:selected').text());\n\t},\n\tstartHourUpdateEvent: function (form) {\n\t\tvar thisInstance = this;\n\t\tform.on(this.fieldUpdatedEvent, '[name=\"start_hour\"]', function (e, params) {\n\t\t\tthisInstance.updateStartHourElement(form);\n\t\t});\n\t},\n\tsaveFieldValues: function (fieldDetailList) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar thisInstance = this;\n\t\tvar lock = false;\n\t\tvar recordId = this.getRecordId();\n\t\tvar data = {};\n\t\tif (typeof fieldDetailList !== \"undefined\") {\n\t\t\tdata = fieldDetailList;\n\t\t\tif (data['field'] == 'email1') {\n\t\t\t\tthisInstance.usersEditInstance.checkEmail(data['value']).done(\n\t\t\t\t\tfunction (data) {\n\t\t\t\t\t},\n\t\t\t\t\tfunction (data, error) {\n\t\t\t\t\t\tlock = true;\n\t\t\t\t\t\taDeferred.reject();\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tif (lock !== true) {\n\t\t\tdata['record'] = recordId;\n\t\t\tdata['module'] = app.getModuleName();\n\t\t\tdata['action'] = 'SaveAjax';\n\n\t\t\tvar params = {};\n\t\t\tparams.data = data;\n\t\t\tparams.async = false;\n\t\t\tparams.dataType = 'json';\n\t\t\tAppConnector.request(params).done(\n\t\t\t\tfunction (reponseData) {\n\t\t\t\t\taDeferred.resolve(reponseData);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\treturn aDeferred.promise();\n\t},\n\tregisterEvents: function () {\n\t\tthis._super();\n\t\tvar form = this.getForm();\n\t\tthis.usersEditInstance = Vtiger_Edit_Js.getInstance();\n\t\tthis.updateStartHourElement(form);\n\t\tthis.hourFormatUpdateEvent();\n\t\tthis.startHourUpdateEvent(form);\n\t\tUsers_Edit_Js.registerChangeEventForCurrencySeparator();\n\t}\n\n});\n"],"names":["Vtiger_Detail_Js","triggerDeleteUser","deleteUserUrl","app","vtranslate","Vtiger_Helper_Js","showConfirmationBox","message","done","AppConnector","request","data","validationEngineOptions","params","onValidationComplete","form","valid","Users_Detail_Js","deleteUser","jQuery","validationEngine","showModalWindow","callback","fail","error","console","find","val","transferUserId","getModuleName","userid","success","hideModalWindow","showPnotify","result","listViewUrl","window","location","href","url","triggerChangeAccessKey","title","accessKeyEle","length","html","accessKey","usersEditInstance","updateStartHourElement","triggerHourFormatChangeEvent","updateStartHourElementValue","hourFormatUpdateEvent","getForm","on","fieldUpdatedEvent","thisInstance","startHourSelectElement","selectedElementValue","text","closest","endHourSelectElement","startHourUpdateEvent","saveFieldValues","fieldDetailList","Deferred","lock","recordId","getRecordId","checkEmail","aDeferred","reject","async","dataType","reponseData","resolve","promise","registerEvents","_super","Vtiger_Edit_Js","getInstance","Users_Edit_Js","registerChangeEventForCurrencySeparator"],"mappings":"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"}