
Vtiger_Edit_Js("Users_Edit_Js", {registerChangeEventForCurrencySeparator:function(){var a = jQuery("form"); jQuery('[name="currency_decimal_separator"]', a).on("change", function(h){var d = jQuery(h.currentTarget); var c = d.val(); var b = jQuery('[name="currency_grouping_separator"]', a).data("selectedValue"); if (b == c){var g = app.vtranslate("JS_DECIMAL_SEPARATOR_AND_GROUPING_SEPARATOR_CANT_BE_SAME"); var i = {text:g, type:"error"}; Vtiger_Helper_Js.showMessage(i); var f = d.data("selectedValue"); d.find("option").removeAttr("selected"); d.find('option[value="' + f + '"]').attr("selected", "selected"); d.trigger("chosen:updated")} else{d.data("selectedValue", c)}}); jQuery('[name="currency_grouping_separator"]', a).on("change", function(h){var d = jQuery(h.currentTarget); var c = d.val(); var b = jQuery('[name="currency_decimal_separator"]', a).data("selectedValue"); if (b == c){var g = app.vtranslate("JS_DECIMAL_SEPARATOR_AND_GROUPING_SEPARATOR_CANT_BE_SAME"); var i = {text:g, type:"error"}; Vtiger_Helper_Js.showMessage(i); var f = d.data("selectedValue"); d.find("option").removeAttr("selected"); d.find('option[value="' + f + '"]').attr("selected", "selected"); d.trigger("chosen:updated")} else{d.data("selectedValue", c)}})}}, {duplicateCheckCache:{}, userExistCheckCache:{}, passCheckCache:{}, hourFormatConditionMapping:false, registerHourFormatChangeEvent:function(){}, getHourValues:function(d, c){var a = ""; for (var b in d){if (d.hasOwnProperty(b)){var e = d[b]; a += '<option value="' + b + '"'; if (b == c){a += ' selected="selected" '}a += ">" + e + "</option>"}}return a}, changeStartHourValuesEvent:function(b){var a = this; b.on("change", 'select[name="hour_format"]', function(i){var c = jQuery(i.currentTarget).val(); var h = jQuery('select[name="start_hour"]', b); var d = jQuery('select[name="end_hour"]', b); var j = h.val(); var g = d.val(); if (typeof a.hourFormatConditionMapping == "undefined"){return false}var f = a.hourFormatConditionMapping.hour_format[c]["start_hour"]; h.html(a.getHourValues(f, j)).trigger("chosen:updated"); d.html(a.getHourValues(f, g)).trigger("chosen:updated")})}, triggerHourFormatChangeEvent:function(a){this.hourFormatConditionMapping = jQuery('input[name="timeFormatOptions"]', a).data("value"); this.changeStartHourValuesEvent(a); jQuery('select[name="hour_format"]', a).trigger("change")}, registerRecordPreSaveEvent:function(b){var a = this; b.on(Vtiger_Edit_Js.recordPreSave, function(g, d){var c = jQuery('input[name="record"]').val(); var f = jQuery.progressIndicator({message:app.vtranslate("JS_SAVE_LOADER_INFO"), position:"html", blockInfo:{enabled:true}}); if (c == "" && jQuery('input[name="user_password"]').val() != jQuery('input[name="confirm_password"]').val()){Vtiger_Helper_Js.showPnotify(app.vtranslate("JS_REENTER_PASSWORDS")); f.progressIndicator({mode:"hide"}); g.preventDefault()}a.verifyFormData().then(function(e){if (e.result.message){Vtiger_Helper_Js.showPnotify(e.result.message); f.progressIndicator({mode:"hide"}); g.preventDefault()}}, function(h, e){f.progressIndicator({mode:"hide"}); g.preventDefault()})})}, verifyFormData:function(){var a = jQuery.Deferred(); var b = this; b.verifyData().then(function(c){a.resolve(c)}, function(d, c){a.reject()}); return a.promise()}, verifyData:function(){var a = jQuery.Deferred(); AppConnector.request({async:false, data:{module:"Users", action:"VerifyData", email:jQuery('[name="email1"]').val(), userName:jQuery('input[name="user_name"]').val(), record:jQuery('input[name="record"]').val(), password:jQuery('input[name="user_password"]').val(), }}).done(function(b){if (b.result){a.resolve(b)} else{a.reject(b)}}); return a.promise()}, registerEvents:function(){this._super(); var a = this.getForm(); this.triggerHourFormatChangeEvent(a); this.registerRecordPreSaveEvent(a); Users_Edit_Js.registerChangeEventForCurrencySeparator()}});
