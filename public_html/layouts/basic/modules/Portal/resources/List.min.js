'use strict';

Vtiger_List_Js('Portal_List_Js',{getDefaultParams:function getDefaultParams(){var params={module:app.getModuleName(),view:'List',page:jQuery('#pageNumber').val(),orderby:jQuery('#orderBy').val(),sortorder:jQuery('#sortOrder').val(),search_value:jQuery('#alphabetValue').val()};return params},editBookmark:function editBookmark(params){AppConnector.request(params).done(function(data){var callBackFunction=function(){Portal_List_Js.saveBookmark();};app.showModalWindow(data,function(data){'function'==typeof callBackFunction&&callBackFunction(data);});});},saveBookmark:function saveBookmark(){jQuery('#saveBookmark').on('submit',function(e){e.preventDefault();var form=jQuery(e.currentTarget),params=form.serializeFormData();if(''==params.bookmarkName||''==params.bookmarkUrl){var data={title:app.vtranslate('JS_MESSAGE'),text:app.vtranslate('JS_ENTER_MANDATORY_FIELD'),type:'error'};return Vtiger_Helper_Js.showPnotify(data),!1}AppConnector.request(params).done(function(data){if(data.success){var params={title:app.vtranslate('JS_MESSAGE'),text:data.result.message,type:'success'};Vtiger_Helper_Js.showPnotify(params);var url=Portal_List_Js.getDefaultParams();Portal_List_Js.loadListViewContent(url),app.hideModalWindow();}});});},massDeleteRecords:function massDeleteRecords(){var listInstance=Vtiger_List_Js.getInstance(),validationResult=listInstance.checkListRecordSelected();if(!0!=validationResult){var selectedIds=listInstance.readSelectedIds(!0),excludedIds=listInstance.readExcludedIds(!0),message=app.vtranslate('LBL_MASS_DELETE_CONFIRMATION');Vtiger_Helper_Js.showConfirmationBox({message:message}).done(function(){var deleteURL='index.php?module='+app.getModuleName()+'&action=MassDelete';deleteURL+='&selected_ids='+selectedIds+'&excluded_ids='+excludedIds;var searchValue=listInstance.getAlphabetSearchValue();'undefined'!=typeof searchValue&&0<searchValue.length&&(deleteURL+='&search_value='+searchValue),AppConnector.request(deleteURL).done(function(data){if(data.success){var params={title:app.vtranslate('JS_MESSAGE'),text:data.result.message,type:'error'};Vtiger_Helper_Js.showPnotify(params);var url=Portal_List_Js.getDefaultParams();Portal_List_Js.loadListViewContent(url);}});});}else listInstance.noRecordSelectedAlert();},loadListViewContent:function loadListViewContent(url){var progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.requestPjax(url).done(function(data){progressIndicatorElement.progressIndicator({mode:'hide'}),jQuery('#listViewContents').html(data),Portal_List_Js.updatePagination();});},updatePagination:function updatePagination(){var previousPageExist=jQuery('#previousPageExist').val(),nextPageExist=jQuery('#nextPageExist').val(),previousPageButton=jQuery('#previousPageButton'),nextPageButton=jQuery('#nextPageButton'),listViewEntriesCount=parseInt(jQuery('#noOfEntries').val()),pageStartRange=parseInt(jQuery('#pageStartRange').val()),pageEndRange=parseInt(jQuery('#pageEndRange').val()),pages=jQuery('#totalPageCount').text(),totalNumberOfRecords=jQuery('.totalNumberOfRecords'),pageNumbersTextElem=jQuery('.pageNumbersText'),currentPage=parseInt(jQuery('#pageNumber').val());if(jQuery('#pageToJump').val(currentPage),''==previousPageExist?''==previousPageExist&&previousPageButton.attr('disabled','disabled'):previousPageButton.removeAttr('disabled'),''!=nextPageExist&&1<pages?nextPageButton.removeAttr('disabled'):(''==nextPageExist||1==pages)&&nextPageButton.attr('disabled','disabled'),0!=listViewEntriesCount){pageNumbersTextElem.html(pageStartRange+' ('+pageEndRange+')'),totalNumberOfRecords.removeClass('d-none');}else pageNumbersTextElem.html('<span>&nbsp;</span>'),totalNumberOfRecords.hasClass('d-none')||totalNumberOfRecords.addClass('d-none');}},{registerAddBookmark:function registerAddBookmark(){jQuery('.addBookmark').on('click',function(){var params={module:app.getModuleName(),parent:app.getParentModuleName(),view:'EditAjax'};Portal_List_Js.editBookmark(params);});},registerEditBookmark:function registerEditBookmark(){jQuery('.editRecord').on('click',function(e){e.stopPropagation();var currentTarget=jQuery(e.currentTarget),id=currentTarget.closest('.listViewEntries').data('id'),params={module:app.getModuleName(),parent:app.getParentModuleName(),view:'EditAjax',record:id};Portal_List_Js.editBookmark(params);});},registerDeleteBookmark:function registerDeleteBookmark(){jQuery('.deleteRecord').on('click',function(e){e.stopPropagation(),e.preventDefault();var currentTarget=jQuery(e.currentTarget),id=currentTarget.closest('.listViewEntries').data('id'),message=app.vtranslate('LBL_DELETE_CONFIRMATION');Vtiger_Helper_Js.showConfirmationBox({message:message}).done(function(){var params={module:app.getModuleName(),parent:app.getParentModuleName(),action:'DeleteAjax',record:id};AppConnector.request(params).done(function(data){if(data.success){var params={title:app.vtranslate('JS_MESSAGE'),text:data.result.message,type:'success'};Vtiger_Helper_Js.showPnotify(params);var url=Portal_List_Js.getDefaultParams();Portal_List_Js.loadListViewContent(url);}});});});},registerAlphabetSearch:function registerAlphabetSearch(){jQuery('.portalAlphabetSearch').on('click',function(e){var currentTarget=jQuery(e.currentTarget),searchValue=currentTarget.find('a').attr('id'),url=Portal_List_Js.getDefaultParams();url.search_value=searchValue,Portal_List_Js.loadListViewContent(url);});},registerSortingEvent:function registerSortingEvent(){jQuery('.portalListViewHeader').on('click',function(e){var currentTarget=jQuery(e.currentTarget),orderBy=currentTarget.attr('id'),sortOrder=currentTarget.data('nextsortorderval'),url=Portal_List_Js.getDefaultParams();url.orderby=orderBy,url.sortorder=sortOrder,Portal_List_Js.loadListViewContent(url);});},registerPreviousPageEvent:function registerPreviousPageEvent(){jQuery('#previousPageButton').on('click',function(){var currentPage=jQuery('#pageNumber').val(),previousPage=parseInt(currentPage)-1;if(1>previousPage)return !1;var url=Portal_List_Js.getDefaultParams();url.page=previousPage,Portal_List_Js.loadListViewContent(url);});},registerNextPageEvent:function registerNextPageEvent(){jQuery('#nextPageButton').on('click',function(){var currentPage=jQuery('#pageNumber').val(),nextPage=parseInt(currentPage)+1,totalPages=parseInt(jQuery('#totalPageCount').text());if(nextPage>totalPages)return !1;var url=Portal_List_Js.getDefaultParams();url.page=nextPage,Portal_List_Js.loadListViewContent(url);});},registerRowClickEvent:function registerRowClickEvent(){jQuery('.listViewEntries').on('click',function(e){if(!jQuery(e.target,jQuery(e.currentTarget)).is('td:first-child')&&!jQuery(e.target).is('input[type="checkbox"]')){var elem=jQuery(e.currentTarget),recordUrl=elem.data('recordurl');'undefined'==typeof recordUrl||(window.location.href=recordUrl);}});},registerEvents:function registerEvents(){this._super(),this.registerAddBookmark(),this.registerEditBookmark(),this.registerDeleteBookmark(),this.registerAlphabetSearch(),this.registerSortingEvent(),this.registerPreviousPageEvent(),this.registerNextPageEvent(),this.registerRowClickEvent();}});
//# sourceMappingURL=List.min.js.map
