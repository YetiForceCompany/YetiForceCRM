{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_List_Js(\"RecycleBin_List_Js\", {\n\t/**\n\t * Mass activation trigerred on the list\n\t */\n\tmassActivation: function () {\n\t\tconst self = this;\n\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\tmessage: app.vtranslate('JS_ACTIVATE_RECORD_DESC'),\n\t\t\ttitle: app.vtranslate('JS_MASS_ACTIVATE')\n\t\t}).done(function (e) {\n\t\t\tlet params = self.getSelectedRecordsParams(),\n\t\t\t\tlistInstance = Vtiger_List_Js.getInstance(),\n\t\t\t\tcontainer = listInstance.getListViewContainer();\n\t\t\tparams.module = container.find('.js-source-module').val();\n\t\t\tparams.state = 'Active';\n\t\t\tparams.entityState = 'Trash';\n\t\t\tparams.action = 'MassState';\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tif (data && data.result && data.result.notify) {\n\t\t\t\t\tVtiger_Helper_Js.showMessage(data.result.notify);\n\t\t\t\t}\n\t\t\t\tlistInstance.getListViewRecords({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tview: 'List',\n\t\t\t\t\tparent: app.getModuleName(),\n\t\t\t\t\tsourceModule: container.find('.js-source-module').val()\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Mass delete trigerred on the list\n\t */\n\tmassDelete: function () {\n\t\tconst self = this;\n\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\tmessage: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD_DESC'),\n\t\t\ttitle: app.vtranslate('JS_MASS_DELETE')\n\t\t}).done(function (e) {\n\t\t\tlet params = self.getSelectedRecordsParams(),\n\t\t\t\tlistInstance = Vtiger_List_Js.getInstance(),\n\t\t\t\tcontainer = listInstance.getListViewContainer();\n\t\t\tparams.module = container.find('.js-source-module').val();\n\t\t\tparams.sourceModule = container.find('.js-source-module').val();\n\t\t\tparams.action = 'MassDelete';\n\t\t\tparams.entityState = 'Trash';\n\t\t\tparams.viewname = 'undefined';\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tif (data && data.result && data.result.notify) {\n\t\t\t\t\tVtiger_Helper_Js.showMessage(data.result.notify);\n\t\t\t\t}\n\t\t\t\tlistInstance.getListViewRecords({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tview: 'List',\n\t\t\t\t\tparent: app.getModuleName(),\n\t\t\t\t\tsourceModule: container.find('.js-source-module').val()\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\n}, {\n\t/**\n\t * Register module select\n\t */\n\tregisterModuleFilter: function () {\n\t\tconst self = this,\n\t\t\tcontainer = this.getListViewContainer();\n\t\tlet filterSelectElement = container.find('.js-source-module');\n\t\tfilterSelectElement.on('select2:selecting', function (e) {\n\t\t\tself.getListViewRecords({\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tview: 'List',\n\t\t\t\tparent: app.getModuleName(),\n\t\t\t\tsourceModule: e.params.args.data.id\n\t\t\t}).done(function () {\n\t\t\t\tself.calculatePages().done(function () {\n\t\t\t\t\tcontainer.find('.js-pagination-list').data('totalCount', '');\n\t\t\t\t\tself.updatePagination();\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function to update pagination page numer\n\t * @param {boolean} force\n\t */\n\tupdatePaginationAjax(force = false) {\n\t\tconst self = this,\n\t\t\tlistViewPageDiv = this.getListViewContainer();\n\t\tlet params = self.getDefaultParams(),\n\t\t\tcontainer = listViewPageDiv.find('.paginationDiv');\n\t\tVtiger_Helper_Js.showMessage({\n\t\t\ttitle: app.vtranslate('JS_LBL_PERMISSION'),\n\t\t\ttext: app.vtranslate('JS_GET_PAGINATION_INFO'),\n\t\t\ttype: 'info',\n\t\t});\n\t\tif (container.find('.js-pagination-list').data('total-count') > 0 || force) {\n\t\t\tparams.totalCount = '-1';\n\t\t\tparams.view = 'Pagination';\n\t\t\tparams.mode = 'getPagination';\n\t\t\tparams.entityState = 'Trash';\n\t\t\tparams.module = listViewPageDiv.find('.js-source-module').val();\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tcontainer.html(data);\n\t\t\t\tself.registerPageNavigationEvents();\n\t\t\t});\n\t\t}\n\t},\n\t/**\n\t * Register empty recycle button\n\t */\n\tregisterEmptyRecycle: function () {\n\t\tconst self = this,\n\t\t\tcontainer = this.getListViewContainer();\n\t\tcontainer.find('.js-recycle-empty').on('click', function () {\n\t\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\t\tmessage: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD_DESC'),\n\t\t\t\ttitle: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD')\n\t\t\t}).done(function (e) {\n\t\t\t\tlet progressIndicatorElement = $.progressIndicator();\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'RecycleBin',\n\t\t\t\t\tsourceModule: container.find('.js-source-module').val(),\n\t\t\t\t\taction: 'MassDeleteAll',\n\t\t\t\t\tsourceView: 'List'\n\t\t\t\t}).done(function (data) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({mode: 'hide'});\n\t\t\t\t\tlet result = {\n\t\t\t\t\t\ttext: app.vtranslate('JS_FAILED_TO_SAVE')\n\t\t\t\t\t};\n\t\t\t\t\tif (data && data.result) {\n\t\t\t\t\t\tresult = {\n\t\t\t\t\t\t\ttext: app.vtranslate('JS_ADDED_TO_QUEUE'),\n\t\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tVtiger_Helper_Js.showMessage(result);\n\t\t\t\t\tself.getListViewRecords();\n\t\t\t\t}).fail(function (error, err) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({mode: 'hide'});\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Get record list of actual selected module\n\t * @param {string} urlParams\n\t * @returns {*|jQuery}\n\t */\n\tgetListViewRecords: function (urlParams) {\n\t\tlet overrideUrlParams = {},\n\t\t\taDeferred = $.Deferred();\n\t\toverrideUrlParams.sourceModule = $('.js-source-module').val();\n\t\turlParams = $.extend(overrideUrlParams, urlParams);\n\t\tthis._super(urlParams).done(function () {\n\t\t\taDeferred.resolve();\n\t\t}).fail(function (textStatus, errorThrown) {\n\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\tregisterEvents: function () {\n\t\tthis._super();\n\t\tthis.registerModuleFilter();\n\t\tthis.registerEmptyRecycle();\n\t}\n});\n"],"names":["Vtiger_List_Js","massActivation","Vtiger_Helper_Js","showConfirmationBox","message","app","vtranslate","title","done","self","getSelectedRecordsParams","listInstance","getInstance","container","getListViewContainer","params","module","find","val","state","entityState","action","AppConnector","request","data","result","notify","showMessage","getListViewRecords","getModuleName","view","parent","sourceModule","massDelete","viewname","registerModuleFilter","filterSelectElement","on","e","args","id","calculatePages","updatePagination","updatePaginationAjax","listViewPageDiv","getDefaultParams","text","type","force","totalCount","mode","html","registerPageNavigationEvents","registerEmptyRecycle","$","progressIndicator","sourceView","progressIndicatorElement","fail","urlParams","aDeferred","Deferred","extend","overrideUrlParams","_super","resolve","textStatus","errorThrown","reject","promise","registerEvents"],"mappings":"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"}