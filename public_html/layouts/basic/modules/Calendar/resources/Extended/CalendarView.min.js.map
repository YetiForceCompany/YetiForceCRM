{"version":3,"file":"CalendarView.min.js","sources":["CalendarView.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n/**\n *  Class representing an extended calendar.\n * @extends Calendar_Calendar_Js\n */\nwindow.calendarLoaded = false; //Global calendar flag needed for correct loading data from history browser in year view\nwindow.Calendar_CalendarExtended_Js = class Calendar_CalendarExtended_Js extends Calendar_Calendar_Js {\n\tconstructor(container, readonly) {\n\t\tsuper(container, readonly);\n\t\tthis.sidebarView = {\n\t\t\tlength: 0\n\t\t};\n\t\tthis.calendarContainer = false;\n\t\tthis.addCommonMethodsToYearView();\n\t\tthis.calendar = this.getCalendarView();\n\t}\n\n\t/**\n\t * Function extends FC.views.year with current class methods\n\t */\n\taddCommonMethodsToYearView() {\n\t\tconst self = this;\n\t\tFC.views.year = FC.views.year.extend({\n\t\t\tbaseInstance: self,\n\t\t\tselectDays: self.selectDays,\n\t\t\tgetCalendarCreateView: self.getCalendarCreateView,\n\t\t\tgetSidebarView: self.getSidebarView,\n\t\t\tgetCurrentCvId: self.getCurrentCvId,\n\t\t\tgetCalendarView: self.getCalendarView,\n\t\t\tshowRightPanelForm: self.showRightPanelForm,\n\t\t\tgetSelectedUsersCalendar: self.getSelectedUsersCalendar,\n\t\t\tregisterClearFilterButton: self.registerClearFilterButton,\n\t\t\tclearFilterButton: self.clearFilterButton,\n\t\t\tregisterFilterTabChange: self.registerFilterTabChange,\n\t\t\tsidebarView: self.sidebarView,\n\t\t\tregisterAfterSubmitForm: self.registerAfterSubmitForm,\n\t\t\tregisterViewRenderEvents: self.registerViewRenderEvents,\n\t\t\tappendSubDateRow: self.appendSubDateRow,\n\t\t\trefreshDatesRowView: self.refreshDatesRowView,\n\t\t\tgenerateYearList: self.generateYearList,\n\t\t\tupdateCountTaskCalendar: self.updateCountTaskCalendar,\n\t\t\tregisterDatesChange: self.registerDatesChange,\n\t\t\taddHeaderButtons: self.addHeaderButtons,\n\t\t\tbrowserHistoryConfig: self.browserHistoryConfig,\n\t\t\treadonly: self.readonly,\n\t\t\tcontainer: self.container,\n\t\t\tmodule: self.module,\n\t\t\tshowChangeDateButtons: self.showChangeDateButtons,\n\t\t\tshowTodayButtonCheckbox: self.showTodayButtonCheckbox,\n\t\t\tgetDefaultParams: self.getDefaultParams\n\t\t});\n\t}\n\n\t/**\n\t * Render calendar\n\t */\n\trenderCalendar() {\n\t\tlet self = this,\n\t\t\tbasicOptions = this.setCalendarOptions(),\n\t\t\toptions = {\n\t\t\t\theader: {\n\t\t\t\t\tleft: 'year,month,' + app.getMainParams('weekView') + ',' + app.getMainParams('dayView'),\n\t\t\t\t\tcenter: 'prevYear,prev,title,next,nextYear',\n\t\t\t\t\tright: 'today'\n\t\t\t\t},\n\t\t\t\tviews: {\n\t\t\t\t\tbasic: {\n\t\t\t\t\t\teventLimit: false\n\t\t\t\t\t},\n\t\t\t\t\tyear: {\n\t\t\t\t\t\teventLimit: 10,\n\t\t\t\t\t\teventLimitText: app.vtranslate('JS_COUNT_RECORDS'),\n\t\t\t\t\t\ttitleFormat: 'YYYY',\n\t\t\t\t\t\tselect: function (start, end) {},\n\t\t\t\t\t\tloadView: function () {\n\t\t\t\t\t\t\tself.getCalendarView().fullCalendar('getCalendar').view.render();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tmonth: {\n\t\t\t\t\t\ttitleFormat: this.parseDateFormat('month'),\n\t\t\t\t\t\tloadView: function () {\n\t\t\t\t\t\t\tself.loadCalendarData();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tweek: {\n\t\t\t\t\t\ttitleFormat: this.parseDateFormat('week'),\n\t\t\t\t\t\tloadView: function () {\n\t\t\t\t\t\t\tself.loadCalendarData();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tday: {\n\t\t\t\t\t\ttitleFormat: this.parseDateFormat('day'),\n\t\t\t\t\t\tloadView: function () {\n\t\t\t\t\t\t\tself.loadCalendarData();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tbasicDay: {\n\t\t\t\t\t\ttype: 'agendaDay',\n\t\t\t\t\t\tloadView: function () {\n\t\t\t\t\t\t\tself.loadCalendarData();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tselect: function (start, end) {\n\t\t\t\t\tself.selectDays(start, end);\n\t\t\t\t\tself.getCalendarView().fullCalendar('unselect');\n\t\t\t\t},\n\t\t\t\teventRender: function (event, element) {\n\t\t\t\t\tself.eventRenderer(event, element);\n\t\t\t\t},\n\t\t\t\tviewRender: function (view, element) {\n\t\t\t\t\tif (view.type !== 'year') {\n\t\t\t\t\t\tself.loadCalendarData(view);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\taddCalendarEvent(calendarDetails) {\n\t\t\t\t\tself.getCalendarView().fullCalendar('renderEvent', self.getEventData(calendarDetails));\n\t\t\t\t}\n\t\t\t};\n\t\toptions = Object.assign(basicOptions, options);\n\t\tif (!this.readonly && self.eventEdit) {\n\t\t\toptions.eventClick = function (calEvent, jsEvent) {\n\t\t\t\tjsEvent.preventDefault();\n\t\t\t\tself.getCalendarSidebarData($(this).attr('href'));\n\t\t\t};\n\t\t} else {\n\t\t\toptions.eventClick = function (calEvent, jsEvent) {\n\t\t\t\tjsEvent.preventDefault();\n\t\t\t\tconst link = new URL($(this)[0].href);\n\t\t\t\twindow.location.assign(`index.php?module=${this.module}&view=Detail&record=${link.searchParams.get('record')}`);\n\t\t\t};\n\t\t}\n\t\tthis.calendar.fullCalendar(options);\n\t}\n\n\tregisterChangeView() {}\n\n\taddHeaderButtons() {\n\t\tif (this.calendarContainer.find('.js-calendar__view-btn').length) {\n\t\t\treturn;\n\t\t}\n\t\tlet buttonsContainer = this.calendarContainer.prev('.js-calendar__header-buttons'),\n\t\t\tviewBtn = buttonsContainer.find('.js-calendar__view-btn').clone(),\n\t\t\tfilters = buttonsContainer.find('.js-calendar__filter-container').clone();\n\t\tthis.calendarContainer.find('.fc-left').prepend(viewBtn);\n\t\tthis.calendarContainer.find('.fc-center').after(filters);\n\t\tthis.registerClearFilterButton();\n\t\tthis.registerFilterTabChange();\n\t}\n\n\tregisterSwitchEvents() {\n\t\tconst calendarView = this.getCalendarView();\n\t\tlet changeDaysState,\n\t\t\tchangeType,\n\t\t\tswitchContainer = $('.js-calendar__tab--filters'),\n\t\t\tswitchShowType = switchContainer.find('.js-switch--showType'),\n\t\t\tshowTypeState = switchShowType.find('.js-switch--label-on.active').length ? 'current' : 'history',\n\t\t\tswitchSwitchingDays = switchContainer.find('.js-switch--switchingDays'),\n\t\t\tswitchingDaysState = switchSwitchingDays.find('input:checked').data('val');\n\t\tlet historyParams = app.getMainParams('historyParams', true);\n\t\tif (historyParams === '') {\n\t\t\tchangeDaysState = app.getMainParams('switchingDays');\n\t\t\tchangeType = app.getMainParams('showType');\n\t\t} else {\n\t\t\tchangeType = historyParams.time !== undefined ? historyParams.time : app.getMainParams('showType');\n\t\t\tchangeDaysState = historyParams.hiddenDays === '' ? 'all' : 'workDays';\n\t\t}\n\t\tif (switchShowType.length) {\n\t\t\tswitchShowType.on('change', 'input', (e) => {\n\t\t\t\tconst currentTarget = $(e.currentTarget);\n\t\t\t\tif (typeof currentTarget.data('on-text') !== 'undefined') {\n\t\t\t\t\tapp.setMainParams('showType', 'current');\n\t\t\t\t\tapp.moduleCacheSet('defaultShowType', 'current');\n\t\t\t\t} else if (typeof currentTarget.data('off-text') !== 'undefined') {\n\t\t\t\t\tapp.setMainParams('showType', 'history');\n\t\t\t\t\tapp.moduleCacheSet('defaultShowType', 'history');\n\t\t\t\t}\n\t\t\t\tcalendarView.fullCalendar('getCalendar').view.options.loadView();\n\t\t\t});\n\t\t\tif (app.getMainParams('showType') !== changeType) {\n\t\t\t\t$('input[data-val=\"' + changeType + '\"]', switchShowType).trigger('change');\n\t\t\t}\n\t\t}\n\t\tif (switchSwitchingDays.length) {\n\t\t\tswitchSwitchingDays.on('change', 'input', (e) => {\n\t\t\t\tconst currentTarget = $(e.currentTarget);\n\t\t\t\tlet hiddenDays = [];\n\t\t\t\tif (typeof currentTarget.data('on-text') !== 'undefined') {\n\t\t\t\t\tapp.setMainParams('switchingDays', 'workDays');\n\t\t\t\t\tapp.moduleCacheSet('defaultSwitchingDays', 'workDays');\n\t\t\t\t\thiddenDays = app.getMainParams('hiddenDays', true);\n\t\t\t\t} else if (typeof currentTarget.data('off-text') !== 'undefined') {\n\t\t\t\t\tapp.setMainParams('switchingDays', 'all');\n\t\t\t\t\tapp.moduleCacheSet('defaultSwitchingDays', 'all');\n\t\t\t\t}\n\t\t\t\tcalendarView.fullCalendar('option', 'hiddenDays', hiddenDays);\n\t\t\t\tcalendarView.fullCalendar('option', 'height', this.setCalendarHeight());\n\t\t\t\tif (calendarView.fullCalendar('getView').type === 'year') {\n\t\t\t\t\tthis.registerViewRenderEvents(calendarView.fullCalendar('getView'));\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (app.getMainParams('switchingDays') !== changeDaysState) {\n\t\t\t\t$('input[data-val=\"' + changeDaysState + '\"]', switchSwitchingDays).trigger('change');\n\t\t\t} else if (changeDaysState !== switchingDaysState) {\n\t\t\t\t// TODO\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Appends subdate row to calendar header and register its scroll\n\t * @param toolbar\n\t */\n\tappendSubDateRow(toolbar) {\n\t\tif (!this.calendarContainer.find('.js-dates-row').length) {\n\t\t\tthis.subDateRow = $(`\n\t\t\t\t\t\t\t\t<div class=\"js-scroll js-dates-row u-overflow-auto-lg-down order-4 flex-grow-1 position-relative my-1 w-100\" data-js=\"perfectScrollbar | container\">\n\t\t\t\t\t\t\t\t\t<div class=\"d-flex flex-nowrap w-100\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"js-sub-date-list w-100 sub-date-list row no-gutters flex-nowrap nav nav-tabs\" data-js=\"data-type\"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t`);\n\t\t\ttoolbar.append(this.subDateRow);\n\t\t\tif ($(window).width() > app.breakpoints.lg) {\n\t\t\t\tapp.showNewScrollbar(this.subDateRow);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Function toggles next year/month and general arrows on view render\n\t * @param view\n\t * @param element\n\t */\n\tregisterViewRenderEvents(view) {\n\t\tthis.calendarContainer = this.getCalendarView();\n\t\tlet toolbar = this.calendarContainer.find('.fc-toolbar.fc-header-toolbar');\n\t\tthis.showChangeDateButtons(view, toolbar);\n\t\tthis.appendSubDateRow(toolbar);\n\t\tthis.refreshDatesRowView(view);\n\t\tthis.addHeaderButtons();\n\t\tthis.showTodayButtonCheckbox(toolbar);\n\t}\n\n\t/**\n\t * Function appends and shows today button's checkbox\n\t * @param {jQuery} toolbar\n\t */\n\tshowTodayButtonCheckbox(toolbar) {\n\t\tlet todayButton = toolbar.find('.fc-today-button'),\n\t\t\ttodyButtonIcon = todayButton.hasClass('fc-state-disabled') ? 'fa-calendar-check' : 'fa-calendar',\n\t\t\tpopoverContent = `${app.vtranslate('JS_CURRENT')} ${toolbar.find('.fc-state-active').text().toLowerCase()}`;\n\t\ttodayButton.removeClass('.fc-button');\n\t\ttodayButton.html(\n\t\t\t`<div class=\"js-popover-tooltip--day-btn\" data-toggle=\"popover\"><span class=\"far fa-lg ${todyButtonIcon}\"></span></div>`\n\t\t);\n\t\tapp.showPopoverElementView(todayButton.find('.js-popover-tooltip--day-btn'), {\n\t\t\tcontent: popoverContent,\n\t\t\tcontainer: '.fc-today-button .js-popover-tooltip--day-btn'\n\t\t});\n\t}\n\n\t/**\n\t * Function shows change date buttons in calendar's header for specific view\n\t * @param view\n\t * @param toolbar\n\t */\n\tshowChangeDateButtons(view, toolbar) {\n\t\tlet viewType = view.type.replace(/basic|agenda/g, '').toLowerCase(),\n\t\t\tnextPrevButtons = toolbar.find('.fc-prev-button, .fc-next-button'),\n\t\t\tyearButtons = toolbar.find('.fc-prevYear-button, .fc-nextYear-button');\n\t\tif (!window.calendarLoaded) {\n\t\t\tyearButtons.first().html(`<span class=\"fas fa-xs fa-minus mr-1\"></span>${view.options.buttonText['year']}`);\n\t\t\tyearButtons.last().html(`${view.options.buttonText['year']}<span class=\"fas fa-xs fa-plus ml-1\"></span>`);\n\t\t}\n\t\tif (view.type !== 'year') {\n\t\t\tnextPrevButtons.first().html(`<span class=\"fas fa-xs fa-minus mr-1\"></span>${view.options.buttonText[viewType]}`);\n\t\t\tnextPrevButtons.last().html(`${view.options.buttonText[viewType]}<span class=\"fas fa-xs fa-plus ml-1\"></span>`);\n\t\t}\n\t\tif (view.type === 'year') {\n\t\t\tnextPrevButtons.hide();\n\t\t\tyearButtons.show();\n\t\t} else if (view.type === 'month') {\n\t\t\tnextPrevButtons.show();\n\t\t\tyearButtons.show();\n\t\t} else {\n\t\t\tnextPrevButtons.show();\n\t\t\tyearButtons.hide();\n\t\t}\n\t}\n\n\t/**\n\t * Date bar with counts\n\t * @param object calendarView\n\t */\n\trefreshDatesRowView(calendarView) {\n\t\tconst self = this;\n\t\tswitch (calendarView.type) {\n\t\t\tcase 'year':\n\t\t\t\tself.generateYearList(calendarView.intervalStart, calendarView.intervalEnd);\n\t\t\t\tbreak;\n\t\t\tcase 'month':\n\t\t\t\tself.generateSubMonthList(calendarView.intervalStart, calendarView.intervalEnd);\n\t\t\t\tbreak;\n\t\t\tcase 'week':\n\t\t\tcase 'agendaWeek':\n\t\t\t\tself.generateSubWeekList(calendarView.start, calendarView.end);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tself.generateSubDaysList(calendarView.start, calendarView.end);\n\t\t}\n\t\tself.updateCountTaskCalendar();\n\t\tself.registerDatesChange();\n\t}\n\n\tregisterDatesChange() {\n\t\tthis.container.find('.js-dates-row .js-sub-record').on('click', (e) => {\n\t\t\tlet currentTarget = $(e.currentTarget);\n\t\t\tcurrentTarget.addClass('active');\n\t\t\tthis.getCalendarView().fullCalendar('gotoDate', moment(currentTarget.data('date'), 'YYYY-MM-DD'));\n\t\t});\n\t}\n\n\tgetCurrentCvId() {\n\t\treturn $('.js-calendar__extended-filter-tab .active').parent('.js-filter-tab').data('cvid');\n\t}\n\n\tregisterFilterTabChange() {\n\t\tconst thisInstance = this;\n\t\tthis.getCalendarView()\n\t\t\t.find('.js-calendar__extended-filter-tab')\n\t\t\t.on('shown.bs.tab', function () {\n\t\t\t\tthisInstance.getCalendarView().fullCalendar('getCalendar').view.options.loadView();\n\t\t\t});\n\t}\n\n\tgetSelectedUsersCalendar() {\n\t\tconst sidebar = this.getSidebarView();\n\t\tlet selectedUsers = sidebar.find('.js-input-user-owner-id:checked'),\n\t\t\tselectedUsersAjax = sidebar.find('.js-input-user-owner-id-ajax'),\n\t\t\tselectedRolesAjax = sidebar.find('.js-input-role-owner-id-ajax'),\n\t\t\tusers = [];\n\t\tif (selectedUsers.length > 0) {\n\t\t\tselectedUsers.each(function () {\n\t\t\t\tusers.push($(this).val());\n\t\t\t});\n\t\t} else if (selectedUsersAjax.length > 0) {\n\t\t\tusers = selectedUsersAjax.val().concat(selectedRolesAjax.val());\n\t\t}\n\t\treturn users;\n\t}\n\n\tgetSidebarView() {\n\t\tif (!this.sidebarView || !this.sidebarView.length) {\n\t\t\tthis.sidebarView = this.container.find('.js-calendar-right-panel');\n\t\t}\n\t\treturn this.sidebarView;\n\t}\n\n\tupdateCountTaskCalendar() {\n\t\tlet datesView = this.container.find('.js-dates-row'),\n\t\t\tsubDatesElements = datesView.find('.js-sub-record'),\n\t\t\tdateArray = {},\n\t\t\tuserDateFormat = CONFIG.dateFormat.toUpperCase(),\n\t\t\tuser = this.getSelectedUsersCalendar();\n\t\tif (user.length === 0) {\n\t\t\tuser = app.getMainParams('usersId');\n\t\t}\n\t\tif (user === undefined) {\n\t\t\tuser = [app.getMainParams('userId')];\n\t\t}\n\t\tsubDatesElements.each(function (key, element) {\n\t\t\tlet data = $(this).data('date'),\n\t\t\t\ttype = $(this).data('type');\n\t\t\tif (type === 'years') {\n\t\t\t\tdateArray[key] = [\n\t\t\t\t\tmoment(data + '-01').format(userDateFormat) + ' 00:00:00',\n\t\t\t\t\tmoment(data + '-01')\n\t\t\t\t\t\t.endOf('year')\n\t\t\t\t\t\t.format(userDateFormat) + ' 23:59:59'\n\t\t\t\t];\n\t\t\t} else if (type === 'months') {\n\t\t\t\tdateArray[key] = [\n\t\t\t\t\tmoment(data).format(userDateFormat) + ' 00:00:00',\n\t\t\t\t\tmoment(data).endOf('month').format(userDateFormat) + ' 23:59:59'\n\t\t\t\t];\n\t\t\t} else if (type === 'weeks') {\n\t\t\t\tdateArray[key] = [\n\t\t\t\t\tmoment(data).format(userDateFormat) + ' 00:00:00',\n\t\t\t\t\tmoment(data).add(6, 'day').format(userDateFormat) + ' 23:59:59'\n\t\t\t\t];\n\t\t\t} else if (type === 'days') {\n\t\t\t\tdateArray[key] = [\n\t\t\t\t\tmoment(data).format(userDateFormat) + ' 00:00:00',\n\t\t\t\t\tmoment(data).format(userDateFormat) + ' 23:59:59'\n\t\t\t\t];\n\t\t\t}\n\t\t});\n\t\tAppConnector.request({\n\t\t\tmodule: this.module,\n\t\t\taction: 'Calendar',\n\t\t\tmode: 'getCountEventsGroup',\n\t\t\tdates: dateArray,\n\t\t\tuser: user,\n\t\t\ttime: app.getMainParams('showType'),\n\t\t\tcvid: this.getCurrentCvId()\n\t\t}).done(function (events) {\n\t\t\tsubDatesElements.each(function (key, element) {\n\t\t\t\t$(this).find('.js-count-events').removeClass('hide').html(events.result[key]);\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Register events to EditView\n\t * @param {jQuery} sideBar\n\t */\n\tregisterEditForm(sideBar) {\n\t\tlet editViewInstance = Vtiger_Edit_Js.getInstanceByModuleName(sideBar.find('[name=\"module\"]').val()),\n\t\t\tparams = [];\n\t\tlet rightFormCreate = sideBar.find('form.js-form');\n\t\teditViewInstance.registerBasicEvents(rightFormCreate);\n\t\trightFormCreate.validationEngine(app.validationEngineOptions);\n\t\tApp.Fields.Picklist.showSelect2ElementView(sideBar.find('select'));\n\t\tsideBar.find('.js-summary-close-edit').on('click', () => {\n\t\t\tthis.getCalendarCreateView();\n\t\t});\n\t\tparams.callbackFunction = this.registerAfterSubmitForm(this, rightFormCreate);\n\t\tApp.Components.QuickCreate.registerPostLoadEvents(rightFormCreate, params);\n\t\tnew App.Fields.Text.Editor(sideBar.find('.js-editor'), { height: '5em', toolbar: 'Min' });\n\t}\n\n\t/**\n\t * EditView\n\t * @param {Object}|{number} params\n\t */\n\tgetCalendarSidebarData(params) {\n\t\tconst thisInstance = this,\n\t\t\taDeferred = $.Deferred();\n\t\tconst progressInstance = $.progressIndicator({ blockInfo: { enabled: true } });\n\t\tif ($.isNumeric(params)) {\n\t\t\tparams = {\n\t\t\t\tmodule: this.module,\n\t\t\t\tview: 'EventForm',\n\t\t\t\trecord: params\n\t\t\t};\n\t\t}\n\t\tAppConnector.request(params)\n\t\t\t.done((data) => {\n\t\t\t\tthisInstance.openRightPanel();\n\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t\tlet sidebar = thisInstance.getSidebarView();\n\t\t\t\tthis.updateSidebar(sidebar, data);\n\t\t\t\tif (sidebar.find('form').length) {\n\t\t\t\t\tthisInstance.registerEditForm(sidebar);\n\t\t\t\t} else {\n\t\t\t\t\tapp.showNewScrollbar(sidebar.find('.js-calendar__form__wrapper'), {\n\t\t\t\t\t\tsuppressScrollX: true\n\t\t\t\t\t});\n\t\t\t\t\tsidebar.find('.js-activity-state .js-summary-close-edit').on('click', function () {\n\t\t\t\t\t\tthisInstance.getCalendarCreateView();\n\t\t\t\t\t});\n\t\t\t\t\tsidebar.find('.js-activity-state .editRecord').on('click', function () {\n\t\t\t\t\t\tthisInstance.getCalendarSidebarData($(this).data('id'));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\taDeferred.resolve(sidebar.find('.js-qc-form'));\n\t\t\t})\n\t\t\t.fail((error) => {\n\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t\tapp.errorLog(error);\n\t\t\t});\n\t\treturn aDeferred.promise();\n\t}\n\n\t/**\n\t * Update sidebar\n\t * @param {jQuery} sidebar\n\t * @param {html} data\n\t */\n\tupdateSidebar(sidebar, data) {\n\t\tsidebar.find('.js-qc-form').html(data);\n\t\tthis.showRightPanelForm();\n\t}\n\tloadCalendarData(view = this.getCalendarView().fullCalendar('getView')) {\n\t\tconst self = this;\n\t\tlet formatDate = CONFIG.dateFormat.toUpperCase(),\n\t\t\tcvid = self.getCurrentCvId(),\n\t\t\tcalendarInstance = this.getCalendarView();\n\t\tcalendarInstance.fullCalendar('removeEvents');\n\t\tlet progressInstance = $.progressIndicator({ blockInfo: { enabled: true } }),\n\t\t\tuser = self.getSelectedUsersCalendar();\n\t\tif (0 === user.length) {\n\t\t\tuser = app.getMainParams('usersId');\n\t\t}\n\t\tif (user === undefined) {\n\t\t\tuser = [app.getMainParams('userId')];\n\t\t}\n\t\tself.clearFilterButton(user, cvid);\n\t\tif (view.type === 'agendaDay') {\n\t\t\tview.end = view.end.add(1, 'day');\n\t\t}\n\t\tlet time = this.getSidebarView().find('.js-switch--showType input:checked').data('val');\n\t\tlet options = {\n\t\t\tmodule: this.module,\n\t\t\taction: 'Calendar',\n\t\t\tmode: 'getEvents',\n\t\t\tstart: view.start.format(formatDate),\n\t\t\tend: view.end.format(formatDate),\n\t\t\tuser: user,\n\t\t\ttime: time !== undefined ? time : app.getMainParams('showType'),\n\t\t\tcvid: cvid,\n\t\t\thistoryUrl: `index.php?module=${this.module}&view=CalendarExtended&history=true&viewType=${\n\t\t\t\tview.type\n\t\t\t}&start=${view.start.format(formatDate)}&end=${view.end.format(formatDate)}&user=${user}&time=${app.getMainParams(\n\t\t\t\t'showType'\n\t\t\t)}&cvid=${cvid}&hiddenDays=${view.options.hiddenDays}`\n\t\t};\n\t\tlet connectorMethod = window['AppConnector']['request'];\n\t\tif (this.browserHistory && window.calendarLoaded) {\n\t\t\tconnectorMethod = window['AppConnector']['requestPjax'];\n\t\t}\n\t\tif (this.browserHistoryConfig && Object.keys(this.browserHistoryConfig).length && !window.calendarLoaded) {\n\t\t\toptions = Object.assign(options, {\n\t\t\t\tstart: this.browserHistoryConfig.start,\n\t\t\t\tend: this.browserHistoryConfig.end,\n\t\t\t\tuser: this.browserHistoryConfig.user,\n\t\t\t\ttime: this.browserHistoryConfig.time,\n\t\t\t\tcvid: this.browserHistoryConfig.cvid\n\t\t\t});\n\t\t\tconnectorMethod = window['AppConnector']['request'];\n\t\t\tapp.setMainParams('showType', this.browserHistoryConfig.time);\n\t\t\tapp.setMainParams('usersId', this.browserHistoryConfig.user);\n\t\t}\n\t\tconnectorMethod(options).done((events) => {\n\t\t\tcalendarInstance.fullCalendar('removeEvents');\n\t\t\tcalendarInstance.fullCalendar('addEventSource', events.result);\n\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t});\n\t\tself.registerViewRenderEvents(view);\n\t\twindow.calendarLoaded = true;\n\t}\n\n\tclearFilterButton(user, cvid) {\n\t\tlet currentUser = parseInt(app.getMainParams('userId')),\n\t\t\ttime = app.getMainParams('showType'),\n\t\t\tstatement =\n\t\t\t\t(user.length === 0 || (user.length === 1 && parseInt(user) === currentUser)) &&\n\t\t\t\tcvid === undefined &&\n\t\t\t\ttime === 'current';\n\t\t$('.js-calendar__clear-filters').toggleClass('d-none', statement);\n\t}\n\n\tregisterClearFilterButton() {\n\t\tconst sidebar = this.getSidebarView(),\n\t\t\tcalendarView = this.getCalendarView();\n\t\tlet clearBtn = calendarView.find('.js-calendar__clear-filters');\n\t\tapp.showPopoverElementView(clearBtn);\n\t\tclearBtn.on('click', () => {\n\t\t\t$('.js-calendar__extended-filter-tab a').removeClass('active');\n\t\t\tapp.setMainParams('showType', 'current');\n\t\t\tapp.moduleCacheSet('defaultShowType', 'current');\n\t\t\tsidebar.find('input:checkbox').prop('checked', false);\n\t\t\tsidebar.find('option:selected').prop('selected', false);\n\t\t\tlet calendarSwitch = sidebar.find('.js-switch--showType [class*=\"js-switch--label\"]'),\n\t\t\t\tactualUserCheckbox = sidebar.find('.js-input-user-owner-id[value=' + app.getMainParams('userId') + ']');\n\t\t\tcalendarSwitch.last().removeClass('active');\n\t\t\tcalendarSwitch.first().addClass('active');\n\t\t\t$('input[data-val=\"current\"]', calendarSwitch).prop('checked', true);\n\t\t\tif (actualUserCheckbox.length) {\n\t\t\t\tactualUserCheckbox.prop('checked', true);\n\t\t\t} else {\n\t\t\t\tapp.setMainParams('usersId', undefined);\n\t\t\t}\n\t\t\tcalendarView.fullCalendar('getCalendar').view.options.loadView();\n\t\t});\n\t}\n\n\tgenerateYearList(dateStart, dateEnd) {\n\t\tconst datesView = this.container.find('.js-dates-row');\n\t\tlet prevYear = moment(dateStart).subtract(1, 'year'),\n\t\t\tactualYear = moment(dateStart),\n\t\t\tnextYear = moment(dateStart).add(1, 'year'),\n\t\t\thtml = '',\n\t\t\tactive = '';\n\t\twhile (prevYear <= nextYear) {\n\t\t\tif (prevYear.format('YYYY') === actualYear.format('YYYY')) {\n\t\t\t\tactive = 'active';\n\t\t\t} else {\n\t\t\t\tactive = '';\n\t\t\t}\n\t\t\thtml += `<div class=\"js-sub-record sub-record col-4 nav-item\" data-date=\"${prevYear.format(\n\t\t\t\t'YYYY'\n\t\t\t)}\" data-type=\"years\" data-js=\"click | class: active\">\n\t\t\t\t\t<div class=\"sub-record-content nav-link ${active}\">\n\t\t\t\t\t\t<div class=\"sub-date-name\">\n\t\t\t\t\t\t\t${prevYear.format('YYYY')}\n\t\t\t\t\t\t\t<div class=\"js-count-events count badge c-badge--md ml-1\" data-js=\"html\">0</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`;\n\t\t\tprevYear = moment(prevYear).add(1, 'year');\n\t\t}\n\t\tdatesView.find('.js-sub-date-list').html(html);\n\t}\n\n\tgenerateSubMonthList(dateStart, dateEnd) {\n\t\tlet datesView = this.container.find('.js-dates-row'),\n\t\t\tactiveMonth = parseInt(moment(dateStart).locale('en').format('M')) - 1,\n\t\t\thtml = '',\n\t\t\tactive = '';\n\t\tfor (let month = 0; 12 > month; ++month) {\n\t\t\tif (month === activeMonth) {\n\t\t\t\tactive = 'active';\n\t\t\t} else {\n\t\t\t\tactive = '';\n\t\t\t}\n\t\t\thtml += `<div class=\"js-sub-record sub-record nav-item col-1 px-0\" data-type=\"months\" data-date=\"${moment(\n\t\t\t\tdateStart\n\t\t\t)\n\t\t\t\t.month(month)\n\t\t\t\t.format('YYYY-MM')}\" data-js=\"click | class: active\">\n\t\t\t\t\t<div class=\"sub-record-content nav-link ${active}\">\n\t\t\t\t\t\t<div class=\"sub-date-name\">${App.Fields.Date.monthsTranslated[month]}\n\t\t\t\t\t\t\t<div class=\"js-count-events count badge c-badge--md ml-1\" data-js=\"html\">0</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`;\n\t\t}\n\t\tdatesView.find('.js-sub-date-list').html(html);\n\t}\n\n\tgenerateSubWeekList(dateStart, dateEnd) {\n\t\tlet datesView = this.container.find('.js-dates-row'),\n\t\t\tprevWeeks = moment(dateStart).subtract(5, 'weeks'),\n\t\t\tactualWeek = moment(dateStart).format('WW'),\n\t\t\tnextWeeks = moment(dateStart).add(6, 'weeks'),\n\t\t\thtml = '';\n\t\twhile (prevWeeks <= nextWeeks) {\n\t\t\tlet active = '';\n\t\t\tif (prevWeeks.format('WW') === actualWeek) {\n\t\t\t\tactive = ' active';\n\t\t\t}\n\t\t\thtml +=\n\t\t\t\t'<div class=\"js-sub-record sub-record nav-item col-1 px-0\" data-type=\"weeks\" data-date=\"' +\n\t\t\t\tprevWeeks.format('YYYY-MM-DD') +\n\t\t\t\t'\" data-js=\"click | class: active\">' +\n\t\t\t\t'<div class=\"sub-record-content nav-link' +\n\t\t\t\tactive +\n\t\t\t\t'\">' +\n\t\t\t\t'<div class=\"sub-date-name\">' +\n\t\t\t\tapp.vtranslate('JS_WEEK_SHORT') +\n\t\t\t\t' ' +\n\t\t\t\tprevWeeks.format('WW') +\n\t\t\t\t'<div class=\"js-count-events count badge c-badge--md ml-1\" data-js=\"html\">0</div>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'</div>';\n\t\t\tprevWeeks = moment(prevWeeks).add(1, 'weeks');\n\t\t}\n\t\tdatesView.find('.js-sub-date-list').html(html);\n\t}\n\n\tgenerateSubDaysList(dateStart, dateEnd) {\n\t\tlet datesView = this.container.find('.js-dates-row'),\n\t\t\tprevDays = moment(dateStart).subtract(5, 'days'),\n\t\t\tactualDay = moment(dateStart).format('DDD'),\n\t\t\tnextDays = moment(dateStart).add(7, 'days'),\n\t\t\tdaysToShow = nextDays.diff(prevDays, 'days'),\n\t\t\thtml = '';\n\t\tfor (let day = 0; day < daysToShow; ++day) {\n\t\t\tlet active = '';\n\t\t\tif (app.getMainParams('switchingDays') === 'workDays' && app.moduleCacheGet('defaultSwitchingDays') !== 'all') {\n\t\t\t\tif ($.inArray(prevDays.day(), app.getMainParams('hiddenDays', true)) !== -1) {\n\t\t\t\t\tprevDays = moment(prevDays).add(1, 'days');\n\t\t\t\t\tdaysToShow++;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (prevDays.format('DDD') === actualDay) {\n\t\t\t\tactive = ' active';\n\t\t\t}\n\t\t\thtml +=\n\t\t\t\t'<div class=\"js-sub-record sub-record nav-item col-1 px-0\" data-type=\"days\" data-date=\"' +\n\t\t\t\tprevDays.format('YYYY-MM-DD') +\n\t\t\t\t'\" data-js=\"click | class: active\">' +\n\t\t\t\t'<div class=\"sub-record-content nav-link' +\n\t\t\t\tactive +\n\t\t\t\t'\">' +\n\t\t\t\t'<div class=\"sub-date-name\">' +\n\t\t\t\tapp.vtranslate('JS_DAY_SHORT') +\n\t\t\t\t' ' +\n\t\t\t\tprevDays.format('DD') +\n\t\t\t\t'<div class=\"js-count-events count badge c-badge--md ml-1\" data-js=\"html\">0</div>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'</div>';\n\t\t\tprevDays = moment(prevDays).add(1, 'days');\n\t\t}\n\t\tdatesView.find('.js-sub-date-list').html(html);\n\t}\n\n\tselectDays(startDate, endDate) {\n\t\tlet container = this.container;\n\t\tcontainer.find('.js-right-panel-event-link').tab('show');\n\t\tlet start_hour = app.getMainParams('startHour'),\n\t\t\tend_hour = app.getMainParams('endHour'),\n\t\t\tview = this.getCalendarView().fullCalendar('getView');\n\t\tif (endDate.hasTime() == false) {\n\t\t\tendDate.add(-1, 'days');\n\t\t}\n\t\tstartDate = startDate.format();\n\t\tendDate = endDate.format();\n\t\tif (start_hour == '') {\n\t\t\tstart_hour = '00';\n\t\t}\n\t\tif (end_hour == '') {\n\t\t\tend_hour = '00';\n\t\t}\n\t\tthis.getCalendarCreateView().done(function (data) {\n\t\t\tif (data.length <= 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (view.name != 'agendaDay' && view.name != 'agendaWeek') {\n\t\t\t\tstartDate = startDate + 'T' + start_hour + ':00';\n\t\t\t\tendDate = endDate + 'T' + end_hour + ':00';\n\t\t\t\tif (startDate == endDate) {\n\t\t\t\t\tlet activityType = container.find('[name=\"activitytype\"]');\n\t\t\t\t\tlet activityTypeValue = activityType.val();\n\t\t\t\t\tif (activityType.is('[type=\"radio\"]')) {\n\t\t\t\t\t\tactivityTypeValue = activityType.filter(':checked').val();\n\t\t\t\t\t}\n\t\t\t\t\tlet activityDurations = JSON.parse(data.find('[name=\"defaultOtherEventDuration\"]').val());\n\t\t\t\t\tlet minutes = 0;\n\t\t\t\t\tfor (let i in activityDurations) {\n\t\t\t\t\t\tif (activityDurations[i].activitytype === activityTypeValue) {\n\t\t\t\t\t\t\tminutes = parseInt(activityDurations[i].duration);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tendDate = moment(endDate).add(minutes, 'minutes').toISOString();\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet dateFormat = data.find('[name=\"date_start\"]').data('dateFormat').toUpperCase(),\n\t\t\t\ttimeFormat = data.find('[name=\"time_start\"]').data('format'),\n\t\t\t\tdefaultTimeFormat = '';\n\t\t\tif (timeFormat == 24) {\n\t\t\t\tdefaultTimeFormat = 'HH:mm';\n\t\t\t} else {\n\t\t\t\tdefaultTimeFormat = 'hh:mm A';\n\t\t\t}\n\t\t\tdata.find('[name=\"date_start\"]').val(moment(startDate).format(dateFormat));\n\t\t\tdata.find('[name=\"due_date\"]').val(moment(endDate).format(dateFormat));\n\t\t\tif (data.find('.js-autofill').prop('checked') === true) {\n\t\t\t\tCalendar_Edit_Js.getInstance().getFreeTime(data);\n\t\t\t} else {\n\t\t\t\tdata.find('[name=\"time_start\"]').val(moment(startDate).format(defaultTimeFormat));\n\t\t\t\tdata.find('[name=\"time_end\"]').val(moment(endDate).format(defaultTimeFormat));\n\t\t\t}\n\t\t});\n\t}\n\n\tregisterUsersChange(formContainer) {\n\t\tformContainer.find('.js-input-user-owner-id-ajax, .js-input-user-owner-id').on('change', () => {\n\t\t\tthis.getCalendarView().fullCalendar('getCalendar').view.options.loadView();\n\t\t});\n\t\tthis.registerPinUser();\n\t}\n\n\t/**\n\t * Register actions to do after save record\n\t * @param instance\n\t * @param data\n\t * @returns {function}\n\t */\n\tregisterAfterSubmitForm(self, data) {\n\t\tconst calendarView = this.getCalendarView();\n\t\tlet returnFunction = function (data) {\n\t\t\tif (data.success) {\n\t\t\t\tlet recordActivityStatus = data.result.activitystatus.value,\n\t\t\t\t\thistoryStatus = app.getMainParams('activityStateLabels', true).history,\n\t\t\t\t\tinHistoryStatus = $.inArray(recordActivityStatus, historyStatus),\n\t\t\t\t\tshowType = app.getMainParams('showType');\n\t\t\t\tif ((-1 !== inHistoryStatus && 'history' === showType) || (-1 === inHistoryStatus && 'history' !== showType)) {\n\t\t\t\t\tif (calendarView.fullCalendar('clientEvents', data.result._recordId)[0]) {\n\t\t\t\t\t\tself.updateCalendarEvent(data.result._recordId, data.result);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst calendarInstance = calendarView.fullCalendar('getCalendar');\n\t\t\t\t\t\tif (calendarInstance.view.type !== 'year') {\n\t\t\t\t\t\t\tcalendarInstance.view.options.addCalendarEvent(data.result);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcalendarInstance.view.render();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.result.followup && data.result.followup.value !== undefined) {\n\t\t\t\t\t\t\tcalendarView.fullCalendar('removeEvents', data.result.followup.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tself.refreshDatesRowView(calendarView.fullCalendar('getView'));\n\t\t\t\tself.getSidebarView().find('.js-qc-form').html('');\n\t\t\t\tself.getCalendarCreateView();\n\t\t\t\twindow.popoverCache = {};\n\t\t\t}\n\t\t};\n\t\treturn returnFunction;\n\t}\n\n\topenRightPanel() {\n\t\tlet calendarRightPanel = $('.js-calendar-right-panel');\n\t\tif (calendarRightPanel.hasClass('hideSiteBar')) {\n\t\t\tcalendarRightPanel.find('.js-toggle-site-bar-right-button').trigger('click');\n\t\t}\n\t}\n\n\tshowRightPanelForm() {\n\t\tlet calendarRightPanel = $('.js-calendar-right-panel');\n\t\tif (!calendarRightPanel.find('.js-right-panel-event').hasClass('active')) {\n\t\t\tcalendarRightPanel.find('.js-right-panel-event-link').trigger('click');\n\t\t}\n\t\tapp.showNewScrollbar(calendarRightPanel.find('.js-calendar__form__wrapper'), {\n\t\t\tsuppressScrollX: true\n\t\t});\n\t}\n\n\tregisterSiteBarEvents() {\n\t\tlet calendarRightPanel = $('.js-calendar-right-panel');\n\t\tcalendarRightPanel.find('.js-show-sitebar').on('click', () => {\n\t\t\tif (calendarRightPanel.hasClass('hideSiteBar')) {\n\t\t\t\tcalendarRightPanel.find('.js-toggle-site-bar-right-button').trigger('click');\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Parse calendar data\n\t * @param {Object} calendarDetails\n\t * @returns {{id: *, title: *, start: *, end: *, module: string, url: string, className: string[], start_display: *, end_display: *}}\n\t */\n\tgetEventData(calendarDetails) {\n\t\tlet calendar = this.getCalendarView(),\n\t\t\tstartDate = calendar.fullCalendar(\n\t\t\t\t'moment',\n\t\t\t\tcalendarDetails.date_start.value + ' ' + calendarDetails.time_start.value\n\t\t\t),\n\t\t\tendDate = calendar.fullCalendar('moment', calendarDetails.due_date.value + ' ' + calendarDetails.time_end.value),\n\t\t\teventObject = {\n\t\t\t\tid: calendarDetails._recordId,\n\t\t\t\ttitle: calendarDetails.subject.display_value,\n\t\t\t\tstart: startDate.format(),\n\t\t\t\tend: endDate.format(),\n\t\t\t\tmodule: this.module,\n\t\t\t\turl: `index.php?module=${this.module}&view=ActivityState&record=${calendarDetails._recordId}`,\n\t\t\t\tclassName: [\n\t\t\t\t\t'ownerCBg_' + calendarDetails.assigned_user_id.value,\n\t\t\t\t\t' picklistCBr_Calendar_activitytype_' + calendarDetails.activitytype.value,\n\t\t\t\t\t'js-popover-tooltip--record'\n\t\t\t\t],\n\t\t\t\tstart_display: calendarDetails.date_start.display_value,\n\t\t\t\tend_display: calendarDetails.due_date.display_value\n\t\t\t};\n\t\tif (calendarDetails.isEditable && app.getMainParams('showEditForm')) {\n\t\t\teventObject.url = `index.php?module=${this.module}&view=EventForm&record=${eventObject.id}`;\n\t\t}\n\t\treturn eventObject;\n\t}\n\n\t/**\n\t * Update Event\n\t * @param {Number} calendarEventId\n\t * @param {Object} calendarDetails\n\t */\n\tupdateCalendarEvent(calendarEventId, calendarDetails) {\n\t\tconst calendar = this.getCalendarView();\n\t\tlet recordToUpdate = calendar.fullCalendar('clientEvents', calendarEventId)[0];\n\t\t$.extend(recordToUpdate, this.getEventData(calendarDetails));\n\t\tcalendar.fullCalendar('updateEvent', recordToUpdate);\n\t}\n\n\tgetCalendarCreateView() {\n\t\tlet aDeferred = $.Deferred();\n\t\tif (this.eventCreate) {\n\t\t\tconst thisInstance = this;\n\t\t\tlet sideBar = thisInstance.getSidebarView(),\n\t\t\t\tqcForm = sideBar.find('.js-qc-form');\n\t\t\tif (qcForm.find('form').length > 0 && qcForm.find('input[name=record]').length === 0) {\n\t\t\t\taDeferred.resolve(qcForm);\n\t\t\t} else {\n\t\t\t\tlet progressInstance = $.progressIndicator({ blockInfo: { enabled: true } });\n\t\t\t\tthis.getCalendarSidebarData({ module: this.module, view: 'EventForm' })\n\t\t\t\t\t.done(() => {\n\t\t\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\tthisInstance.registerAutofillTime();\n\t\t\t\t\t\taDeferred.resolve(qcForm);\n\t\t\t\t\t})\n\t\t\t\t\t.fail((error) => {\n\t\t\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\tapp.errorLog(error);\n\t\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\taDeferred.reject();\n\t\t}\n\t\treturn aDeferred.promise();\n\t}\n\n\t/**\n\t * Autoselect date in create view in extended calendar\n\t */\n\tregisterAutofillTime() {\n\t\tif (app.getMainParams('autofillTime')) {\n\t\t\tthis.container.find('.js-autofill').prop('checked', 'checked').trigger('change');\n\t\t}\n\t}\n\n\tregisterPinUser() {\n\t\t$('.js-pin-user')\n\t\t\t.off('click')\n\t\t\t.on('click', function () {\n\t\t\t\tconst thisInstance = $(this);\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: this.module,\n\t\t\t\t\taction: 'Calendar',\n\t\t\t\t\tmode: 'pinOrUnpinUser',\n\t\t\t\t\telement_id: thisInstance.data('elementid')\n\t\t\t\t}).done((data) => {\n\t\t\t\t\tlet response = data.result;\n\t\t\t\t\tif (response === 'unpin') {\n\t\t\t\t\t\tthisInstance.find('.js-pin-icon').removeClass('fas').addClass('far');\n\t\t\t\t\t} else if (response === 'pin') {\n\t\t\t\t\t\tthisInstance.find('.js-pin-icon').removeClass('far').addClass('fas');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\ttext: app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tregisterAddForm() {\n\t\tconst thisInstance = this;\n\t\tlet sideBar = thisInstance.getSidebarView();\n\t\tthisInstance.getCalendarCreateView();\n\t\tlet user = app.getMainParams('usersId');\n\t\tif (user === undefined) {\n\t\t\tuser = [app.getMainParams('userId')];\n\t\t}\n\t\tAppConnector.request(`index.php?module=${this.module}&view=RightPanelExtended&mode=getUsersList&user=${user}`).done(\n\t\t\tfunction (data) {\n\t\t\t\tif (data) {\n\t\t\t\t\tlet formContainer = sideBar.find('.js-users-form');\n\t\t\t\t\tformContainer.html(data);\n\t\t\t\t\tthisInstance.registerUsersChange(formContainer);\n\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(formContainer.find('select'));\n\t\t\t\t\tapp.showNewScrollbar(formContainer, {\n\t\t\t\t\t\tsuppressScrollX: true\n\t\t\t\t\t});\n\t\t\t\t\tthisInstance.registerFilterForm(formContainer);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tAppConnector.request(\n\t\t\t`index.php?module=${this.module}&view=RightPanelExtended&mode=getGroupsList&user=${user}`\n\t\t).done(function (data) {\n\t\t\tif (data) {\n\t\t\t\tlet formContainer = sideBar.find('.js-group-form');\n\t\t\t\tformContainer.html(data);\n\t\t\t\tthisInstance.registerUsersChange(formContainer);\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(formContainer.find('select'));\n\t\t\t\tformContainer.addClass('u-min-h-30per');\n\t\t\t\tapp.showNewScrollbar(formContainer, {\n\t\t\t\t\tsuppressScrollX: true\n\t\t\t\t});\n\t\t\t\tthisInstance.registerFilterForm(formContainer);\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Find element on list (user, group)\n\t * @param {jQuery.Event} e\n\t */\n\tfindElementOnList(e) {\n\t\tlet target = $(e.target),\n\t\t\tvalue = target.val().toLowerCase(),\n\t\t\tcontainer = target.closest('.js-filter__container');\n\t\tcontainer.find('.js-filter__item__value').filter(function () {\n\t\t\tlet item = $(this).closest('.js-filter__item__container');\n\t\t\tif ($(this).text().trim().toLowerCase().indexOf(value) > -1) {\n\t\t\t\titem.removeClass('d-none');\n\t\t\t} else {\n\t\t\t\titem.addClass('d-none');\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Register filter for users and groups\n\t * @param {jQuery} container\n\t */\n\tregisterFilterForm(container) {\n\t\tcontainer.find('.js-filter__search').on('keyup', this.findElementOnList.bind(self));\n\t}\n\n\t/**\n\t * Register popover buttons' click\n\t */\n\tregisterPopoverButtonsClickEvent() {\n\t\t$(document).on('click', '.js-calendar-popover__button', this.showCalendarPopoverLinkInSidebar.bind(this));\n\t}\n\n\t/**\n\t * Show popover link in sidebar\n\t *\n\t * @param   {Object}  e  click event\n\t */\n\tshowCalendarPopoverLinkInSidebar(e) {\n\t\tlet href = e.currentTarget.href;\n\t\tconst hrefObject = app.convertUrlToObject(href);\n\t\tif (hrefObject.module !== 'Calendar' || (hrefObject.view !== 'Edit' && hrefObject.view !== 'Detail')) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\te.preventDefault();\n\t\t\tconst sidebarView = hrefObject.view === 'Edit' ? 'EventForm' : 'ActivityState';\n\t\t\thref = href.replace(hrefObject.view, sidebarView);\n\t\t\tthis.getCalendarSidebarData(href);\n\t\t}\n\t}\n\n\t/**\n\t * Register events\n\t */\n\tregisterEvents() {\n\t\tsuper.registerEvents();\n\t\tthis.registerAddForm();\n\t\tthis.registerSiteBarEvents();\n\t\tthis.registerPopoverButtonsClickEvent();\n\t\tElementQueries.listen();\n\t}\n};\n"],"names":["window","calendarLoaded","Calendar_CalendarExtended_Js","container","readonly","sidebarView","length","calendarContainer","addCommonMethodsToYearView","calendar","getCalendarView","self","FC","views","year","extend","baseInstance","selectDays","getCalendarCreateView","getSidebarView","getCurrentCvId","showRightPanelForm","getSelectedUsersCalendar","registerClearFilterButton","clearFilterButton","registerFilterTabChange","registerAfterSubmitForm","registerViewRenderEvents","appendSubDateRow","refreshDatesRowView","generateYearList","updateCountTaskCalendar","registerDatesChange","addHeaderButtons","browserHistoryConfig","module","showChangeDateButtons","showTodayButtonCheckbox","getDefaultParams","basicOptions","setCalendarOptions","options","header","left","app","getMainParams","center","right","basic","eventLimit","eventLimitText","vtranslate","titleFormat","select","loadView","fullCalendar","view","render","month","parseDateFormat","loadCalendarData","week","day","basicDay","type","start","end","eventRender","event","element","eventRenderer","viewRender","addCalendarEvent","calendarDetails","getEventData","Object","assign","eventClick","eventEdit","calEvent","jsEvent","preventDefault","getCalendarSidebarData","$","attr","link","URL","href","location","searchParams","get","find","buttonsContainer","prev","viewBtn","clone","filters","prepend","after","changeDaysState","changeType","calendarView","switchContainer","switchShowType","switchSwitchingDays","switchingDaysState","data","historyParams","time","hiddenDays","on","e","currentTarget","setMainParams","moduleCacheSet","trigger","setCalendarHeight","toolbar","subDateRow","append","width","breakpoints","lg","showNewScrollbar","todayButton","todyButtonIcon","hasClass","popoverContent","text","toLowerCase","removeClass","html","showPopoverElementView","content","viewType","replace","nextPrevButtons","yearButtons","first","buttonText","last","hide","show","intervalStart","intervalEnd","generateSubMonthList","generateSubWeekList","generateSubDaysList","addClass","moment","parent","thisInstance","sidebar","selectedUsers","selectedUsersAjax","selectedRolesAjax","users","each","push","val","concat","datesView","subDatesElements","dateArray","userDateFormat","CONFIG","dateFormat","toUpperCase","user","key","format","endOf","add","AppConnector","request","action","mode","dates","cvid","done","events","result","sideBar","editViewInstance","Vtiger_Edit_Js","getInstanceByModuleName","params","rightFormCreate","registerBasicEvents","validationEngine","validationEngineOptions","App","Fields","Picklist","showSelect2ElementView","callbackFunction","Components","QuickCreate","registerPostLoadEvents","Text","Editor","height","aDeferred","Deferred","progressInstance","progressIndicator","blockInfo","enabled","isNumeric","record","openRightPanel","updateSidebar","registerEditForm","suppressScrollX","resolve","fail","error","errorLog","promise","formatDate","calendarInstance","historyUrl","connectorMethod","browserHistory","keys","currentUser","parseInt","statement","toggleClass","clearBtn","prop","calendarSwitch","actualUserCheckbox","dateStart","prevYear","subtract","actualYear","nextYear","active","activeMonth","locale","Date","monthsTranslated","prevWeeks","actualWeek","nextWeeks","prevDays","actualDay","nextDays","daysToShow","diff","moduleCacheGet","inArray","startDate","endDate","tab","start_hour","end_hour","hasTime","name","activityType","activityTypeValue","is","filter","activityDurations","JSON","parse","minutes","i","activitytype","duration","toISOString","timeFormat","defaultTimeFormat","Calendar_Edit_Js","getInstance","getFreeTime","formContainer","registerPinUser","returnFunction","success","recordActivityStatus","activitystatus","value","historyStatus","history","inHistoryStatus","showType","_recordId","updateCalendarEvent","followup","popoverCache","calendarRightPanel","date_start","time_start","due_date","time_end","eventObject","id","title","subject","display_value","url","className","assigned_user_id","start_display","end_display","isEditable","calendarEventId","recordToUpdate","eventCreate","qcForm","registerAutofillTime","reject","off","element_id","response","showNotify","registerUsersChange","registerFilterForm","target","closest","item","trim","indexOf","findElementOnList","bind","document","showCalendarPopoverLinkInSidebar","hrefObject","convertUrlToObject","registerAddForm","registerSiteBarEvents","registerPopoverButtonsClickEvent","ElementQueries","listen","Calendar_Calendar_Js"],"mappings":";;AAEA;AACA;AACA;AACA,mjGAC+B;AAA/BA,MAAM,CAACC,cAAP,IACAD,MAAM,CAACE,4BAAP,8CACC,sCAAYC,SAAZ,CAAuBC,QAAvB,CAAiC,4FAC1BD,SAD0B,CACfC,QADe,EAEhC,MAAKC,WAAL,CAAmB,CAClBC,MAAM,CAAE,CADU,CAFa,CAKhC,MAAKC,iBAAL,GALgC,CAMhC,MAAKC,0BAAL,EANgC,CAOhC,MAAKC,QAAL,CAAgB,MAAKC,eAAL,EAPgB,MAQhC,CAED;AACD;AACA,IAbA,8MAcC,qCAA6B,CAC5B,IAAMC,IAAI,CAAG,IAAb,CACAC,EAAE,CAACC,KAAH,CAASC,IAAT,CAAgBF,EAAE,CAACC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqB,CACpCC,YAAY,CAAEL,IADsB,CAEpCM,UAAU,CAAEN,IAAI,CAACM,UAFmB,CAGpCC,qBAAqB,CAAEP,IAAI,CAACO,qBAHQ,CAIpCC,cAAc,CAAER,IAAI,CAACQ,cAJe,CAKpCC,cAAc,CAAET,IAAI,CAACS,cALe,CAMpCV,eAAe,CAAEC,IAAI,CAACD,eANc,CAOpCW,kBAAkB,CAAEV,IAAI,CAACU,kBAPW,CAQpCC,wBAAwB,CAAEX,IAAI,CAACW,wBARK,CASpCC,yBAAyB,CAAEZ,IAAI,CAACY,yBATI,CAUpCC,iBAAiB,CAAEb,IAAI,CAACa,iBAVY,CAWpCC,uBAAuB,CAAEd,IAAI,CAACc,uBAXM,CAYpCpB,WAAW,CAAEM,IAAI,CAACN,WAZkB,CAapCqB,uBAAuB,CAAEf,IAAI,CAACe,uBAbM,CAcpCC,wBAAwB,CAAEhB,IAAI,CAACgB,wBAdK,CAepCC,gBAAgB,CAAEjB,IAAI,CAACiB,gBAfa,CAgBpCC,mBAAmB,CAAElB,IAAI,CAACkB,mBAhBU,CAiBpCC,gBAAgB,CAAEnB,IAAI,CAACmB,gBAjBa,CAkBpCC,uBAAuB,CAAEpB,IAAI,CAACoB,uBAlBM,CAmBpCC,mBAAmB,CAAErB,IAAI,CAACqB,mBAnBU,CAoBpCC,gBAAgB,CAAEtB,IAAI,CAACsB,gBApBa,CAqBpCC,oBAAoB,CAAEvB,IAAI,CAACuB,oBArBS,CAsBpC9B,QAAQ,CAAEO,IAAI,CAACP,QAtBqB,CAuBpCD,SAAS,CAAEQ,IAAI,CAACR,SAvBoB,CAwBpCgC,MAAM,CAAExB,IAAI,CAACwB,MAxBuB,CAyBpCC,qBAAqB,CAAEzB,IAAI,CAACyB,qBAzBQ,CA0BpCC,uBAAuB,CAAE1B,IAAI,CAAC0B,uBA1BM,CA2BpCC,gBAAgB,CAAE3B,IAAI,CAAC2B,gBA3Ba,CAArB,EA6BhB,CAED;AACD;AACA,kCACC,yBAAiB,CAChB,IAAI3B,IAAI,CAAG,IAAX,CACC4B,YAAY,CAAG,KAAKC,kBAAL,EADhB,CAECC,OAAO,CAAG,CACTC,MAAM,CAAE,CACPC,IAAI,CAAE,cAAgBC,GAAG,CAACC,aAAJ,CAAkB,UAAlB,CAAhB,CAAgD,GAAhD,CAAsDD,GAAG,CAACC,aAAJ,CAAkB,SAAlB,CADrD,CAEPC,MAAM,CAAE,mCAFD,CAGPC,KAAK,CAAE,OAHA,CADC,CAMTlC,KAAK,CAAE,CACNmC,KAAK,CAAE,CACNC,UAAU,GADJ,CADD,CAINnC,IAAI,CAAE,CACLmC,UAAU,CAAE,EADP,CAELC,cAAc,CAAEN,GAAG,CAACO,UAAJ,CAAe,kBAAf,CAFX,CAGLC,WAAW,CAAE,MAHR,CAILC,MAAM,CAAE,iBAAsB,EAJzB,CAKLC,QAAQ,CAAE,mBAAY,CACrB3C,IAAI,CAACD,eAAL,GAAuB6C,YAAvB,CAAoC,aAApC,EAAmDC,IAAnD,CAAwDC,MAAxD,GACA,CAPI,CAJA,CAaNC,KAAK,CAAE,CACNN,WAAW,CAAE,KAAKO,eAAL,CAAqB,OAArB,CADP,CAENL,QAAQ,CAAE,mBAAY,CACrB3C,IAAI,CAACiD,gBAAL,GACA,CAJK,CAbD,CAmBNC,IAAI,CAAE,CACLT,WAAW,CAAE,KAAKO,eAAL,CAAqB,MAArB,CADR,CAELL,QAAQ,CAAE,mBAAY,CACrB3C,IAAI,CAACiD,gBAAL,GACA,CAJI,CAnBA,CAyBNE,GAAG,CAAE,CACJV,WAAW,CAAE,KAAKO,eAAL,CAAqB,KAArB,CADT,CAEJL,QAAQ,CAAE,mBAAY,CACrB3C,IAAI,CAACiD,gBAAL,GACA,CAJG,CAzBC,CA+BNG,QAAQ,CAAE,CACTC,IAAI,CAAE,WADG,CAETV,QAAQ,CAAE,mBAAY,CACrB3C,IAAI,CAACiD,gBAAL,GACA,CAJQ,CA/BJ,CANE,CA4CTP,MAAM,CAAE,gBAAUY,KAAV,CAAiBC,GAAjB,CAAsB,CAC7BvD,IAAI,CAACM,UAAL,CAAgBgD,KAAhB,CAAuBC,GAAvB,CAD6B,CAE7BvD,IAAI,CAACD,eAAL,GAAuB6C,YAAvB,CAAoC,UAApC,EACA,CA/CQ,CAgDTY,WAAW,CAAE,qBAAUC,KAAV,CAAiBC,OAAjB,CAA0B,CACtC1D,IAAI,CAAC2D,aAAL,CAAmBF,KAAnB,CAA0BC,OAA1B,EACA,CAlDQ,CAmDTE,UAAU,CAAE,oBAAUf,IAAV,CAAyB,CAClB,MAAd,GAAAA,IAAI,CAACQ,IAD2B,EAEnCrD,IAAI,CAACiD,gBAAL,CAAsBJ,IAAtB,EAED,CAvDQ,CAwDTgB,gBAxDS,2BAwDQC,eAxDR,CAwDyB,CACjC9D,IAAI,CAACD,eAAL,GAAuB6C,YAAvB,CAAoC,aAApC,CAAmD5C,IAAI,CAAC+D,YAAL,CAAkBD,eAAlB,CAAnD,EACA,CA1DQ,CAFX,CA8DAhC,OAAO,CAAGkC,MAAM,CAACC,MAAP,CAAcrC,YAAd,CAA4BE,OAA5B,CA/DM,CAiEfA,OAAO,CAACoC,UAjEO,CAgEZ,CAAC,KAAKzE,QAAN,EAAkBO,IAAI,CAACmE,SAhEX,CAiEM,SAAUC,QAAV,CAAoBC,OAApB,CAA6B,CACjDA,OAAO,CAACC,cAAR,EADiD,CAEjDtE,IAAI,CAACuE,sBAAL,CAA4BC,CAAC,CAAC,IAAD,CAAD,CAAQC,IAAR,CAAa,MAAb,CAA5B,EACA,CApEc,CAsEM,SAAUL,QAAV,CAAoBC,OAApB,CAA6B,CACjDA,OAAO,CAACC,cAAR,EADiD,CAEjD,IAAMI,IAAI,CAAG,IAAIC,GAAJ,CAAQH,CAAC,CAAC,IAAD,CAAD,CAAQ,CAAR,EAAWI,IAAnB,CAAb,CACAvF,MAAM,CAACwF,QAAP,CAAgBZ,MAAhB,4BAA2C,KAAKzC,MAAhD,gCAA6EkD,IAAI,CAACI,YAAL,CAAkBC,GAAlB,CAAsB,QAAtB,CAA7E,GACA,CA1Ec,CA4EhB,KAAKjF,QAAL,CAAc8C,YAAd,CAA2Bd,OAA3B,EACA,CA/HF,kCAiIC,6BAAqB,EAjItB,gCAmIC,2BAAmB,CAClB,IAAI,KAAKlC,iBAAL,CAAuBoF,IAAvB,CAA4B,wBAA5B,EAAsDrF,MAA1D,EAGA,IAAIsF,gBAAgB,CAAG,KAAKrF,iBAAL,CAAuBsF,IAAvB,CAA4B,8BAA5B,CAAvB,CACCC,OAAO,CAAGF,gBAAgB,CAACD,IAAjB,CAAsB,wBAAtB,EAAgDI,KAAhD,EADX,CAECC,OAAO,CAAGJ,gBAAgB,CAACD,IAAjB,CAAsB,gCAAtB,EAAwDI,KAAxD,EAFX,CAGA,KAAKxF,iBAAL,CAAuBoF,IAAvB,CAA4B,UAA5B,EAAwCM,OAAxC,CAAgDH,OAAhD,CANA,CAOA,KAAKvF,iBAAL,CAAuBoF,IAAvB,CAA4B,YAA5B,EAA0CO,KAA1C,CAAgDF,OAAhD,CAPA,CAQA,KAAKzE,yBAAL,EARA,CASA,KAAKE,uBAAL,GATA,CAUA,CA9IF,oCAgJC,+BAAuB,CAElB0E,IAAAA,eAFkB,CAGrBC,UAHqB,aAChBC,YAAY,CAAG,KAAK3F,eAAL,EADC,CAIrB4F,eAAe,CAAGnB,CAAC,CAAC,4BAAD,CAJE,CAKrBoB,cAAc,CAAGD,eAAe,CAACX,IAAhB,CAAqB,sBAArB,CALI,CAMLY,cAAc,CAACZ,IAAf,CAAoB,6BAApB,EAAmDrF,MAAnD,CAA4D,SAA5D,CAAwE,SANnE,KAOrBkG,mBAAmB,CAAGF,eAAe,CAACX,IAAhB,CAAqB,2BAArB,CAPD,CAQrBc,kBAAkB,CAAGD,mBAAmB,CAACb,IAApB,CAAyB,eAAzB,EAA0Ce,IAA1C,CAA+C,KAA/C,CARA,CASlBC,aAAa,CAAG/D,GAAG,CAACC,aAAJ,CAAkB,eAAlB,KACE,EAAlB,GAAA8D,aAVkB,EAWrBR,eAAe,CAAGvD,GAAG,CAACC,aAAJ,CAAkB,eAAlB,CAXG,CAYrBuD,UAAU,CAAGxD,GAAG,CAACC,aAAJ,CAAkB,UAAlB,CAZQ,GAcrBuD,UAAU,CAAG,SAAAO,aAAa,CAACC,IAAd,CAAwDhE,GAAG,CAACC,aAAJ,CAAkB,UAAlB,CAAxD,CAAmC8D,aAAa,CAACC,IAdzC,CAerBT,eAAe,CAAgC,EAA7B,GAAAQ,aAAa,CAACE,UAAd,CAAkC,KAAlC,CAA0C,UAfvC,EAiBlBN,cAAc,CAACjG,MAjBG,GAkBrBiG,cAAc,CAACO,EAAf,CAAkB,QAAlB,CAA4B,OAA5B,CAAqC,SAACC,CAAD,CAAO,CAC3C,IAAMC,aAAa,CAAG7B,CAAC,CAAC4B,CAAC,CAACC,aAAH,CAAvB,CAC6C,WAAzC,SAAOA,aAAa,CAACN,IAAd,CAAmB,SAAnB,CAFgC,CAKU,WAA1C,SAAOM,aAAa,CAACN,IAAd,CAAmB,UAAnB,CALyB,GAM1C9D,GAAG,CAACqE,aAAJ,CAAkB,UAAlB,CAA8B,SAA9B,CAN0C,CAO1CrE,GAAG,CAACsE,cAAJ,CAAmB,iBAAnB,CAAsC,SAAtC,CAP0C,GAG1CtE,GAAG,CAACqE,aAAJ,CAAkB,UAAlB,CAA8B,SAA9B,CAH0C,CAI1CrE,GAAG,CAACsE,cAAJ,CAAmB,iBAAnB,CAAsC,SAAtC,CAJ0C,EAS3Cb,YAAY,CAAC9C,YAAb,CAA0B,aAA1B,EAAyCC,IAAzC,CAA8Cf,OAA9C,CAAsDa,QAAtD,GACA,CAVD,CAlBqB,CA6BjBV,GAAG,CAACC,aAAJ,CAAkB,UAAlB,IAAkCuD,UA7BjB,EA8BpBjB,CAAC,CAAC,oBAAqBiB,UAArB,CAAkC,KAAnC,CAAyCG,cAAzC,CAAD,CAA0DY,OAA1D,CAAkE,QAAlE,CA9BoB,EAiClBX,mBAAmB,CAAClG,MAjCF,GAkCrBkG,mBAAmB,CAACM,EAApB,CAAuB,QAAvB,CAAiC,OAAjC,CAA0C,SAACC,CAAD,CAAO,KAC1CC,aAAa,CAAG7B,CAAC,CAAC4B,CAAC,CAACC,aAAH,CADyB,CAE5CH,UAAU,CAAG,EAF+B,CAGH,WAAzC,SAAOG,aAAa,CAACN,IAAd,CAAmB,SAAnB,CAHqC,CAOK,WAA1C,SAAOM,aAAa,CAACN,IAAd,CAAmB,UAAnB,CAP8B,GAQ/C9D,GAAG,CAACqE,aAAJ,CAAkB,eAAlB,CAAmC,KAAnC,CAR+C,CAS/CrE,GAAG,CAACsE,cAAJ,CAAmB,sBAAnB,CAA2C,KAA3C,CAT+C,GAI/CtE,GAAG,CAACqE,aAAJ,CAAkB,eAAlB,CAAmC,UAAnC,CAJ+C,CAK/CrE,GAAG,CAACsE,cAAJ,CAAmB,sBAAnB,CAA2C,UAA3C,CAL+C,CAM/CL,UAAU,CAAGjE,GAAG,CAACC,aAAJ,CAAkB,YAAlB,IANkC,EAWhDwD,YAAY,CAAC9C,YAAb,CAA0B,QAA1B,CAAoC,YAApC,CAAkDsD,UAAlD,CAXgD,CAYhDR,YAAY,CAAC9C,YAAb,CAA0B,QAA1B,CAAoC,QAApC,CAA8C,MAAI,CAAC6D,iBAAL,EAA9C,CAZgD,CAaE,MAA9C,GAAAf,YAAY,CAAC9C,YAAb,CAA0B,SAA1B,EAAqCS,IAbO,EAc/C,MAAI,CAACrC,wBAAL,CAA8B0E,YAAY,CAAC9C,YAAb,CAA0B,SAA1B,CAA9B,EAED,CAhBD,CAlCqB,CAmDjBX,GAAG,CAACC,aAAJ,CAAkB,eAAlB,IAAuCsD,eAnDtB,CAqDVA,eAAe,GAAKM,kBArDV,CAoDpBtB,CAAC,CAAC,oBAAqBgB,eAArB,CAAuC,KAAxC,CAA8CK,mBAA9C,CAAD,CAAoEW,OAApE,CAA4E,QAA5E,CApDoB,EAyDtB,CAED;AACD;AACA;AACA,oCACC,0BAAiBE,OAAjB,CAA0B,CACpB,KAAK9G,iBAAL,CAAuBoF,IAAvB,CAA4B,eAA5B,EAA6CrF,MADzB,GAExB,KAAKgH,UAAL,CAAkBnC,CAAC,4bAFK,CASxBkC,OAAO,CAACE,MAAR,CAAe,KAAKD,UAApB,CATwB,CAUpBnC,CAAC,CAACnF,MAAD,CAAD,CAAUwH,KAAV,GAAoB5E,GAAG,CAAC6E,WAAJ,CAAgBC,EAVhB,EAWvB9E,GAAG,CAAC+E,gBAAJ,CAAqB,KAAKL,UAA1B,CAXuB,EAczB,CAED;AACD;AACA;AACA;AACA,4CACC,kCAAyB9D,IAAzB,CAA+B,CAC9B,KAAKjD,iBAAL,CAAyB,KAAKG,eAAL,EADK,CAE9B,IAAI2G,OAAO,CAAG,KAAK9G,iBAAL,CAAuBoF,IAAvB,CAA4B,+BAA5B,CAAd,CACA,KAAKvD,qBAAL,CAA2BoB,IAA3B,CAAiC6D,OAAjC,CAH8B,CAI9B,KAAKzF,gBAAL,CAAsByF,OAAtB,CAJ8B,CAK9B,KAAKxF,mBAAL,CAAyB2B,IAAzB,CAL8B,CAM9B,KAAKvB,gBAAL,EAN8B,CAO9B,KAAKI,uBAAL,CAA6BgF,OAA7B,EACA,CAED;AACD;AACA;AACA,2CACC,iCAAwBA,OAAxB,CAAiC,CAChC,IAAIO,WAAW,CAAGP,OAAO,CAAC1B,IAAR,CAAa,kBAAb,CAAlB,CACCkC,cAAc,CAAGD,WAAW,CAACE,QAAZ,CAAqB,mBAArB,EAA4C,mBAA5C,CAAkE,aADpF,CAECC,cAAc,WAAMnF,GAAG,CAACO,UAAJ,CAAe,YAAf,CAAN,aAAsCkE,OAAO,CAAC1B,IAAR,CAAa,kBAAb,EAAiCqC,IAAjC,GAAwCC,WAAxC,EAAtC,CAFf,CAGAL,WAAW,CAACM,WAAZ,CAAwB,YAAxB,CAJgC,CAKhCN,WAAW,CAACO,IAAZ,sGAC0FN,cAD1F,qBALgC,CAQhCjF,GAAG,CAACwF,sBAAJ,CAA2BR,WAAW,CAACjC,IAAZ,CAAiB,8BAAjB,CAA3B,CAA6E,CAC5E0C,OAAO,CAAEN,cADmE,CAE5E5H,SAAS,CAAE,+CAFiE,CAA7E,EAIA,CAED;AACD;AACA;AACA;AACA,yCACC,+BAAsBqD,IAAtB,CAA4B6D,OAA5B,CAAqC,CACpC,IAAIiB,QAAQ,CAAG9E,IAAI,CAACQ,IAAL,CAAUuE,OAAV,CAAkB,eAAlB,CAAmC,EAAnC,EAAuCN,WAAvC,EAAf,CACCO,eAAe,CAAGnB,OAAO,CAAC1B,IAAR,CAAa,kCAAb,CADnB,CAEC8C,WAAW,CAAGpB,OAAO,CAAC1B,IAAR,CAAa,0CAAb,CAFf,CAGK3F,MAAM,CAACC,cAJwB,GAKnCwI,WAAW,CAACC,KAAZ,GAAoBP,IAApB,0DAAyE3E,IAAI,CAACf,OAAL,CAAakG,UAAb,KAAzE,EALmC,CAMnCF,WAAW,CAACG,IAAZ,GAAmBT,IAAnB,WAA2B3E,IAAI,CAACf,OAAL,CAAakG,UAAb,KAA3B,mDANmC,EAQlB,MAAd,GAAAnF,IAAI,CAACQ,IAR2B,GASnCwE,eAAe,CAACE,KAAhB,GAAwBP,IAAxB,0DAA6E3E,IAAI,CAACf,OAAL,CAAakG,UAAb,CAAwBL,QAAxB,CAA7E,EATmC,CAUnCE,eAAe,CAACI,IAAhB,GAAuBT,IAAvB,WAA+B3E,IAAI,CAACf,OAAL,CAAakG,UAAb,CAAwBL,QAAxB,CAA/B,mDAVmC,EAYlB,MAAd,GAAA9E,IAAI,CAACQ,IAZ2B,EAanCwE,eAAe,CAACK,IAAhB,EAbmC,CAcnCJ,WAAW,CAACK,IAAZ,EAdmC,EAeX,OAAd,GAAAtF,IAAI,CAACQ,IAfoB,EAgBnCwE,eAAe,CAACM,IAAhB,EAhBmC,CAiBnCL,WAAW,CAACK,IAAZ,EAjBmC,GAmBnCN,eAAe,CAACM,IAAhB,EAnBmC,CAoBnCL,WAAW,CAACI,IAAZ,EApBmC,EAsBpC,CAED;AACD;AACA;AACA,uCACC,6BAAoBxC,YAApB,CAAkC,CACjC,IAAM1F,IAAI,CAAG,IAAb,CACA,OAAQ0F,YAAY,CAACrC,IAArB,EACC,IAAK,MAAL,CACCrD,IAAI,CAACmB,gBAAL,CAAsBuE,YAAY,CAAC0C,aAAnC,CAAkD1C,YAAY,CAAC2C,WAA/D,CADD,CAEC,MACD,IAAK,OAAL,CACCrI,IAAI,CAACsI,oBAAL,CAA0B5C,YAAY,CAAC0C,aAAvC,CAAsD1C,YAAY,CAAC2C,WAAnE,CADD,CAEC,MACD,IAAK,MAAL,CACA,IAAK,YAAL,CACCrI,IAAI,CAACuI,mBAAL,CAAyB7C,YAAY,CAACpC,KAAtC,CAA6CoC,YAAY,CAACnC,GAA1D,CADD,CAEC,MACD,QACCvD,IAAI,CAACwI,mBAAL,CAAyB9C,YAAY,CAACpC,KAAtC,CAA6CoC,YAAY,CAACnC,GAA1D,CADD,CAXD,CAcAvD,IAAI,CAACoB,uBAAL,EAhBiC,CAiBjCpB,IAAI,CAACqB,mBAAL,GACA,CAnTF,mCAqTC,8BAAsB,iBACrB,KAAK7B,SAAL,CAAewF,IAAf,CAAoB,8BAApB,EAAoDmB,EAApD,CAAuD,OAAvD,CAAgE,SAACC,CAAD,CAAO,CACtE,IAAIC,aAAa,CAAG7B,CAAC,CAAC4B,CAAC,CAACC,aAAH,CAArB,CACAA,aAAa,CAACoC,QAAd,CAAuB,QAAvB,CAFsE,CAGtE,MAAI,CAAC1I,eAAL,GAAuB6C,YAAvB,CAAoC,UAApC,CAAgD8F,MAAM,CAACrC,aAAa,CAACN,IAAd,CAAmB,MAAnB,CAAD,CAA6B,YAA7B,CAAtD,EACA,CAJD,EAKA,CA3TF,8BA6TC,yBAAiB,CAChB,OAAOvB,CAAC,CAAC,2CAAD,CAAD,CAA+CmE,MAA/C,CAAsD,gBAAtD,EAAwE5C,IAAxE,CAA6E,MAA7E,CACP,CA/TF,uCAiUC,kCAA0B,CACzB,IAAM6C,YAAY,CAAG,IAArB,CACA,KAAK7I,eAAL,GACEiF,IADF,CACO,mCADP,EAEEmB,EAFF,CAEK,cAFL,CAEqB,UAAY,CAC/ByC,YAAY,CAAC7I,eAAb,GAA+B6C,YAA/B,CAA4C,aAA5C,EAA2DC,IAA3D,CAAgEf,OAAhE,CAAwEa,QAAxE,GACA,CAJF,EAKA,CAxUF,wCA0UC,mCAA2B,KACpBkG,OAAO,CAAG,KAAKrI,cAAL,EADU,CAEtBsI,aAAa,CAAGD,OAAO,CAAC7D,IAAR,CAAa,iCAAb,CAFM,CAGzB+D,iBAAiB,CAAGF,OAAO,CAAC7D,IAAR,CAAa,8BAAb,CAHK,CAIzBgE,iBAAiB,CAAGH,OAAO,CAAC7D,IAAR,CAAa,8BAAb,CAJK,CAKzBiE,KAAK,CAAG,EALiB,CAa1B,QAPI,CAAAH,aAAa,CAACnJ,MAOlB,CANCmJ,aAAa,CAACI,IAAd,CAAmB,UAAY,CAC9BD,KAAK,CAACE,IAAN,CAAW3E,CAAC,CAAC,IAAD,CAAD,CAAQ4E,GAAR,EAAX,EACA,CAFD,CAMD,CAHsC,CAA3B,CAAAL,iBAAiB,CAACpJ,MAG7B,GAFCsJ,KAAK,CAAGF,iBAAiB,CAACK,GAAlB,GAAwBC,MAAxB,CAA+BL,iBAAiB,CAACI,GAAlB,EAA/B,CAET,EAAOH,KACP,CAxVF,8BA0VC,yBAAiB,CAIhB,YAHUvJ,WAAN,EAAsB,KAAKA,WAAL,CAAiBC,MAG3C,GAFC,KAAKD,WAAL,CAAmB,KAAKF,SAAL,CAAewF,IAAf,CAAoB,0BAApB,CAEpB,EAAO,KAAKtF,WACZ,CA/VF,uCAiWC,kCAA0B,CACzB,IAAI4J,SAAS,CAAG,KAAK9J,SAAL,CAAewF,IAAf,CAAoB,eAApB,CAAhB,CACCuE,gBAAgB,CAAGD,SAAS,CAACtE,IAAV,CAAe,gBAAf,CADpB,CAECwE,SAAS,CAAG,EAFb,CAGCC,cAAc,CAAGC,MAAM,CAACC,UAAP,CAAkBC,WAAlB,EAHlB,CAICC,IAAI,CAAG,KAAKlJ,wBAAL,EAJR,CAKoB,CAAhB,GAAAkJ,IAAI,CAAClK,MANgB,GAOxBkK,IAAI,CAAG5H,GAAG,CAACC,aAAJ,CAAkB,SAAlB,CAPiB,EASrB,SAAA2H,IATqB,GAUxBA,IAAI,CAAG,CAAC5H,GAAG,CAACC,aAAJ,CAAkB,QAAlB,CAAD,CAViB,EAYzBqH,gBAAgB,CAACL,IAAjB,CAAsB,SAAUY,GAAV,CAAwB,CAC7C,IAAI/D,IAAI,CAAGvB,CAAC,CAAC,IAAD,CAAD,CAAQuB,IAAR,CAAa,MAAb,CAAX,CACC1C,IAAI,CAAGmB,CAAC,CAAC,IAAD,CAAD,CAAQuB,IAAR,CAAa,MAAb,CADR,CAEa,OAAT,GAAA1C,IAHyC,CAI5CmG,SAAS,CAACM,GAAD,CAAT,CAAiB,CAChBpB,MAAM,CAAC3C,IAAI,CAAG,KAAR,CAAN,CAAqBgE,MAArB,CAA4BN,cAA5B,EAA8C,WAD9B,CAEhBf,MAAM,CAAC3C,IAAI,CAAG,KAAR,CAAN,CACEiE,KADF,CACQ,MADR,EAEED,MAFF,CAESN,cAFT,EAE2B,WAJX,CAJ2B,CAUzB,QAAT,GAAApG,IAVkC,CAW5CmG,SAAS,CAACM,GAAD,CAAT,CAAiB,CAChBpB,MAAM,CAAC3C,IAAD,CAAN,CAAagE,MAAb,CAAoBN,cAApB,EAAsC,WADtB,CAEhBf,MAAM,CAAC3C,IAAD,CAAN,CAAaiE,KAAb,CAAmB,OAAnB,EAA4BD,MAA5B,CAAmCN,cAAnC,EAAqD,WAFrC,CAX2B,CAezB,OAAT,GAAApG,IAfkC,CAgB5CmG,SAAS,CAACM,GAAD,CAAT,CAAiB,CAChBpB,MAAM,CAAC3C,IAAD,CAAN,CAAagE,MAAb,CAAoBN,cAApB,EAAsC,WADtB,CAEhBf,MAAM,CAAC3C,IAAD,CAAN,CAAakE,GAAb,CAAiB,CAAjB,CAAoB,KAApB,EAA2BF,MAA3B,CAAkCN,cAAlC,EAAoD,WAFpC,CAhB2B,CAoBzB,MAAT,GAAApG,IApBkC,GAqB5CmG,SAAS,CAACM,GAAD,CAAT,CAAiB,CAChBpB,MAAM,CAAC3C,IAAD,CAAN,CAAagE,MAAb,CAAoBN,cAApB,EAAsC,WADtB,CAEhBf,MAAM,CAAC3C,IAAD,CAAN,CAAagE,MAAb,CAAoBN,cAApB,EAAsC,WAFtB,CArB2B,EA0B7C,CA1BD,CAZyB,CAuCzBS,YAAY,CAACC,OAAb,CAAqB,CACpB3I,MAAM,CAAE,KAAKA,MADO,CAEpB4I,MAAM,CAAE,UAFY,CAGpBC,IAAI,CAAE,qBAHc,CAIpBC,KAAK,CAAEd,SAJa,CAKpBK,IAAI,CAAEA,IALc,CAMpB5D,IAAI,CAAEhE,GAAG,CAACC,aAAJ,CAAkB,UAAlB,CANc,CAOpBqI,IAAI,CAAE,KAAK9J,cAAL,EAPc,CAArB,EAQG+J,IARH,CAQQ,SAAUC,MAAV,CAAkB,CACzBlB,gBAAgB,CAACL,IAAjB,CAAsB,SAAUY,GAAV,CAAwB,CAC7CtF,CAAC,CAAC,IAAD,CAAD,CAAQQ,IAAR,CAAa,kBAAb,EAAiCuC,WAAjC,CAA6C,MAA7C,EAAqDC,IAArD,CAA0DiD,MAAM,CAACC,MAAP,CAAcZ,GAAd,CAA1D,EACA,CAFD,EAGA,CAZD,EAaA,CAED;AACD;AACA;AACA,oCACC,0BAAiBa,OAAjB,CAA0B,iBACrBC,gBAAgB,CAAGC,cAAc,CAACC,uBAAf,CAAuCH,OAAO,CAAC3F,IAAR,CAAa,mBAAb,EAAgCoE,GAAhC,EAAvC,CADE,CAExB2B,MAAM,CAAG,EAFe,CAGrBC,eAAe,CAAGL,OAAO,CAAC3F,IAAR,CAAa,cAAb,CAHG,CAIzB4F,gBAAgB,CAACK,mBAAjB,CAAqCD,eAArC,CAJyB,CAKzBA,eAAe,CAACE,gBAAhB,CAAiCjJ,GAAG,CAACkJ,uBAArC,CALyB,CAMzBC,GAAG,CAACC,MAAJ,CAAWC,QAAX,CAAoBC,sBAApB,CAA2CZ,OAAO,CAAC3F,IAAR,CAAa,QAAb,CAA3C,CANyB,CAOzB2F,OAAO,CAAC3F,IAAR,CAAa,wBAAb,EAAuCmB,EAAvC,CAA0C,OAA1C,CAAmD,UAAM,CACxD,MAAI,CAAC5F,qBAAL,GACA,CAFD,CAPyB,CAUzBwK,MAAM,CAACS,gBAAP,CAA0B,KAAKzK,uBAAL,CAA6B,IAA7B,CAAmCiK,eAAnC,CAVD,CAWzBI,GAAG,CAACK,UAAJ,CAAeC,WAAf,CAA2BC,sBAA3B,CAAkDX,eAAlD,CAAmED,MAAnE,CAXyB,CAYzB,IAAIK,GAAG,CAACC,MAAJ,CAAWO,IAAX,CAAgBC,MAApB,CAA2BlB,OAAO,CAAC3F,IAAR,CAAa,YAAb,CAA3B,CAAuD,CAAE8G,MAAM,CAAE,KAAV,CAAiBpF,OAAO,CAAE,KAA1B,CAAvD,EACA,CAED;AACD;AACA;AACA,0CACC,gCAAuBqE,MAAvB,CAA+B,iBACxBnC,YAAY,CAAG,IADS,CAE7BmD,SAAS,CAAGvH,CAAC,CAACwH,QAAF,EAFiB,CAGxBC,gBAAgB,CAAGzH,CAAC,CAAC0H,iBAAF,CAAoB,CAAEC,SAAS,CAAE,CAAEC,OAAO,GAAT,CAAb,CAApB,CAHK,CAoC9B,OAhCI5H,CAAC,CAAC6H,SAAF,CAAYtB,MAAZ,CAgCJ,GA/BCA,MAAM,CAAG,CACRvJ,MAAM,CAAE,KAAKA,MADL,CAERqB,IAAI,CAAE,WAFE,CAGRyJ,MAAM,CAAEvB,MAHA,CA+BV,EAzBAb,YAAY,CAACC,OAAb,CAAqBY,MAArB,EACEP,IADF,CACO,SAACzE,IAAD,CAAU,CACf6C,YAAY,CAAC2D,cAAb,EADe,CAEfN,gBAAgB,CAACC,iBAAjB,CAAmC,CAAE7B,IAAI,CAAE,MAAR,CAAnC,CAFe,CAGf,IAAIxB,OAAO,CAAGD,YAAY,CAACpI,cAAb,EAAd,CACA,MAAI,CAACgM,aAAL,CAAmB3D,OAAnB,CAA4B9C,IAA5B,CAJe,CAKX8C,OAAO,CAAC7D,IAAR,CAAa,MAAb,EAAqBrF,MALV,CAMdiJ,YAAY,CAAC6D,gBAAb,CAA8B5D,OAA9B,CANc,EAQd5G,GAAG,CAAC+E,gBAAJ,CAAqB6B,OAAO,CAAC7D,IAAR,CAAa,6BAAb,CAArB,CAAkE,CACjE0H,eAAe,GADkD,CAAlE,CARc,CAWd7D,OAAO,CAAC7D,IAAR,CAAa,2CAAb,EAA0DmB,EAA1D,CAA6D,OAA7D,CAAsE,UAAY,CACjFyC,YAAY,CAACrI,qBAAb,GACA,CAFD,CAXc,CAcdsI,OAAO,CAAC7D,IAAR,CAAa,gCAAb,EAA+CmB,EAA/C,CAAkD,OAAlD,CAA2D,UAAY,CACtEyC,YAAY,CAACrE,sBAAb,CAAoCC,CAAC,CAAC,IAAD,CAAD,CAAQuB,IAAR,CAAa,IAAb,CAApC,EACA,CAFD,CAdc,EAkBfgG,SAAS,CAACY,OAAV,CAAkB9D,OAAO,CAAC7D,IAAR,CAAa,aAAb,CAAlB,EACA,CApBF,EAqBE4H,IArBF,CAqBO,SAACC,KAAD,CAAW,CAChBZ,gBAAgB,CAACC,iBAAjB,CAAmC,CAAE7B,IAAI,CAAE,MAAR,CAAnC,CADgB,CAEhBpI,GAAG,CAAC6K,QAAJ,CAAaD,KAAb,EACA,CAxBF,CAyBA,CAAOd,SAAS,CAACgB,OAAV,EACP,CAED;AACD;AACA;AACA;AACA,iCACC,uBAAclE,OAAd,CAAuB9C,IAAvB,CAA6B,CAC5B8C,OAAO,CAAC7D,IAAR,CAAa,aAAb,EAA4BwC,IAA5B,CAAiCzB,IAAjC,CAD4B,CAE5B,KAAKrF,kBAAL,GACA,CA7dF,gCA8dC,2BAAwE,KAAvDmC,IAAuD,wDAAhD,KAAK9C,eAAL,GAAuB6C,YAAvB,CAAoC,SAApC,CAAgD,CACjE5C,IAAI,CAAG,IAD0D,CAEnEgN,UAAU,CAAGtD,MAAM,CAACC,UAAP,CAAkBC,WAAlB,EAFsD,CAGtEW,IAAI,CAAGvK,IAAI,CAACS,cAAL,EAH+D,CAItEwM,gBAAgB,CAAG,KAAKlN,eAAL,EAJmD,CAKvEkN,gBAAgB,CAACrK,YAAjB,CAA8B,cAA9B,CALuE,CAMvE,IAAIqJ,gBAAgB,CAAGzH,CAAC,CAAC0H,iBAAF,CAAoB,CAAEC,SAAS,CAAE,CAAEC,OAAO,GAAT,CAAb,CAApB,CAAvB,CACCvC,IAAI,CAAG7J,IAAI,CAACW,wBAAL,EADR,CAEI,IAAMkJ,IAAI,CAAClK,MARwD,GAStEkK,IAAI,CAAG5H,GAAG,CAACC,aAAJ,CAAkB,SAAlB,CAT+D,EAWnE,SAAA2H,IAXmE,GAYtEA,IAAI,CAAG,CAAC5H,GAAG,CAACC,aAAJ,CAAkB,QAAlB,CAAD,CAZ+D,EAcvElC,IAAI,CAACa,iBAAL,CAAuBgJ,IAAvB,CAA6BU,IAA7B,CAduE,CAerD,WAAd,GAAA1H,IAAI,CAACQ,IAf8D,GAgBtER,IAAI,CAACU,GAAL,CAAWV,IAAI,CAACU,GAAL,CAAS0G,GAAT,CAAa,CAAb,CAAgB,KAAhB,CAhB2D,MAkBnEhE,IAAI,CAAG,KAAKzF,cAAL,GAAsBwE,IAAtB,CAA2B,oCAA3B,EAAiEe,IAAjE,CAAsE,KAAtE,CAlB4D,CAmBnEjE,OAAO,CAAG,CACbN,MAAM,CAAE,KAAKA,MADA,CAEb4I,MAAM,CAAE,UAFK,CAGbC,IAAI,CAAE,WAHO,CAIb/G,KAAK,CAAET,IAAI,CAACS,KAAL,CAAWyG,MAAX,CAAkBiD,UAAlB,CAJM,CAKbzJ,GAAG,CAAEV,IAAI,CAACU,GAAL,CAASwG,MAAT,CAAgBiD,UAAhB,CALQ,CAMbnD,IAAI,CAAEA,IANO,CAOb5D,IAAI,CAAE,SAAAA,IAAI,CAAwBhE,GAAG,CAACC,aAAJ,CAAkB,UAAlB,CAAxB,CAAiB+D,IAPd,CAQbsE,IAAI,CAAEA,IARO,CASb2C,UAAU,4BAAsB,KAAK1L,MAA3B,yDACTqB,IAAI,CAACQ,IADI,mBAEAR,IAAI,CAACS,KAAL,CAAWyG,MAAX,CAAkBiD,UAAlB,CAFA,iBAEqCnK,IAAI,CAACU,GAAL,CAASwG,MAAT,CAAgBiD,UAAhB,CAFrC,kBAEyEnD,IAFzE,kBAEsF5H,GAAG,CAACC,aAAJ,CAC/F,UAD+F,CAFtF,kBAIAqI,IAJA,wBAImB1H,IAAI,CAACf,OAAL,CAAaoE,UAJhC,CATG,CAnByD,CAkCnEiH,eAAe,CAAG9N,MAAM,aAAN,QAlCiD,CAmCnE,KAAK+N,cAAL,EAAuB/N,MAAM,CAACC,cAnCqC,GAoCtE6N,eAAe,CAAG9N,MAAM,aAAN,YApCoD,EAsCnE,KAAKkC,oBAAL,EAA6ByC,MAAM,CAACqJ,IAAP,CAAY,KAAK9L,oBAAjB,EAAuC5B,MAApE,EAA8E,CAACN,MAAM,CAACC,cAtCnB,GAuCtEwC,OAAO,CAAGkC,MAAM,CAACC,MAAP,CAAcnC,OAAd,CAAuB,CAChCwB,KAAK,CAAE,KAAK/B,oBAAL,CAA0B+B,KADD,CAEhCC,GAAG,CAAE,KAAKhC,oBAAL,CAA0BgC,GAFC,CAGhCsG,IAAI,CAAE,KAAKtI,oBAAL,CAA0BsI,IAHA,CAIhC5D,IAAI,CAAE,KAAK1E,oBAAL,CAA0B0E,IAJA,CAKhCsE,IAAI,CAAE,KAAKhJ,oBAAL,CAA0BgJ,IALA,CAAvB,CAvC4D,CA8CtE4C,eAAe,CAAG9N,MAAM,aAAN,QA9CoD,CA+CtE4C,GAAG,CAACqE,aAAJ,CAAkB,UAAlB,CAA8B,KAAK/E,oBAAL,CAA0B0E,IAAxD,CA/CsE,CAgDtEhE,GAAG,CAACqE,aAAJ,CAAkB,SAAlB,CAA6B,KAAK/E,oBAAL,CAA0BsI,IAAvD,CAhDsE,EAkDvEsD,eAAe,CAACrL,OAAD,CAAf,CAAyB0I,IAAzB,CAA8B,SAACC,MAAD,CAAY,CACzCwC,gBAAgB,CAACrK,YAAjB,CAA8B,cAA9B,CADyC,CAEzCqK,gBAAgB,CAACrK,YAAjB,CAA8B,gBAA9B,CAAgD6H,MAAM,CAACC,MAAvD,CAFyC,CAGzCuB,gBAAgB,CAACC,iBAAjB,CAAmC,CAAE7B,IAAI,CAAE,MAAR,CAAnC,EACA,CAJD,CAlDuE,CAuDvErK,IAAI,CAACgB,wBAAL,CAA8B6B,IAA9B,CAvDuE,CAwDvExD,MAAM,CAACC,cAAP,IACA,CAvhBF,iCAyhBC,2BAAkBuK,IAAlB,CAAwBU,IAAxB,CAA8B,CAC7B,IAAI+C,WAAW,CAAGC,QAAQ,CAACtL,GAAG,CAACC,aAAJ,CAAkB,QAAlB,CAAD,CAA1B,CACC+D,IAAI,CAAGhE,GAAG,CAACC,aAAJ,CAAkB,UAAlB,CADR,CAECsL,SAAS,CACR,CAAiB,CAAhB,GAAA3D,IAAI,CAAClK,MAAL,EAAsC,CAAhB,GAAAkK,IAAI,CAAClK,MAAL,EAAqB4N,QAAQ,CAAC1D,IAAD,CAAR,GAAmByD,WAA/D,GACA,SAAA/C,IADA,EAES,SAAT,GAAAtE,IALF,CAMAzB,CAAC,CAAC,6BAAD,CAAD,CAAiCiJ,WAAjC,CAA6C,QAA7C,CAAuDD,SAAvD,EACA,CAjiBF,yCAmiBC,oCAA4B,KACrB3E,OAAO,CAAG,KAAKrI,cAAL,EADW,CAE1BkF,YAAY,CAAG,KAAK3F,eAAL,EAFW,CAGvB2N,QAAQ,CAAGhI,YAAY,CAACV,IAAb,CAAkB,6BAAlB,CAHY,CAI3B/C,GAAG,CAACwF,sBAAJ,CAA2BiG,QAA3B,CAJ2B,CAK3BA,QAAQ,CAACvH,EAAT,CAAY,OAAZ,CAAqB,UAAM,CAC1B3B,CAAC,CAAC,qCAAD,CAAD,CAAyC+C,WAAzC,CAAqD,QAArD,CAD0B,CAE1BtF,GAAG,CAACqE,aAAJ,CAAkB,UAAlB,CAA8B,SAA9B,CAF0B,CAG1BrE,GAAG,CAACsE,cAAJ,CAAmB,iBAAnB,CAAsC,SAAtC,CAH0B,CAI1BsC,OAAO,CAAC7D,IAAR,CAAa,gBAAb,EAA+B2I,IAA/B,CAAoC,SAApC,IAJ0B,CAK1B9E,OAAO,CAAC7D,IAAR,CAAa,iBAAb,EAAgC2I,IAAhC,CAAqC,UAArC,IAL0B,CAM1B,IAAIC,cAAc,CAAG/E,OAAO,CAAC7D,IAAR,CAAa,oDAAb,CAArB,CACC6I,kBAAkB,CAAGhF,OAAO,CAAC7D,IAAR,CAAa,iCAAmC/C,GAAG,CAACC,aAAJ,CAAkB,QAAlB,CAAnC,CAAiE,GAA9E,CADtB,CAEA0L,cAAc,CAAC3F,IAAf,GAAsBV,WAAtB,CAAkC,QAAlC,CAR0B,CAS1BqG,cAAc,CAAC7F,KAAf,GAAuBU,QAAvB,CAAgC,QAAhC,CAT0B,CAU1BjE,CAAC,CAAC,6BAAD,CAA8BoJ,cAA9B,CAAD,CAA+CD,IAA/C,CAAoD,SAApD,IAV0B,CAWtBE,kBAAkB,CAAClO,MAXG,CAYzBkO,kBAAkB,CAACF,IAAnB,CAAwB,SAAxB,IAZyB,CAczB1L,GAAG,CAACqE,aAAJ,CAAkB,SAAlB,QAdyB,CAgB1BZ,YAAY,CAAC9C,YAAb,CAA0B,aAA1B,EAAyCC,IAAzC,CAA8Cf,OAA9C,CAAsDa,QAAtD,GACA,CAjBD,EAkBA,CA1jBF,gCA4jBC,0BAAiBmL,SAAjB,CAAqC,SAC9BxE,SAAS,CAAG,KAAK9J,SAAL,CAAewF,IAAf,CAAoB,eAApB,CADkB,CAEhC+I,QAAQ,CAAGrF,MAAM,CAACoF,SAAD,CAAN,CAAkBE,QAAlB,CAA2B,CAA3B,CAA8B,MAA9B,CAFqB,CAGnCC,UAAU,CAAGvF,MAAM,CAACoF,SAAD,CAHgB,CAInCI,QAAQ,CAAGxF,MAAM,CAACoF,SAAD,CAAN,CAAkB7D,GAAlB,CAAsB,CAAtB,CAAyB,MAAzB,CAJwB,CAKnCzC,IAAI,CAAG,EAL4B,CAMnC2G,MAAM,CAAG,EAN0B,CAO7BJ,QAAQ,EAAIG,QAPiB,EASlCC,MATkC,CAQ/BJ,QAAQ,CAAChE,MAAT,CAAgB,MAAhB,IAA4BkE,UAAU,CAAClE,MAAX,CAAkB,MAAlB,CARG,CASzB,QATyB,CAWzB,EAXyB,CAanCvC,IAAI,+EAAuEuG,QAAQ,CAAChE,MAAT,CAC1E,MAD0E,CAAvE,0HAGwCoE,MAHxC,0EAKEJ,QAAQ,CAAChE,MAAT,CAAgB,MAAhB,CALF,8JAb+B,CAuBnCgE,QAAQ,CAAGrF,MAAM,CAACqF,QAAD,CAAN,CAAiB9D,GAAjB,CAAqB,CAArB,CAAwB,MAAxB,CAvBwB,CAyBpCX,SAAS,CAACtE,IAAV,CAAe,mBAAf,EAAoCwC,IAApC,CAAyCA,IAAzC,EACA,CAtlBF,oCAwlBC,8BAAqBsG,SAArB,CAAyC,CAKxC,QAJIxE,SAAS,CAAG,KAAK9J,SAAL,CAAewF,IAAf,CAAoB,eAApB,CAIhB,CAHCoJ,WAAW,CAAGb,QAAQ,CAAC7E,MAAM,CAACoF,SAAD,CAAN,CAAkBO,MAAlB,CAAyB,IAAzB,EAA+BtE,MAA/B,CAAsC,GAAtC,CAAD,CAAR,CAAuD,CAGtE,CAFCvC,IAAI,CAAG,EAER,CADC2G,MAAM,CAAG,EACV,CAASpL,KAAK,CAAG,CAAjB,CAAoB,GAAKA,KAAzB,CAAgC,EAAEA,KAAlC,CAEEoL,MAFF,CACKpL,KAAK,GAAKqL,WADf,CAEW,QAFX,CAIW,EAJX,CAMC5G,IAAI,yGAA+FkB,MAAM,CACxGoF,SADwG,CAAN,CAGjG/K,KAHiG,CAG3FA,KAH2F,EAIjGgH,MAJiG,CAI1F,SAJ0F,CAA/F,sGAKwCoE,MALxC,0DAM4B/C,GAAG,CAACC,MAAJ,CAAWiD,IAAX,CAAgBC,gBAAhB,CAAiCxL,KAAjC,CAN5B,8JANL,CAkBAuG,SAAS,CAACtE,IAAV,CAAe,mBAAf,EAAoCwC,IAApC,CAAyCA,IAAzC,EACA,CAhnBF,mCAknBC,6BAAoBsG,SAApB,CAAwC,KACvC,IAMKK,MANL,CAAI7E,SAAS,CAAG,KAAK9J,SAAL,CAAewF,IAAf,CAAoB,eAApB,CAAhB,CACCwJ,SAAS,CAAG9F,MAAM,CAACoF,SAAD,CAAN,CAAkBE,QAAlB,CAA2B,CAA3B,CAA8B,OAA9B,CADb,CAECS,UAAU,CAAG/F,MAAM,CAACoF,SAAD,CAAN,CAAkB/D,MAAlB,CAAyB,IAAzB,CAFd,CAGC2E,SAAS,CAAGhG,MAAM,CAACoF,SAAD,CAAN,CAAkB7D,GAAlB,CAAsB,CAAtB,CAAyB,OAAzB,CAHb,CAICzC,IAAI,CAAG,EAL+B,CAMhCgH,SAAS,EAAIE,SANmB,EAOlCP,MAPkC,CAOzB,EAPyB,CAQlCK,SAAS,CAACzE,MAAV,CAAiB,IAAjB,IAA2B0E,UARO,GASrCN,MAAM,CAAG,SAT4B,EAWtC3G,IAAI,EACH,+FACAgH,SAAS,CAACzE,MAAV,CAAiB,YAAjB,CADA,iFAIAoE,MAJA,oCAOAlM,GAAG,CAACO,UAAJ,CAAe,eAAf,CAPA,CAQA,GARA,CASAgM,SAAS,CAACzE,MAAV,CAAiB,IAAjB,CATA,yGAZqC,CA0BtCyE,SAAS,CAAG9F,MAAM,CAAC8F,SAAD,CAAN,CAAkBvE,GAAlB,CAAsB,CAAtB,CAAyB,OAAzB,CA1B0B,CA4BvCX,SAAS,CAACtE,IAAV,CAAe,mBAAf,EAAoCwC,IAApC,CAAyCA,IAAzC,EACA,CA/oBF,mCAipBC,6BAAoBsG,SAApB,CAAwC,CAOvC,QACKK,MADL,CANI7E,SAAS,CAAG,KAAK9J,SAAL,CAAewF,IAAf,CAAoB,eAApB,CAMhB,CALC2J,QAAQ,CAAGjG,MAAM,CAACoF,SAAD,CAAN,CAAkBE,QAAlB,CAA2B,CAA3B,CAA8B,MAA9B,CAKZ,CAJCY,SAAS,CAAGlG,MAAM,CAACoF,SAAD,CAAN,CAAkB/D,MAAlB,CAAyB,KAAzB,CAIb,CAHC8E,QAAQ,CAAGnG,MAAM,CAACoF,SAAD,CAAN,CAAkB7D,GAAlB,CAAsB,CAAtB,CAAyB,MAAzB,CAGZ,CAFC6E,UAAU,CAAGD,QAAQ,CAACE,IAAT,CAAcJ,QAAd,CAAwB,MAAxB,CAEd,CADCnH,IAAI,CAAG,EACR,CAASrE,GAAG,CAAG,CAAf,CAAkBA,GAAG,CAAG2L,UAAxB,CAAoC,EAAE3L,GAAtC,CAA2C,CAE1C,GADIgL,MACJ,CADa,EACb,CAA2C,UAAvC,GAAAlM,GAAG,CAACC,aAAJ,CAAkB,eAAlB,GAAoG,KAA/C,GAAAD,GAAG,CAAC+M,cAAJ,CAAmB,sBAAnB,CAAzD,EAC0E,CAAC,CAAtE,GAAAxK,CAAC,CAACyK,OAAF,CAAUN,QAAQ,CAACxL,GAAT,EAAV,CAA0BlB,GAAG,CAACC,aAAJ,CAAkB,YAAlB,IAA1B,CADL,CAC8E,CAC5EyM,QAAQ,CAAGjG,MAAM,CAACiG,QAAD,CAAN,CAAiB1E,GAAjB,CAAqB,CAArB,CAAwB,MAAxB,CADiE,CAE5E6E,UAAU,EAFkE,CAG5E,QACA,CAEEH,QAAQ,CAAC5E,MAAT,CAAgB,KAAhB,IAA2B6E,SATW,GAUzCT,MAAM,CAAG,SAVgC,EAY1C3G,IAAI,EACH,8FACAmH,QAAQ,CAAC5E,MAAT,CAAgB,YAAhB,CADA,iFAIAoE,MAJA,oCAOAlM,GAAG,CAACO,UAAJ,CAAe,cAAf,CAPA,CAQA,GARA,CASAmM,QAAQ,CAAC5E,MAAT,CAAgB,IAAhB,CATA,yGAbyC,CA2B1C4E,QAAQ,CAAGjG,MAAM,CAACiG,QAAD,CAAN,CAAiB1E,GAAjB,CAAqB,CAArB,CAAwB,MAAxB,EACX,CACDX,SAAS,CAACtE,IAAV,CAAe,mBAAf,EAAoCwC,IAApC,CAAyCA,IAAzC,EACA,CAtrBF,0BAwrBC,oBAAW0H,SAAX,CAAsBC,OAAtB,CAA+B,CAC9B,IAAI3P,SAAS,CAAG,KAAKA,SAArB,CACAA,SAAS,CAACwF,IAAV,CAAe,4BAAf,EAA6CoK,GAA7C,CAAiD,MAAjD,CAF8B,CAG9B,IAAIC,UAAU,CAAGpN,GAAG,CAACC,aAAJ,CAAkB,WAAlB,CAAjB,CACCoN,QAAQ,CAAGrN,GAAG,CAACC,aAAJ,CAAkB,SAAlB,CADZ,CAECW,IAAI,CAAG,KAAK9C,eAAL,GAAuB6C,YAAvB,CAAoC,SAApC,CAFR,CAGI,IAAAuM,OAAO,CAACI,OAAR,EAN0B,EAO7BJ,OAAO,CAAClF,GAAR,CAAY,CAAC,CAAb,CAAgB,MAAhB,CAP6B,CAS9BiF,SAAS,CAAGA,SAAS,CAACnF,MAAV,EATkB,CAU9BoF,OAAO,CAAGA,OAAO,CAACpF,MAAR,EAVoB,CAWZ,EAAd,EAAAsF,UAX0B,GAY7BA,UAAU,CAAG,IAZgB,EAcd,EAAZ,EAAAC,QAd0B,GAe7BA,QAAQ,CAAG,IAfkB,EAiB9B,KAAK/O,qBAAL,GAA6BiK,IAA7B,CAAkC,SAAUzE,IAAV,CAAgB,CACjD,KAAmB,CAAf,EAAAA,IAAI,CAACpG,MAAT,GAGA,GAAiB,WAAb,EAAAkD,IAAI,CAAC2M,IAAL,EAAyC,YAAb,EAAA3M,IAAI,CAAC2M,IAArC,GACCN,SAAS,CAAGA,SAAS,CAAG,GAAZ,CAAkBG,UAAlB,CAA+B,KAD5C,CAECF,OAAO,CAAGA,OAAO,CAAG,GAAV,CAAgBG,QAAhB,CAA2B,KAFtC,CAGKJ,SAAS,EAAIC,OAHlB,EAG2B,KACrBM,YAAY,CAAGjQ,SAAS,CAACwF,IAAV,CAAe,yBAAf,CADM,CAErB0K,iBAAiB,CAAGD,YAAY,CAACrG,GAAb,EAFC,CAGrBqG,YAAY,CAACE,EAAb,CAAgB,kBAAhB,CAHqB,GAIxBD,iBAAiB,CAAGD,YAAY,CAACG,MAAb,CAAoB,UAApB,EAAgCxG,GAAhC,EAJI,MAMrByG,iBAAiB,CAAGC,IAAI,CAACC,KAAL,CAAWhK,IAAI,CAACf,IAAL,CAAU,sCAAV,EAAgDoE,GAAhD,EAAX,CANC,CAOrB4G,OAAO,CAAG,CAPW,CAQzB,IAAK,IAAIC,CAAT,IAAcJ,iBAAd,CACC,GAAIA,iBAAiB,CAACI,CAAD,CAAjB,CAAqBC,YAArB,GAAsCR,iBAA1C,CAA6D,CAC5DM,OAAO,CAAGzC,QAAQ,CAACsC,iBAAiB,CAACI,CAAD,CAAjB,CAAqBE,QAAtB,CAD0C,CAE5D,KACA,CAEFhB,OAAO,CAAGzG,MAAM,CAACyG,OAAD,CAAN,CAAgBlF,GAAhB,CAAoB+F,OAApB,CAA6B,SAA7B,EAAwCI,WAAxC,GACV,CAEF,IAAIzG,UAAU,CAAG5D,IAAI,CAACf,IAAL,CAAU,uBAAV,EAAiCe,IAAjC,CAAsC,YAAtC,EAAoD6D,WAApD,EAAjB,CACCyG,UAAU,CAAGtK,IAAI,CAACf,IAAL,CAAU,uBAAV,EAAiCe,IAAjC,CAAsC,QAAtC,CADd,CAECuK,iBAAiB,CAAG,EAFrB,CAICA,iBA3BD,CA0BkB,EAAd,EAAAD,UA1BJ,CA2BqB,OA3BrB,CA6BqB,SA7BrB,CA+BAtK,IAAI,CAACf,IAAL,CAAU,uBAAV,EAAiCoE,GAAjC,CAAqCV,MAAM,CAACwG,SAAD,CAAN,CAAkBnF,MAAlB,CAAyBJ,UAAzB,CAArC,CA/BA,CAgCA5D,IAAI,CAACf,IAAL,CAAU,qBAAV,EAA+BoE,GAA/B,CAAmCV,MAAM,CAACyG,OAAD,CAAN,CAAgBpF,MAAhB,CAAuBJ,UAAvB,CAAnC,CAhCA,CAiCI,KAAA5D,IAAI,CAACf,IAAL,CAAU,cAAV,EAA0B2I,IAA1B,CAA+B,SAA/B,CAjCJ,CAkCC4C,gBAAgB,CAACC,WAAjB,GAA+BC,WAA/B,CAA2C1K,IAA3C,CAlCD,EAoCCA,IAAI,CAACf,IAAL,CAAU,uBAAV,EAAiCoE,GAAjC,CAAqCV,MAAM,CAACwG,SAAD,CAAN,CAAkBnF,MAAlB,CAAyBuG,iBAAzB,CAArC,CApCD,CAqCCvK,IAAI,CAACf,IAAL,CAAU,qBAAV,EAA+BoE,GAA/B,CAAmCV,MAAM,CAACyG,OAAD,CAAN,CAAgBpF,MAAhB,CAAuBuG,iBAAvB,CAAnC,CArCD,GAuCA,CAxCD,EAyCA,CAlvBF,mCAovBC,6BAAoBI,aAApB,CAAmC,iBAClCA,aAAa,CAAC1L,IAAd,CAAmB,uDAAnB,EAA4EmB,EAA5E,CAA+E,QAA/E,CAAyF,UAAM,CAC9F,MAAI,CAACpG,eAAL,GAAuB6C,YAAvB,CAAoC,aAApC,EAAmDC,IAAnD,CAAwDf,OAAxD,CAAgEa,QAAhE,GACA,CAFD,CADkC,CAIlC,KAAKgO,eAAL,GACA,CAED;AACD;AACA;AACA;AACA;AACA,2CACC,iCAAwB3Q,IAAxB,CAAoC,KAC7B0F,YAAY,CAAG,KAAK3F,eAAL,EADc,CA6BnC,gBA3BI6Q,cAAiB,CAAU7K,IAAV,CAAgB,CACpC,GAAIA,IAAI,CAAC8K,OAAT,CAAkB,CACjB,IAAIC,oBAAoB,CAAG/K,IAAI,CAAC2E,MAAL,CAAYqG,cAAZ,CAA2BC,KAAtD,CACCC,aAAa,CAAGhP,GAAG,CAACC,aAAJ,CAAkB,qBAAlB,KAA+CgP,OADhE,CAECC,eAAe,CAAG3M,CAAC,CAACyK,OAAF,CAAU6B,oBAAV,CAAgCG,aAAhC,CAFnB,CAGCG,QAAQ,CAAGnP,GAAG,CAACC,aAAJ,CAAkB,UAAlB,CAHZ,CAIA,GAAK,CAAC,CAAD,GAAOiP,eAAP,EAA0B,YAAcC,QAAzC,EAAuD,CAAC,CAAD,GAAOD,eAAP,EAA0B,YAAcC,QAAnG,CACC,GAAI1L,YAAY,CAAC9C,YAAb,CAA0B,cAA1B,CAA0CmD,IAAI,CAAC2E,MAAL,CAAY2G,SAAtD,EAAiE,CAAjE,CAAJ,CACCrR,IAAI,CAACsR,mBAAL,CAAyBvL,IAAI,CAAC2E,MAAL,CAAY2G,SAArC,CAAgDtL,IAAI,CAAC2E,MAArD,CADD,MAEO,CACN,IAAMuC,gBAAgB,CAAGvH,YAAY,CAAC9C,YAAb,CAA0B,aAA1B,CAAzB,CACmC,MAA/B,GAAAqK,gBAAgB,CAACpK,IAAjB,CAAsBQ,IAFpB,CAKL4J,gBAAgB,CAACpK,IAAjB,CAAsBC,MAAtB,EALK,CAGLmK,gBAAgB,CAACpK,IAAjB,CAAsBf,OAAtB,CAA8B+B,gBAA9B,CAA+CkC,IAAI,CAAC2E,MAApD,CAHK,CAOF3E,IAAI,CAAC2E,MAAL,CAAY6G,QAAZ,EAAwB,SAAAxL,IAAI,CAAC2E,MAAL,CAAY6G,QAAZ,CAAqBP,KAP3C,EAQLtL,YAAY,CAAC9C,YAAb,CAA0B,cAA1B,CAA0CmD,IAAI,CAAC2E,MAAL,CAAY6G,QAAZ,CAAqBP,KAA/D,EAED,CAEFhR,IAAI,CAACkB,mBAAL,CAAyBwE,YAAY,CAAC9C,YAAb,CAA0B,SAA1B,CAAzB,CApBiB,CAqBjB5C,IAAI,CAACQ,cAAL,GAAsBwE,IAAtB,CAA2B,aAA3B,EAA0CwC,IAA1C,CAA+C,EAA/C,CArBiB,CAsBjBxH,IAAI,CAACO,qBAAL,EAtBiB,CAuBjBlB,MAAM,CAACmS,YAAP,CAAsB,GACtB,CACD,CAED,CA/xBF,8BAiyBC,yBAAiB,CAChB,IAAIC,kBAAkB,CAAGjN,CAAC,CAAC,0BAAD,CAA1B,CACIiN,kBAAkB,CAACtK,QAAnB,CAA4B,aAA5B,CAFY,EAGfsK,kBAAkB,CAACzM,IAAnB,CAAwB,kCAAxB,EAA4DwB,OAA5D,CAAoE,OAApE,EAED,CAtyBF,kCAwyBC,6BAAqB,CACpB,IAAIiL,kBAAkB,CAAGjN,CAAC,CAAC,0BAAD,CAA1B,CACKiN,kBAAkB,CAACzM,IAAnB,CAAwB,uBAAxB,EAAiDmC,QAAjD,CAA0D,QAA1D,CAFe,EAGnBsK,kBAAkB,CAACzM,IAAnB,CAAwB,4BAAxB,EAAsDwB,OAAtD,CAA8D,OAA9D,CAHmB,CAKpBvE,GAAG,CAAC+E,gBAAJ,CAAqByK,kBAAkB,CAACzM,IAAnB,CAAwB,6BAAxB,CAArB,CAA6E,CAC5E0H,eAAe,GAD6D,CAA7E,EAGA,CAhzBF,qCAkzBC,gCAAwB,CACvB,IAAI+E,kBAAkB,CAAGjN,CAAC,CAAC,0BAAD,CAA1B,CACAiN,kBAAkB,CAACzM,IAAnB,CAAwB,kBAAxB,EAA4CmB,EAA5C,CAA+C,OAA/C,CAAwD,UAAM,CACzDsL,kBAAkB,CAACtK,QAAnB,CAA4B,aAA5B,CADyD,EAE5DsK,kBAAkB,CAACzM,IAAnB,CAAwB,kCAAxB,EAA4DwB,OAA5D,CAAoE,OAApE,EAED,CAJD,EAKA,CAED;AACD;AACA;AACA;AACA,gCACC,sBAAa1C,eAAb,CAA8B,CAC7B,IAAIhE,QAAQ,CAAG,KAAKC,eAAL,EAAf,CACCmP,SAAS,CAAGpP,QAAQ,CAAC8C,YAAT,CACX,QADW,CAEXkB,eAAe,CAAC4N,UAAhB,CAA2BV,KAA3B,CAAmC,GAAnC,CAAyClN,eAAe,CAAC6N,UAAhB,CAA2BX,KAFzD,CADb,CAKC7B,OAAO,CAAGrP,QAAQ,CAAC8C,YAAT,CAAsB,QAAtB,CAAgCkB,eAAe,CAAC8N,QAAhB,CAAyBZ,KAAzB,CAAiC,GAAjC,CAAuClN,eAAe,CAAC+N,QAAhB,CAAyBb,KAAhG,CALX,CAMCc,WAAW,CAAG,CACbC,EAAE,CAAEjO,eAAe,CAACuN,SADP,CAEbW,KAAK,CAAElO,eAAe,CAACmO,OAAhB,CAAwBC,aAFlB,CAGb5O,KAAK,CAAE4L,SAAS,CAACnF,MAAV,EAHM,CAIbxG,GAAG,CAAE4L,OAAO,CAACpF,MAAR,EAJQ,CAKbvI,MAAM,CAAE,KAAKA,MALA,CAMb2Q,GAAG,4BAAsB,KAAK3Q,MAA3B,uCAA+DsC,eAAe,CAACuN,SAA/E,CANU,CAObe,SAAS,CAAE,CACV,YAActO,eAAe,CAACuO,gBAAhB,CAAiCrB,KADrC,CAEV,sCAAwClN,eAAe,CAACoM,YAAhB,CAA6Bc,KAF3D,CAGV,4BAHU,CAPE,CAYbsB,aAAa,CAAExO,eAAe,CAAC4N,UAAhB,CAA2BQ,aAZ7B,CAabK,WAAW,CAAEzO,eAAe,CAAC8N,QAAhB,CAAyBM,aAbzB,CANf,CAwBA,OAHIpO,eAAe,CAAC0O,UAAhB,EAA8BvQ,GAAG,CAACC,aAAJ,CAAkB,cAAlB,CAGlC,GAFC4P,WAAW,CAACK,GAAZ,4BAAsC,KAAK3Q,MAA3C,mCAA2EsQ,WAAW,CAACC,EAAvF,CAED,EAAOD,WACP,CAED;AACD;AACA;AACA;AACA,uCACC,6BAAoBW,eAApB,CAAqC3O,eAArC,CAAsD,KAC/ChE,QAAQ,CAAG,KAAKC,eAAL,EADoC,CAEjD2S,cAAc,CAAG5S,QAAQ,CAAC8C,YAAT,CAAsB,cAAtB,CAAsC6P,eAAtC,EAAuD,CAAvD,CAFgC,CAGrDjO,CAAC,CAACpE,MAAF,CAASsS,cAAT,CAAyB,KAAK3O,YAAL,CAAkBD,eAAlB,CAAzB,CAHqD,CAIrDhE,QAAQ,CAAC8C,YAAT,CAAsB,aAAtB,CAAqC8P,cAArC,EACA,CAt2BF,qCAw2BC,gCAAwB,CACvB,IAAI3G,SAAS,CAAGvH,CAAC,CAACwH,QAAF,EAAhB,CACA,GAAI,KAAK2G,WAAT,CAAsB,KACf/J,YAAY,CAAG,IADA,CAEjB+B,OAAO,CAAG/B,YAAY,CAACpI,cAAb,EAFO,CAGpBoS,MAAM,CAAGjI,OAAO,CAAC3F,IAAR,CAAa,aAAb,CAHW,CAIrB,GAAiC,CAA7B,CAAA4N,MAAM,CAAC5N,IAAP,CAAY,MAAZ,EAAoBrF,MAApB,EAA+E,CAA7C,GAAAiT,MAAM,CAAC5N,IAAP,CAAY,oBAAZ,EAAkCrF,MAAxE,CACCoM,SAAS,CAACY,OAAV,CAAkBiG,MAAlB,CADD,MAEO,CACN,IAAI3G,gBAAgB,CAAGzH,CAAC,CAAC0H,iBAAF,CAAoB,CAAEC,SAAS,CAAE,CAAEC,OAAO,GAAT,CAAb,CAApB,CAAvB,CACA,KAAK7H,sBAAL,CAA4B,CAAE/C,MAAM,CAAE,KAAKA,MAAf,CAAuBqB,IAAI,CAAE,WAA7B,CAA5B,EACE2H,IADF,CACO,UAAM,CACXyB,gBAAgB,CAACC,iBAAjB,CAAmC,CAAE7B,IAAI,CAAE,MAAR,CAAnC,CADW,CAEXzB,YAAY,CAACiK,oBAAb,EAFW,CAGX9G,SAAS,CAACY,OAAV,CAAkBiG,MAAlB,EACA,CALF,EAMEhG,IANF,CAMO,SAACC,KAAD,CAAW,CAChBZ,gBAAgB,CAACC,iBAAjB,CAAmC,CAAE7B,IAAI,CAAE,MAAR,CAAnC,CADgB,CAEhBpI,GAAG,CAAC6K,QAAJ,CAAaD,KAAb,EACA,CATF,EAUA,CACD,CAnBD,KAoBCd,SAAS,CAAC+G,MAAV,EApBD,CAsBA,OAAO/G,SAAS,CAACgB,OAAV,EACP,CAED;AACD;AACA,wCACC,+BAAuB,CAClB9K,GAAG,CAACC,aAAJ,CAAkB,cAAlB,CADkB,EAErB,KAAK1C,SAAL,CAAewF,IAAf,CAAoB,cAApB,EAAoC2I,IAApC,CAAyC,SAAzC,CAAoD,SAApD,EAA+DnH,OAA/D,CAAuE,QAAvE,EAED,CA14BF,+BA44BC,0BAAkB,CACjBhC,CAAC,CAAC,cAAD,CAAD,CACEuO,GADF,CACM,OADN,EAEE5M,EAFF,CAEK,OAFL,CAEc,UAAY,CACxB,IAAMyC,YAAY,CAAGpE,CAAC,CAAC,IAAD,CAAtB,CACA0F,YAAY,CAACC,OAAb,CAAqB,CACpB3I,MAAM,CAAE,KAAKA,MADO,CAEpB4I,MAAM,CAAE,UAFY,CAGpBC,IAAI,CAAE,gBAHc,CAIpB2I,UAAU,CAAEpK,YAAY,CAAC7C,IAAb,CAAkB,WAAlB,CAJQ,CAArB,EAKGyE,IALH,CAKQ,SAACzE,IAAD,CAAU,CACjB,IAAIkN,QAAQ,CAAGlN,IAAI,CAAC2E,MAApB,CACiB,OAAb,GAAAuI,QAFa,CAGhBrK,YAAY,CAAC5D,IAAb,CAAkB,cAAlB,EAAkCuC,WAAlC,CAA8C,KAA9C,EAAqDkB,QAArD,CAA8D,KAA9D,CAHgB,CAIO,KAAb,GAAAwK,QAJM,CAKhBrK,YAAY,CAAC5D,IAAb,CAAkB,cAAlB,EAAkCuC,WAAlC,CAA8C,KAA9C,EAAqDkB,QAArD,CAA8D,KAA9D,CALgB,CAOhBxG,GAAG,CAACiR,UAAJ,CAAe,CACd7L,IAAI,CAAEpF,GAAG,CAACO,UAAJ,CAAe,UAAf,CADQ,CAEda,IAAI,CAAE,OAFQ,CAAf,EAKD,CAjBD,EAkBA,CAtBF,EAuBA,CAp6BF,+BAs6BC,0BAAkB,KACXuF,YAAY,CAAG,IADJ,CAEb+B,OAAO,CAAG/B,YAAY,CAACpI,cAAb,EAFG,CAGjBoI,YAAY,CAACrI,qBAAb,EAHiB,CAIjB,IAAIsJ,IAAI,CAAG5H,GAAG,CAACC,aAAJ,CAAkB,SAAlB,CAAX,CACI,SAAA2H,IALa,GAMhBA,IAAI,CAAG,CAAC5H,GAAG,CAACC,aAAJ,CAAkB,QAAlB,CAAD,CANS,EAQjBgI,YAAY,CAACC,OAAb,4BAAyC,KAAK3I,MAA9C,4DAAuGqI,IAAvG,GAA+GW,IAA/G,CACC,SAAUzE,IAAV,CAAgB,CACf,GAAIA,IAAJ,CAAU,CACT,IAAI2K,aAAa,CAAG/F,OAAO,CAAC3F,IAAR,CAAa,gBAAb,CAApB,CACA0L,aAAa,CAAClJ,IAAd,CAAmBzB,IAAnB,CAFS,CAGT6C,YAAY,CAACuK,mBAAb,CAAiCzC,aAAjC,CAHS,CAITtF,GAAG,CAACC,MAAJ,CAAWC,QAAX,CAAoBC,sBAApB,CAA2CmF,aAAa,CAAC1L,IAAd,CAAmB,QAAnB,CAA3C,CAJS,CAKT/C,GAAG,CAAC+E,gBAAJ,CAAqB0J,aAArB,CAAoC,CACnChE,eAAe,GADoB,CAApC,CALS,CAQT9D,YAAY,CAACwK,kBAAb,CAAgC1C,aAAhC,EACA,CACD,CAZF,CARiB,CAsBjBxG,YAAY,CAACC,OAAb,4BACqB,KAAK3I,MAD1B,6DACoFqI,IADpF,GAEEW,IAFF,CAEO,SAAUzE,IAAV,CAAgB,CACtB,GAAIA,IAAJ,CAAU,CACT,IAAI2K,aAAa,CAAG/F,OAAO,CAAC3F,IAAR,CAAa,gBAAb,CAApB,CACA0L,aAAa,CAAClJ,IAAd,CAAmBzB,IAAnB,CAFS,CAGT6C,YAAY,CAACuK,mBAAb,CAAiCzC,aAAjC,CAHS,CAITtF,GAAG,CAACC,MAAJ,CAAWC,QAAX,CAAoBC,sBAApB,CAA2CmF,aAAa,CAAC1L,IAAd,CAAmB,QAAnB,CAA3C,CAJS,CAKT0L,aAAa,CAACjI,QAAd,CAAuB,eAAvB,CALS,CAMTxG,GAAG,CAAC+E,gBAAJ,CAAqB0J,aAArB,CAAoC,CACnChE,eAAe,GADoB,CAApC,CANS,CAST9D,YAAY,CAACwK,kBAAb,CAAgC1C,aAAhC,EACA,CACD,CAdD,EAeA,CAED;AACD;AACA;AACA,qCACC,2BAAkBtK,CAAlB,CAAqB,CACpB,IAAIiN,MAAM,CAAG7O,CAAC,CAAC4B,CAAC,CAACiN,MAAH,CAAd,CACCrC,KAAK,CAAGqC,MAAM,CAACjK,GAAP,GAAa9B,WAAb,EADT,CAEC9H,SAAS,CAAG6T,MAAM,CAACC,OAAP,CAAe,uBAAf,CAFb,CAGA9T,SAAS,CAACwF,IAAV,CAAe,yBAAf,EAA0C4K,MAA1C,CAAiD,UAAY,CAC5D,IAAI2D,IAAI,CAAG/O,CAAC,CAAC,IAAD,CAAD,CAAQ8O,OAAR,CAAgB,6BAAhB,CAAX,CACyD,CAAC,CAAtD,CAAA9O,CAAC,CAAC,IAAD,CAAD,CAAQ6C,IAAR,GAAemM,IAAf,GAAsBlM,WAAtB,GAAoCmM,OAApC,CAA4CzC,KAA5C,CAFwD,CAG3DuC,IAAI,CAAChM,WAAL,CAAiB,QAAjB,CAH2D,CAK3DgM,IAAI,CAAC9K,QAAL,CAAc,QAAd,EAED,CAPD,EAQA,CAED;AACD;AACA;AACA,sCACC,4BAAmBjJ,SAAnB,CAA8B,CAC7BA,SAAS,CAACwF,IAAV,CAAe,oBAAf,EAAqCmB,EAArC,CAAwC,OAAxC,CAAiD,KAAKuN,iBAAL,CAAuBC,IAAvB,CAA4B3T,IAA5B,CAAjD,EACA,CAED;AACD;AACA,oDACC,2CAAmC,CAClCwE,CAAC,CAACoP,QAAD,CAAD,CAAYzN,EAAZ,CAAe,OAAf,CAAwB,8BAAxB,CAAwD,KAAK0N,gCAAL,CAAsCF,IAAtC,CAA2C,IAA3C,CAAxD,EACA,CAED;AACD;AACA;AACA;AACA,oDACC,0CAAiCvN,CAAjC,CAAoC,KAC/BxB,IAAI,CAAGwB,CAAC,CAACC,aAAF,CAAgBzB,IADQ,CAE7BkP,UAAU,CAAG7R,GAAG,CAAC8R,kBAAJ,CAAuBnP,IAAvB,CAFgB,CAGnC,GAA0B,UAAtB,GAAAkP,UAAU,CAACtS,MAAX,EAAyD,MAApB,GAAAsS,UAAU,CAACjR,IAAX,EAAkD,QAApB,GAAAiR,UAAU,CAACjR,IAAlF,CACC,UAEAuD,CAAC,CAAC9B,cAAF,EANkC,CAOlC,IAAM5E,WAAW,CAAuB,MAApB,GAAAoU,UAAU,CAACjR,IAAX,CAA6B,WAA7B,CAA2C,eAA/D,CACA+B,IAAI,CAAGA,IAAI,CAACgD,OAAL,CAAakM,UAAU,CAACjR,IAAxB,CAA8BnD,WAA9B,CAR2B,CASlC,KAAK6E,sBAAL,CAA4BK,IAA5B,EAED,CAED;AACD;AACA,kCACC,yBAAiB,gGAEhB,KAAKoP,eAAL,EAFgB,CAGhB,KAAKC,qBAAL,EAHgB,CAIhB,KAAKC,gCAAL,EAJgB,CAKhBC,cAAc,CAACC,MAAf,GACA,CAzgCF,kCAAiFC,oBAAjF;;"}