{"version":3,"file":"QuickCreate.min.js","sources":["QuickCreate.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n/**\n *  Class representing a modal calendar.\n * @extends Calendar_CalendarExtended_Js\n */\nwindow.Calendar_CalendarModal_Js = class Calendar_CalendarModal_Js extends Calendar_CalendarExtended_Js {\n\tconstructor(container, readonly) {\n\t\tsuper(container, readonly);\n\t\tthis.isSwitchAllDays = false;\n\t\tthis.sidebarName = 'add'; //available: add, status, edit\n\t\tthis.eventCreate = true;\n\t\tthis.module = 'Calendar';\n\t\tthis.renderCalendar();\n\t\tthis.registerEvents();\n\t}\n\t/**\n\t * Render calendar\n\t */\n\trenderCalendar() {\n\t\tlet self = this,\n\t\t\tbasicOptions = this.setCalendarOptions(),\n\t\t\toptions = {\n\t\t\t\theader: {\n\t\t\t\t\tleft: 'month,' + app.getMainParams('weekView') + ',' + app.getMainParams('dayView'),\n\t\t\t\t\tcenter: 'prevYear,prev,title,next,nextYear',\n\t\t\t\t\tright: 'today'\n\t\t\t\t},\n\t\t\t\tviews: {\n\t\t\t\t\tbasic: {\n\t\t\t\t\t\teventLimit: false\n\t\t\t\t\t},\n\t\t\t\t\tyear: {\n\t\t\t\t\t\teventLimit: 10,\n\t\t\t\t\t\teventLimitText: app.vtranslate('JS_COUNT_RECORDS'),\n\t\t\t\t\t\ttitleFormat: 'YYYY',\n\t\t\t\t\t\tselect: function (start, end) {},\n\t\t\t\t\t\tloadView: function () {\n\t\t\t\t\t\t\tself.getCalendarView().fullCalendar('getCalendar').view.render();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tmonth: {\n\t\t\t\t\t\ttitleFormat: this.parseDateFormat('month'),\n\t\t\t\t\t\tloadView: function () {\n\t\t\t\t\t\t\tself.loadCalendarData();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tweek: {\n\t\t\t\t\t\ttitleFormat: this.parseDateFormat('week'),\n\t\t\t\t\t\tloadView: function () {\n\t\t\t\t\t\t\tself.loadCalendarData();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tday: {\n\t\t\t\t\t\ttitleFormat: this.parseDateFormat('day'),\n\t\t\t\t\t\tloadView: function () {\n\t\t\t\t\t\t\tself.loadCalendarData();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tbasicDay: {\n\t\t\t\t\t\ttype: 'agendaDay',\n\t\t\t\t\t\tloadView: function () {\n\t\t\t\t\t\t\tself.loadCalendarData();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tselect: function (start, end) {\n\t\t\t\t\tself.selectDays(start, end);\n\t\t\t\t\tself.getCalendarView().fullCalendar('unselect');\n\t\t\t\t},\n\t\t\t\teventRender: function (event, element) {\n\t\t\t\t\tself.eventRenderer(event, element);\n\t\t\t\t},\n\t\t\t\tviewRender: function (view, element) {\n\t\t\t\t\tif (view.type !== 'year') {\n\t\t\t\t\t\tself.loadCalendarData(view);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\taddCalendarEvent(calendarDetails) {\n\t\t\t\t\tself.getCalendarView().fullCalendar('renderEvent', self.getEventData(calendarDetails));\n\t\t\t\t}\n\t\t\t};\n\t\toptions = Object.assign(basicOptions, options);\n\t\toptions.eventClick = function (calEvent, jsEvent) {\n\t\t\tjsEvent.preventDefault();\n\t\t};\n\t\tthis.calendar.fullCalendar(options);\n\t}\n\taddCommonMethodsToYearView() {}\n\t/**\n\t * Function sets calendar moduls's options\n\t * Overwrites Calendar_Calendar_Js\n\t */\n\tsetCalendarModuleOptions() {\n\t\tlet options = super.setCalendarModuleOptions();\n\t\toptions.hiddenDays = app.getMainParams('hiddenDays', true);\n\t\toptions.header = {\n\t\t\tleft: 'month,' + app.getMainParams('weekView') + ',' + app.getMainParams('dayView'),\n\t\t\tcenter: 'prevYear,prev,title,next,nextYear',\n\t\t\tright: 'today'\n\t\t};\n\t\toptions.selectable = true;\n\t\treturn options;\n\t}\n\n\t/**\n\t * Function registers calendar events\n\t * Overwrites Calendar_CalendarExtended_Js\n\t */\n\tregisterEvents() {\n\t\tthis.registerSwitchEvents();\n\t\tthis.registerUsersChange();\n\t\tthis.registerAutofillTime();\n\t\tthis.registerPopoverButtonsClickEvent();\n\t}\n\n\t/**\n\t * Function registers calendar switch event\n\t * Overwrites Calendar_CalendarExtended_Js\n\t */\n\tregisterSwitchEvents() {\n\t\tif (app.getMainParams('hiddenDays', true) !== false) {\n\t\t\tlet calendarview = this.getCalendarView(),\n\t\t\t\tswitchContainer = $(`<div class=\"js-calendar-switch-container\"></div>`).insertAfter(\n\t\t\t\t\tcalendarview.find('.fc-center')\n\t\t\t\t);\n\t\t\t$(\n\t\t\t\tthis.switchTpl(\n\t\t\t\t\tapp.vtranslate('JS_WORK_DAYS'),\n\t\t\t\t\tapp.vtranslate('JS_ALL'),\n\t\t\t\t\tthis.isSwitchAllDays\n\t\t\t\t)\n\t\t\t)\n\t\t\t\t.prependTo(switchContainer)\n\t\t\t\t.on('change', 'input', (e) => {\n\t\t\t\t\tconst currentTarget = $(e.currentTarget);\n\t\t\t\t\tlet hiddenDays = [];\n\t\t\t\t\tif (typeof currentTarget.data('on-text') !== 'undefined') {\n\t\t\t\t\t\thiddenDays = app.getMainParams('hiddenDays', true);\n\t\t\t\t\t\tthis.isSwitchAllDays = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.isSwitchAllDays = true;\n\t\t\t\t\t}\n\t\t\t\t\tthis.getCalendarView().fullCalendar('option', 'hiddenDays', hiddenDays);\n\t\t\t\t\tif (this.getCalendarView().fullCalendar('getView').type === 'year') {\n\t\t\t\t\t\tthis.registerViewRenderEvents(this.getCalendarView().fullCalendar('getView'));\n\t\t\t\t\t}\n\t\t\t\t\tthis.registerSwitchEvents();\n\t\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Function registers select's user change event\n\t * Overwrites Calendar_CalendarExtended_Js\n\t */\n\tregisterUsersChange() {\n\t\tthis.container.find('.assigned_user_id').on('change', () => {\n\t\t\tthis.getCalendarView().fullCalendar('getCalendar').view.options.loadView();\n\t\t});\n\t}\n\n\t/**\n\t * Function return user's id\n\t * Overwrites Calendar_CalendarExtended_Js\n\t * @returns {int}\n\t */\n\tgetSelectedUsersCalendar() {\n\t\treturn this.container.find('.assigned_user_id').val();\n\t}\n\n\t/**\n\t * Function invokes by fullcalendar, sets selected days in form\n\t * Overwrites Calendar_CalendarExtended_Js\n\t * @param startDate\n\t * @param endDate\n\t */\n\tselectDays(startDate, endDate) {\n\t\tif (this.sidebarName === 'status') {\n\t\t\tthis.sidebarName = 'add';\n\t\t\tthis.getCalendarCreateView().done(() => {\n\t\t\t\tthis.selectDays(startDate, endDate);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tlet startHour = app.getMainParams('startHour'),\n\t\t\tendHour = app.getMainParams('endHour'),\n\t\t\tview = this.getCalendarView().fullCalendar('getView');\n\t\tif (endDate.hasTime() == false) {\n\t\t\tendDate.add(-1, 'days');\n\t\t}\n\t\tstartDate = startDate.format();\n\t\tendDate = endDate.format();\n\t\tif (startHour == '') {\n\t\t\tstartHour = '00';\n\t\t}\n\t\tif (endHour == '') {\n\t\t\tendHour = '00';\n\t\t}\n\t\tif (view.name != 'agendaDay' && view.name != 'agendaWeek') {\n\t\t\tstartDate = startDate + 'T' + startHour + ':00';\n\t\t\tendDate = endDate + 'T' + endHour + ':00';\n\t\t\tif (startDate == endDate) {\n\t\t\t\tlet activityType = this.container.find('[name=\"activitytype\"]').val();\n\t\t\t\tlet activityDurations = JSON.parse(\n\t\t\t\t\tthis.container.find('[name=\"defaultOtherEventDuration\"]').val()\n\t\t\t\t);\n\t\t\t\tlet minutes = 0;\n\t\t\t\tfor (let i in activityDurations) {\n\t\t\t\t\tif (activityDurations[i].activitytype === activityType) {\n\t\t\t\t\t\tminutes = parseInt(activityDurations[i].duration);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tendDate = moment(endDate).add(minutes, 'minutes').toISOString();\n\t\t\t}\n\t\t}\n\t\tlet dateFormat = this.container.find('[name=\"date_start\"]').data('dateFormat').toUpperCase(),\n\t\t\ttimeFormat = this.container.find('[name=\"time_start\"]').data('format'),\n\t\t\tdefaultTimeFormat = '';\n\t\tif (timeFormat == 24) {\n\t\t\tdefaultTimeFormat = 'HH:mm';\n\t\t} else {\n\t\t\tdefaultTimeFormat = 'hh:mm A';\n\t\t}\n\t\tthis.container.find('[name=\"date_start\"]').val(moment(startDate).format(dateFormat));\n\t\tthis.container.find('[name=\"due_date\"]').val(moment(endDate).format(dateFormat));\n\t\tif (this.container.find('.js-autofill').prop('checked') === true) {\n\t\t\tlet calendarEditInstance = new Calendar_Edit_Js();\n\t\t\tcalendarEditInstance.getFreeTime(this.container);\n\t\t} else {\n\t\t\tthis.container.find('[name=\"time_start\"]').val(moment(startDate).format(defaultTimeFormat));\n\t\t\tthis.container.find('[name=\"time_end\"]').val(moment(endDate).format(defaultTimeFormat));\n\t\t}\n\t}\n\n\t/** @inheritdoc */\n\tregisterEditForm(sideBar) {\n\t\tlet editViewInstance = Vtiger_Edit_Js.getInstanceByModuleName(\n\t\t\t\tsideBar.find('[name=\"module\"]').val()\n\t\t\t),\n\t\t\theaderInstance = new Vtiger_Header_Js(),\n\t\t\tparams = [];\n\t\tlet rightFormCreate = sideBar.find('form[name=\"QuickCreate\"]');\n\t\teditViewInstance.registerBasicEvents(rightFormCreate);\n\t\trightFormCreate.validationEngine(app.validationEngineOptions);\n\t\tApp.Fields.Picklist.showSelect2ElementView(sideBar.find('select'));\n\t\tsideBar.find('.js-summary-close-edit').on('click', () => {\n\t\t\tthis.getCalendarCreateView();\n\t\t});\n\t\theaderInstance.registerQuickCreatePostLoadEvents(rightFormCreate, params);\n\t\tApp.Fields.Text.Editor.register(sideBar.find('.js-editor'), { height: '5em', toolbar: 'Min' });\n\t}\n\n\t/** @inheritdoc */\n\tupdateSidebar(sidebar, data) {\n\t\tconst modalTitleContainer = $('.js-modal-title__container'),\n\t\t\tmodalTitles = modalTitleContainer.find('[class*=\"js-modal-title\"]');\n\t\tdata = $(data);\n\n\t\tmodalTitles.addClass('d-none');\n\t\tif (data.hasClass('js-edit-form')) {\n\t\t\tlet title = data.find('.js-sidebar-title ').data('title');\n\t\t\tmodalTitles.filter(`.js-modal-title--${title}`).removeClass('d-none');\n\t\t\tthis.sidebarName = title;\n\t\t} else if (data.hasClass('js-activity-state')) {\n\t\t\tmodalTitles.filter('.js-modal-title--status').removeClass('d-none');\n\t\t\tthis.sidebarName = 'status';\n\t\t}\n\t\tsidebar.find('.js-qc-form').html(data);\n\t}\n};\n\njQuery.Class(\n\t'Calendar_QuickCreate_Js',\n\t{},\n\t{\n\t\tcontainer: false,\n\t\tgetContainer() {\n\t\t\treturn this.container;\n\t\t},\n\t\tsetContainer: function (container) {\n\t\t\tthis.container = container;\n\t\t},\n\t\tregisterExtendCalendar: function () {\n\t\t\tnew Calendar_CalendarModal_Js($('.js-modal-container'), true);\n\t\t\tlet container = this.getContainer();\n\t\t\tcontainer.find('.js-activity-buttons button').on('click', function (e) {\n\t\t\t\tlet form = container.find('form');\n\t\t\t\tlet currentTarget = $(e.currentTarget);\n\t\t\t\tif (1 === currentTarget.data('type')) {\n\t\t\t\t\tform.append(\n\t\t\t\t\t\t'<input type=hidden name=\"activitystatus\" value=\"' + currentTarget.data('state') + '\">'\n\t\t\t\t\t);\n\t\t\t\t\tform.submit();\n\t\t\t\t} else {\n\t\t\t\t\tcontainer.find('.js-activity-buttons').remove();\n\t\t\t\t\tform.find('[name=\"record\"]').val('');\n\t\t\t\t\tform.append('<input type=hidden name=\"postponed\" value=\"true\">');\n\t\t\t\t\tform.append(\n\t\t\t\t\t\t'<input type=hidden name=\"followup\" value=\"' + currentTarget.data('id') + '\">'\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterStandardCalendar: function () {\n\t\t\tconst thisInstance = this;\n\t\t\tlet container = this.getContainer();\n\t\t\tlet data = container.find('form');\n\t\t\tlet user = data.find('[name=\"assigned_user_id\"]');\n\t\t\tlet dateStartEl = data.find('[name=\"date_start\"]');\n\t\t\tlet dateEnd = data.find('[name=\"due_date\"]');\n\t\t\tuser.on('change', function (e) {\n\t\t\t\tvar element = $(e.currentTarget);\n\t\t\t\tvar data = element.closest('form');\n\t\t\t\tthisInstance.getNearCalendarEvent(data);\n\t\t\t});\n\t\t\tdateStartEl.on('change', function (e) {\n\t\t\t\tvar element = $(e.currentTarget);\n\t\t\t\tvar data = element.closest('form');\n\t\t\t\tthisInstance.getNearCalendarEvent(data);\n\t\t\t});\n\t\t\tdata.find('ul li a').on('click', function (e) {\n\t\t\t\tvar element = $(e.currentTarget);\n\t\t\t\tvar data = element.closest('form');\n\t\t\t\tdata.find('.addedNearCalendarEvent').remove();\n\t\t\t\tthisInstance.getNearCalendarEvent(data);\n\t\t\t});\n\t\t\tdata.on('click', '.nextDayBtn', function () {\n\t\t\t\tvar dateStartEl = data.find('[name=\"date_start\"]');\n\t\t\t\tvar startDay = dateStartEl.val();\n\t\t\t\tvar dateStartFormat = dateStartEl.data('date-format');\n\t\t\t\tstartDay = moment(\n\t\t\t\t\tVtiger_Helper_Js.convertToDateString(startDay, dateStartFormat, '+7', ' ')\n\t\t\t\t).format(dateStartFormat.toUpperCase());\n\t\t\t\tdateStartEl.val(startDay);\n\t\t\t\tdateEnd.val(startDay);\n\t\t\t\tthisInstance.getNearCalendarEvent(data);\n\t\t\t});\n\t\t\tdata.on('click', '.previousDayBtn', function () {\n\t\t\t\tvar dateStartEl = data.find('[name=\"date_start\"]');\n\t\t\t\tvar startDay = dateStartEl.val();\n\t\t\t\tvar dateStartFormat = dateStartEl.data('date-format');\n\t\t\t\tstartDay = moment(\n\t\t\t\t\tVtiger_Helper_Js.convertToDateString(startDay, dateStartFormat, '-7', ' ')\n\t\t\t\t).format(dateStartFormat.toUpperCase());\n\t\t\t\tdateStartEl.val(startDay);\n\t\t\t\tdateEnd.val(startDay);\n\t\t\t\tthisInstance.getNearCalendarEvent(data);\n\t\t\t});\n\t\t\tdata.on('click', '.dateBtn', function (e) {\n\t\t\t\tvar element = $(e.currentTarget);\n\t\t\t\tdateStartEl.val(element.data('date'));\n\t\t\t\tdata.find('[name=\"due_date\"]').val(element.data('date'));\n\t\t\t\tdata.find('[name=\"date_start\"]').trigger('change');\n\t\t\t});\n\t\t\tthisInstance.getNearCalendarEvent(data);\n\t\t},\n\t\tgetNearCalendarEvent: function (container) {\n\t\t\tlet dateStartVal = container.find('[name=\"date_start\"]').val();\n\t\t\tif (typeof dateStartVal === 'undefined' || dateStartVal === '') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet params = {\n\t\t\t\tmodule: 'Calendar',\n\t\t\t\tview: 'QuickCreateEvents',\n\t\t\t\tcurrentDate: dateStartVal,\n\t\t\t\tuser: container.find('[name=\"assigned_user_id\"]').val()\n\t\t\t};\n\t\t\tlet progressIndicatorElement = $.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true,\n\t\t\t\t\telementToBlock: container.find('.eventsTable')\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request(params).done(function (events) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\tcontainer.find('.eventsTable').remove();\n\t\t\t\tcontainer.append(events);\n\t\t\t\tapp.showPopoverElementView(container.find('.js-help-info'));\n\t\t\t});\n\t\t},\n\t\tregisterEvents: function (container) {\n\t\t\tlet calendarType = container.closest('.js-modal-container').find('.js-calendar-type').val();\n\t\t\tthis.setContainer(container);\n\t\t\tif (calendarType === 'Extended') {\n\t\t\t\tthis.registerExtendCalendar();\n\t\t\t} else {\n\t\t\t\tthis.registerStandardCalendar();\n\t\t\t}\n\t\t}\n\t}\n);\n"],"names":["window","Calendar_CalendarModal_Js","container","readonly","isSwitchAllDays","sidebarName","eventCreate","module","renderCalendar","registerEvents","basicOptions","setCalendarOptions","options","header","left","app","getMainParams","center","right","views","basic","eventLimit","year","eventLimitText","vtranslate","titleFormat","select","loadView","self","getCalendarView","fullCalendar","view","render","month","parseDateFormat","loadCalendarData","week","day","basicDay","type","start","end","selectDays","eventRender","event","element","eventRenderer","viewRender","addCalendarEvent","calendarDetails","getEventData","Object","assign","eventClick","calEvent","jsEvent","preventDefault","calendar","hiddenDays","selectable","registerSwitchEvents","registerUsersChange","registerAutofillTime","registerPopoverButtonsClickEvent","switchContainer","$","insertAfter","calendarview","find","switchTpl","prependTo","on","e","currentTarget","data","registerViewRenderEvents","val","startDate","endDate","getCalendarCreateView","done","endHour","hasTime","add","format","startHour","name","activityDurations","JSON","parse","minutes","i","activitytype","activityType","parseInt","duration","moment","toISOString","toUpperCase","timeFormat","defaultTimeFormat","dateFormat","prop","calendarEditInstance","getFreeTime","sideBar","editViewInstance","Vtiger_Edit_Js","getInstanceByModuleName","headerInstance","rightFormCreate","registerBasicEvents","validationEngine","validationEngineOptions","App","Fields","Picklist","showSelect2ElementView","registerQuickCreatePostLoadEvents","Text","Editor","register","height","toolbar","sidebar","modalTitles","modalTitleContainer","addClass","hasClass","filter","title","removeClass","html","Calendar_CalendarExtended_Js","jQuery","Class","getContainer","setContainer","registerExtendCalendar","form","append","submit","remove","registerStandardCalendar","user","dateStartEl","dateEnd","closest","thisInstance","getNearCalendarEvent","startDay","dateStartFormat","Vtiger_Helper_Js","convertToDateString","trigger","currentDate","dateStartVal","progressIndicatorElement","progressIndicator","position","blockInfo","enabled","elementToBlock","AppConnector","request","params","events","mode","showPopoverElementView"],"mappings":"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"}