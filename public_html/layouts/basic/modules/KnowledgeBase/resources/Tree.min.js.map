{"version":3,"file":"Tree.min.js","sources":["Tree.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\"KnowledgeBase_Tree_Js\", {},\n\t{\n\t\ttreeInstance: false,\n\t\tcontent: false,\n\t\tgetContent: function () {\n\t\t\tif (!this.content) {\n\t\t\t\tthis.content = $('.contentOfData');\n\t\t\t}\n\t\t\treturn this.content;\n\t\t},\n\t\tgenerateTree: function (container, data) {\n\t\t\tvar thisInstance = this;\n\t\t\tthisInstance.treeInstance = container.find('#treeContent');\n\t\t\tvar values = data.result;\n\t\t\tvar plugins = ['search'];\n\t\t\tthisInstance.treeInstance.jstree({\n\t\t\t\tcore: {\n\t\t\t\t\tdata: values,\n\t\t\t\t\tthemes: {\n\t\t\t\t\t\tname: 'proton',\n\t\t\t\t\t\tresponsive: true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tplugins: plugins\n\t\t\t});\n\t\t},\n\t\tloadTree: function (reload) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar container = $('.treeContainer');\n\t\t\tvar params = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'DataTreeAjax',\n\t\t\t};\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (reload) {\n\t\t\t\tthisInstance.treeInstance.jstree('destroy');\n\t\t\t}\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({mode: 'hide'});\n\t\t\t\tthisInstance.generateTree(container, data);\n\t\t\t\tthisInstance.registerTreeEvents(container);\n\t\t\t});\n\t\t},\n\t\tsearchingInTree: function (text) {\n\t\t\tthis.treeInstance.jstree(true).search(text);\n\t\t},\n\t\tregisterSearchEvent: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tvar valueSearch = $('#valueSearchTree');\n\t\t\tvar btnSearch = $('#btnSearchTree');\n\t\t\tvalueSearch.on('keypress', function (e) {\n\t\t\t\tif (e.which == 13) {\n\t\t\t\t\tthisInstance.searchingInTree(valueSearch.val());\n\t\t\t\t}\n\t\t\t});\n\t\t\tbtnSearch.on('click', function () {\n\t\t\t\tthisInstance.searchingInTree(valueSearch.val());\n\t\t\t});\n\t\t},\n\t\tloadContent: function (recordId) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar contentData = thisInstance.getContent();\n\t\t\tvar params = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tview: 'Content',\n\t\t\t};\n\t\t\tif (typeof recordId !== \"undefined\") {\n\t\t\t\tparams['record'] = recordId;\n\t\t\t}\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({mode: 'hide'});\n\t\t\t\tcontentData.html(data);\n\t\t\t\tif (typeof recordId === \"undefined\") {\n\t\t\t\t\t$.extend($.fn.dataTable.defaults, {\n\t\t\t\t\t\tlanguage: {\n\t\t\t\t\t\t\tsLengthMenu: app.vtranslate('JS_S_LENGTH_MENU'),\n\t\t\t\t\t\t\tsZeroRecords: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\t\t\t\tsInfo: app.vtranslate('JS_S_INFO'),\n\t\t\t\t\t\t\tsInfoEmpty: app.vtranslate('JS_S_INFO_EMPTY'),\n\t\t\t\t\t\t\tsSearch: app.vtranslate('JS_SEARCH'),\n\t\t\t\t\t\t\tsEmptyTable: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\t\t\t\tsInfoFiltered: app.vtranslate('JS_S_INFO_FILTERED'),\n\t\t\t\t\t\t\tsLoadingRecords: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\t\t\t\tsProcessing: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\t\t\t\toPaginate: {\n\t\t\t\t\t\t\t\tsFirst: app.vtranslate('JS_S_FIRST'),\n\t\t\t\t\t\t\t\tsPrevious: app.vtranslate('JS_S_PREVIOUS'),\n\t\t\t\t\t\t\t\tsNext: app.vtranslate('JS_S_NEXT'),\n\t\t\t\t\t\t\t\tsLast: app.vtranslate('JS_S_LAST')\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\toAria: {\n\t\t\t\t\t\t\t\tsSortAscending: app.vtranslate('JS_S_SORT_ASCENDING'),\n\t\t\t\t\t\t\t\tsSortDescending: app.vtranslate('JS_S_SORT_DESCENDING')\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tcontentData.find('.dataTableWithDocuments').dataTable();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterTreeEvents: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tthisInstance.registerSearchEvent();\n\t\t\tthisInstance.treeInstance.on('changed.jstree', function (e, data) {\n\t\t\t\tif (data.node.original.type != 'folder') {\n\t\t\t\t\tthisInstance.loadContent(data.node.original.record_id);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterBasicEvents: function () {\n\t\t\tvar thisInstance = this;\n\t\t\t$('.addRecord').on('click', function () {\n\t\t\t\tvar headerInstance = Vtiger_Header_Js.getInstance();\n\t\t\t\tvar moduleName = app.getModuleName();\n\t\t\t\tvar postQuickCreate = function (data) {\n\t\t\t\t\tthisInstance.loadTree(true);\n\t\t\t\t\tthisInstance.loadContent();\n\t\t\t\t};\n\t\t\t\tvar quickCreateParams = {\n\t\t\t\t\tcallbackFunction: postQuickCreate,\n\t\t\t\t\tnoCache: false\n\t\t\t\t};\n\t\t\t\theaderInstance.quickCreateModule(moduleName, quickCreateParams);\n\t\t\t});\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tthisInstance.registerBasicEvents();\n\t\t\tthisInstance.loadTree(false);\n\t\t\tthisInstance.loadContent();\n\n\t\t}\n\t});\n\n\n"],"names":["jQuery","Class","treeInstance","content","getContent","$","generateTree","container","data","thisInstance","find","result","jstree","core","values","themes","name","responsive","plugins","loadTree","reload","params","module","app","getModuleName","action","progressIndicatorElement","progressIndicator","position","blockInfo","enabled","AppConnector","request","done","mode","registerTreeEvents","searchingInTree","text","search","registerSearchEvent","valueSearch","btnSearch","on","e","which","val","loadContent","recordId","contentData","view","html","extend","fn","dataTable","defaults","language","sLengthMenu","vtranslate","sZeroRecords","sInfo","sInfoEmpty","sSearch","sEmptyTable","sInfoFiltered","sLoadingRecords","sProcessing","oPaginate","sFirst","sPrevious","sNext","sLast","oAria","sSortAscending","sSortDescending","node","original","type","record_id","registerBasicEvents","Vtiger_Header_Js","getInstance","moduleName","headerInstance","quickCreateModule","callbackFunction","noCache","registerEvents"],"mappings":";;AAGAA,OAAOC,KAAP,CAAa,uBAAb,CAAsC,EAAtC,CACC,CACCC,eADD,CAECC,UAFD,CAGCC,WAAY,qBAAY,CAIvB,YAHUD,OAGV,GAFC,KAAKA,OAAL,CAAeE,EAAE,gBAAF,CAEhB,EAAO,KAAKF,OACZ,CARF,CASCG,aAAc,sBAAUC,SAAV,CAAqBC,IAArB,CAA2B,CACxC,iBAAmB,IAAnB,CACAC,aAAaP,YAAb,CAA4BK,UAAUG,IAAV,CAAe,cAAf,CAFY,YAG3BF,KAAKG,MAHsB,CAKxCF,aAAaP,YAAb,CAA0BU,MAA1B,CAAiC,CAChCC,KAAM,CACLL,KAAMM,MADD,CAELC,OAAQ,CACPC,KAAM,QADC,CAEPC,aAFO,CAFH,CAD0B,CAQhCC,QATa,CAAC,QAAD,CACmB,CAAjC,EAUA,CAxBF,CAyBCC,SAAU,kBAAUC,MAAV,CAAkB,kBACR,IADQ,CAEvBb,UAAYF,EAAE,gBAAF,CAFW,CAGvBgB,OAAS,CACZC,OAAQC,IAAIC,aAAJ,EADI,CAEZC,OAAQ,cAFI,CAHc,CAOvBC,yBAA2B1B,OAAO2B,iBAAP,CAAyB,CACvDC,SAAU,MAD6C,CAEvDC,UAAW,CACVC,UADU,CAF4C,CAAzB,CAPJ,CAavBV,MAbuB,EAc1BX,aAAaP,YAAb,CAA0BU,MAA1B,CAAiC,SAAjC,CAd0B,CAgB3BmB,aAAaC,OAAb,CAAqBX,MAArB,EAA6BY,IAA7B,CAAkC,SAAUzB,IAAV,CAAgB,CACjDkB,yBAAyBC,iBAAzB,CAA2C,CAACO,KAAM,MAAP,CAA3C,CADiD,CAEjDzB,aAAaH,YAAb,CAA0BC,SAA1B,CAAqCC,IAArC,CAFiD,CAGjDC,aAAa0B,kBAAb,CAAgC5B,SAAhC,EACA,CAJD,EAKA,CA9CF,CA+CC6B,gBAAiB,yBAAUC,IAAV,CAAgB,CAChC,KAAKnC,YAAL,CAAkBU,MAAlB,KAA+B0B,MAA/B,CAAsCD,IAAtC,EACA,CAjDF,CAkDCE,oBAAqB,8BAAY,kBACb,IADa,CAE5BC,YAAcnC,EAAE,kBAAF,CAFc,CAG5BoC,UAAYpC,EAAE,gBAAF,CAHgB,CAIhCmC,YAAYE,EAAZ,CAAe,UAAf,CAA2B,SAAUC,CAAV,CAAa,CACxB,EAAX,IAAEC,KADiC,EAEtCnC,aAAa2B,eAAb,CAA6BI,YAAYK,GAAZ,EAA7B,EAED,CAJD,CAJgC,CAShCJ,UAAUC,EAAV,CAAa,OAAb,CAAsB,UAAY,CACjCjC,aAAa2B,eAAb,CAA6BI,YAAYK,GAAZ,EAA7B,EACA,CAFD,EAGA,CA9DF,CA+DCC,YAAa,qBAAUC,QAAV,CAAoB,kBACb,IADa,CAE5BC,YAAcvC,aAAaL,UAAb,EAFc,CAG5BiB,OAAS,CACZC,OAAQC,IAAIC,aAAJ,EADI,CAEZyB,KAAM,SAFM,CAHmB,CAOR,WAApB,iBAP4B,GAQ/B5B,cAAmB0B,QARY,EAUhC,6BAA+B/C,OAAO2B,iBAAP,CAAyB,CACvDC,SAAU,MAD6C,CAEvDC,UAAW,CACVC,UADU,CAF4C,CAAzB,CAA/B,CAMAC,aAAaC,OAAb,CAAqBX,MAArB,EAA6BY,IAA7B,CAAkC,SAAUzB,IAAV,CAAgB,CACjDkB,yBAAyBC,iBAAzB,CAA2C,CAACO,KAAM,MAAP,CAA3C,CADiD,CAEjDc,YAAYE,IAAZ,CAAiB1C,IAAjB,CAFiD,CAGzB,WAApB,iBAH6C,GAIhDH,EAAE8C,MAAF,CAAS9C,EAAE+C,EAAF,CAAKC,SAAL,CAAeC,QAAxB,CAAkC,CACjCC,SAAU,CACTC,YAAajC,IAAIkC,UAAJ,CAAe,kBAAf,CADJ,CAETC,aAAcnC,IAAIkC,UAAJ,CAAe,qBAAf,CAFL,CAGTE,MAAOpC,IAAIkC,UAAJ,CAAe,WAAf,CAHE,CAITG,WAAYrC,IAAIkC,UAAJ,CAAe,iBAAf,CAJH,CAKTI,QAAStC,IAAIkC,UAAJ,CAAe,WAAf,CALA,CAMTK,YAAavC,IAAIkC,UAAJ,CAAe,qBAAf,CANJ,CAOTM,cAAexC,IAAIkC,UAAJ,CAAe,oBAAf,CAPN,CAQTO,gBAAiBzC,IAAIkC,UAAJ,CAAe,uBAAf,CARR,CASTQ,YAAa1C,IAAIkC,UAAJ,CAAe,uBAAf,CATJ,CAUTS,UAAW,CACVC,OAAQ5C,IAAIkC,UAAJ,CAAe,YAAf,CADE,CAEVW,UAAW7C,IAAIkC,UAAJ,CAAe,eAAf,CAFD,CAGVY,MAAO9C,IAAIkC,UAAJ,CAAe,WAAf,CAHG,CAIVa,MAAO/C,IAAIkC,UAAJ,CAAe,WAAf,CAJG,CAVF,CAgBTc,MAAO,CACNC,eAAgBjD,IAAIkC,UAAJ,CAAe,qBAAf,CADV,CAENgB,gBAAiBlD,IAAIkC,UAAJ,CAAe,sBAAf,CAFX,CAhBE,CADuB,CAAlC,CAJgD,CA2BhDT,YAAYtC,IAAZ,CAAiB,yBAAjB,EAA4C2C,SAA5C,EA3BgD,EA6BjD,CA7BD,EA8BA,CA7GF,CA8GClB,mBAAoB,6BAAY,CAC/B,iBAAmB,IAAnB,CACA1B,aAAa8B,mBAAb,EAF+B,CAG/B9B,aAAaP,YAAb,CAA0BwC,EAA1B,CAA6B,gBAA7B,CAA+C,SAAUC,CAAV,CAAanC,IAAb,CAAmB,CAClC,QAA3B,OAAKkE,IAAL,CAAUC,QAAV,CAAmBC,IAD0C,EAEhEnE,aAAaqC,WAAb,CAAyBtC,KAAKkE,IAAL,CAAUC,QAAV,CAAmBE,SAA5C,EAED,CAJD,EAKA,CAtHF,CAuHCC,oBAAqB,8BAAY,CAChC,iBAAmB,IAAnB,CACAzE,EAAE,YAAF,EAAgBqC,EAAhB,CAAmB,OAAnB,CAA4B,UAAY,oBAClBqC,iBAAiBC,WAAjB,EADkB,CAEnCC,WAAa1D,IAAIC,aAAJ,EAFsB,CAWvC0D,eAAeC,iBAAf,CAAiCF,UAAjC,CAJwB,CACvBG,iBALqB,wBAAA,EAAgB,CACrC3E,aAAaU,QAAb,IADqC,CAErCV,aAAaqC,WAAb,GACA,CACuB,CAEvBuC,UAFuB,CAIxB,EACA,CAZD,EAaA,CAtIF,CAuICC,eAAgB,yBAAY,CAC3B,iBAAmB,IAAnB,CACA7E,aAAaqE,mBAAb,EAF2B,CAG3BrE,aAAaU,QAAb,IAH2B,CAI3BV,aAAaqC,WAAb,GAEA,CA7IF,CADD"}