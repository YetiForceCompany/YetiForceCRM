{"version":3,"file":"InterestsConflict.min.js","sources":["InterestsConflict.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\n\t'AppComponents_InterestsConflict_Js',\n\n\t{\n\t\t/**\n\t\t * Register unlock tab events\n\t\t * @param {jQuery} container\n\t\t */\n\t\tregisterUnlock: function (container) {\n\t\t\tlet form = container.find('.js-filter-form');\n\t\t\tApp.Fields.Date.registerRange(form);\n\t\t\tlet table = $('#js-unlock-table');\n\t\t\tif (table.hasClass('dataTable')) {\n\t\t\t\ttable.DataTable().clear().destroy();\n\t\t\t}\n\t\t\tlet dt = app.registerDataTables(table, {\n\t\t\t\tprocessing: true,\n\t\t\t\tserverSide: true,\n\t\t\t\tpaging: true,\n\t\t\t\tsearching: false,\n\t\t\t\tlengthChange: false,\n\t\t\t\tpageLength: 15,\n\t\t\t\tajax: {\n\t\t\t\t\turl: 'index.php?module=AppComponents&action=InterestsConflict&mode=getUnlock',\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\tdata: function (data) {\n\t\t\t\t\t\tdata = $.extend(data, form.serializeFormData());\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\torder: [[0, 'desc']],\n\t\t\t\tcolumns: [\n\t\t\t\t\t{ data: 'date_time' },\n\t\t\t\t\t{ data: 'user_id' },\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: 'status',\n\t\t\t\t\t\trender: function (data, type, row, meta) {\n\t\t\t\t\t\t\tswitch (data) {\n\t\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t\t\treturn `<span class=\"fas fa-check text-success\" title=\"${app.vtranslate(\n\t\t\t\t\t\t\t\t\t\t'JS_UNLOCK_STATUS_ACCEPTED'\n\t\t\t\t\t\t\t\t\t)}\"></span>`;\n\t\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\t\t\treturn `<span class=\"fas fa-times text-danger\" title=\"${app.vtranslate(\n\t\t\t\t\t\t\t\t\t\t'JS_UNLOCK_STATUS_REJECTED'\n\t\t\t\t\t\t\t\t\t)}\"></span>`;\n\t\t\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\t\t\treturn `<span class=\"fas fa-slash text-dark\" title=\"${app.vtranslate(\n\t\t\t\t\t\t\t\t\t\t'JS_UNLOCK_STATUS_CANCELED'\n\t\t\t\t\t\t\t\t\t)}\"></span>`;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\treturn `<span class=\"fas fa-question text-warning\" title=\"${app.vtranslate(\n\t\t\t\t\t\t\t\t\t\t'JS_UNLOCK_STATUS_NEW'\n\t\t\t\t\t\t\t\t\t)}\"></span>`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: 'related'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\torderable: false,\n\t\t\t\t\t\tdata: 'comment'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\torderable: false,\n\t\t\t\t\t\tdata: function (row) {\n\t\t\t\t\t\t\tlet action = row['info']\n\t\t\t\t\t\t\t\t? `<span class=\"fas fa-info-circle text-primary js-popover-tooltip mr-2\" data-content=\"${row['info']}\"></span>`\n\t\t\t\t\t\t\t\t: '';\n\t\t\t\t\t\t\tif (row['status'] === 0) {\n\t\t\t\t\t\t\t\taction += `<button type=\"button\" class=\"btn btn-success btn-sm js-update\" data-id=\"${\n\t\t\t\t\t\t\t\t\trow['id']\n\t\t\t\t\t\t\t\t}\" data-status=\"1\" title=\"${app.vtranslate(\n\t\t\t\t\t\t\t\t\t'BTN_UNLOCK_STATUS_ACTION_ACCEPT'\n\t\t\t\t\t\t\t\t)}\" data-js=\"click\"><span class=\"fas fa-check\"></span></button><button type=\"button\" class=\"btn btn-danger btn-sm ml-2 js-update\" data-id=\"${\n\t\t\t\t\t\t\t\t\trow['id']\n\t\t\t\t\t\t\t\t}\" data-status=\"2\" title=\"${app.vtranslate(\n\t\t\t\t\t\t\t\t\t'BTN_UNLOCK_STATUS_ACTION_REJECT'\n\t\t\t\t\t\t\t\t)}\" data-js=\"click\"><span class=\"fas fa-times\"></span></button>`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn action;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdefaultContent: ''\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t});\n\t\t\tcontainer.find('input,select').on('change', function () {\n\t\t\t\tdt.ajax.reload();\n\t\t\t});\n\t\t\ttable.off('click', '.js-update').on('click', '.js-update', function () {\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'AppComponents',\n\t\t\t\t\taction: 'InterestsConflict',\n\t\t\t\t\tmode: 'updateUnlockStatus',\n\t\t\t\t\tid: this.dataset.id,\n\t\t\t\t\tstatus: this.dataset.status\n\t\t\t\t})\n\t\t\t\t\t.done(function () {\n\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\ttext: app.vtranslate('JS_SAVE_NOTIFY_OK'),\n\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdt.ajax.reload(null, false);\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function () {\n\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\ttext: app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register confirmations tab events\n\t\t * @param {jQuery} container\n\t\t */\n\t\tregisterConfirmations: function (container) {\n\t\t\tlet form = container.find('.js-filter-form');\n\t\t\tApp.Fields.Date.registerRange(form);\n\t\t\tlet table = $('#js-confirm-table');\n\t\t\tif (table.hasClass('dataTable')) {\n\t\t\t\ttable.DataTable().clear().destroy();\n\t\t\t}\n\t\t\tlet dt = app.registerDataTables(table, {\n\t\t\t\tprocessing: true,\n\t\t\t\tserverSide: true,\n\t\t\t\tpaging: true,\n\t\t\t\tsearching: false,\n\t\t\t\tlengthChange: false,\n\t\t\t\tpageLength: 15,\n\t\t\t\tajax: {\n\t\t\t\t\turl: 'index.php?module=AppComponents&action=InterestsConflict&mode=getConfirm',\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\tdata: function (data) {\n\t\t\t\t\t\tdata = $.extend(data, form.serializeFormData());\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\torder: [[0, 'desc']],\n\t\t\t\tcolumns: [\n\t\t\t\t\t{ data: 'date_time' },\n\t\t\t\t\t{ data: 'user' },\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: 'status',\n\t\t\t\t\t\trender: function (data, type, row, meta) {\n\t\t\t\t\t\t\tswitch (data) {\n\t\t\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\t\t\t\treturn '<span class=\"fas fa-times text-success\"></span>';\n\t\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t\t\treturn '<span class=\"fas fa-check text-danger\"></span>';\n\t\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\t\t\treturn '<span class=\"fas fa-slash text-dark\"></span>';\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\treturn '<span class=\"fas fa-question\"></span>';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: 'related'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tclass: 'details-control',\n\t\t\t\t\t\torderable: false,\n\t\t\t\t\t\tdata: function (row) {\n\t\t\t\t\t\t\tlet action = row['info']\n\t\t\t\t\t\t\t\t? `<span class=\"fas fa-info-circle text-primary js-popover-tooltip mr-2\" data-content=\"${row['info']}\"></span>`\n\t\t\t\t\t\t\t\t: '';\n\t\t\t\t\t\t\tif (row['db'] !== 'base') {\n\t\t\t\t\t\t\t\treturn action;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\taction += `<button type=\"button\" class=\"btn btn-primary btn-sm js-update\" data-user=\"${\n\t\t\t\t\t\t\t\trow['user_id']\n\t\t\t\t\t\t\t}\" data-related=\"${row['related_id']}\"  title=\"${app.vtranslate(\n\t\t\t\t\t\t\t\t'JS_INTERESTS_CONFLICT_SET_CANCELED'\n\t\t\t\t\t\t\t)}\"><span class=\"fas fa-minus\"></span></button>`;\n\t\t\t\t\t\t\treturn action;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdefaultContent: ''\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t});\n\t\t\tcontainer.find('input,select').on('change', function () {\n\t\t\t\tdt.ajax.reload();\n\t\t\t});\n\t\t\ttable.off('click', '.js-update').on('click', '.js-update', function () {\n\t\t\t\tlet self = this;\n\t\t\t\tbootbox.prompt({\n\t\t\t\t\ttitle: app.vtranslate('JS_ENTER_A_REASON'),\n\t\t\t\t\trequired: true,\n\t\t\t\t\tcallback: function (result) {\n\t\t\t\t\t\tif (result) {\n\t\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\t\tmodule: 'AppComponents',\n\t\t\t\t\t\t\t\taction: 'InterestsConflict',\n\t\t\t\t\t\t\t\tmode: 'updateConfirmStatus',\n\t\t\t\t\t\t\t\tid: self.dataset.user,\n\t\t\t\t\t\t\t\tbaseRecord: self.dataset.related,\n\t\t\t\t\t\t\t\tcomment: result\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.done(function () {\n\t\t\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_SAVE_NOTIFY_OK'),\n\t\t\t\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tdt.ajax.reload(null, false);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.fail(function () {\n\t\t\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\t/**\n\t\t * Register events\n\t\t */\n\t\tregisterEvents: function () {\n\t\t\tlet container = $('.contentsDiv');\n\t\t\tswitch (CONFIG['mode']) {\n\t\t\t\tcase 'unlock':\n\t\t\t\t\tAppComponents_InterestsConflict_Js.registerUnlock(container);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'confirm':\n\t\t\t\t\tAppComponents_InterestsConflict_Js.registerConfirmations(container);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n);\n"],"names":["$","Class","registerUnlock","container","find","App","Fields","Date","registerRange","form","table","hasClass","DataTable","clear","destroy","app","registerDataTables","processing","serverSide","paging","searching","lengthChange","pageLength","ajax","url","type","data","extend","serializeFormData","order","columns","render","vtranslate","orderable","row","action","defaultContent","on","dt","reload","off","AppConnector","request","module","mode","id","dataset","status","done","showNotify","text","fail","registerConfirmations","class","bootbox","prompt","title","required","callback","result","self","user","baseRecord","related","comment","registerEvents","CONFIG","AppComponents_InterestsConflict_Js"],"mappings":"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"}